{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///JSMpeg.min.js","webpack:///webpack/bootstrap 677a42214b58282a8513","webpack:///./src/index.js","webpack:///./src/lib/decoder.js","webpack:///./src/lib/player.js","webpack:///./src/lib/video-element.js","webpack:///./src/lib/buffer.js","webpack:///./src/lib/ajax.js","webpack:///./src/lib/ajax-progressive.js","webpack:///./src/lib/websocket.js","webpack:///./src/lib/ts.js","webpack:///./src/lib/mpeg1.js","webpack:///./src/lib/mp2.js","webpack:///./src/lib/webgl.js","webpack:///./src/lib/canvas2d.js","webpack:///./src/lib/webaudio.js"],"names":["root","factory","exports","module","define","amd","JSMpeg","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","default","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","value","Source","Demuxer","Decoder","Renderer","AudioOutput","Now","CreateVideoElements","Fill","__WEBPACK_IMPORTED_MODULE_0__lib_player__","__WEBPACK_IMPORTED_MODULE_1__lib_video_element__","__WEBPACK_IMPORTED_MODULE_2__lib_buffer__","__WEBPACK_IMPORTED_MODULE_3__lib_ajax__","__WEBPACK_IMPORTED_MODULE_4__lib_ajax_progressive__","__WEBPACK_IMPORTED_MODULE_5__lib_websocket__","__WEBPACK_IMPORTED_MODULE_6__lib_ts__","__WEBPACK_IMPORTED_MODULE_7__lib_decoder__","__WEBPACK_IMPORTED_MODULE_8__lib_mpeg1__","__WEBPACK_IMPORTED_MODULE_9__lib_mp2__","__WEBPACK_IMPORTED_MODULE_10__lib_webgl__","__WEBPACK_IMPORTED_MODULE_11__lib_canvas2d__","__WEBPACK_IMPORTED_MODULE_12__lib_webaudio__","a","Ajax","AjaxProgressive","WebSocket","TS","Base","MPEG1Video","MP2Audio","WebGL","Canvas2D","WebAudio","window","performance","now","Date","elements","document","querySelectorAll","length","array","fill","BaseDecoder","options","destination","canPlay","collectTimestamps","streaming","timestamps","timestampIndex","startTime","decodedTime","getCurrentTime","connect","write","pts","buffers","push","index","bits","byteLength","time","seek","ts","decode","advanceDecodedTime","seconds","newTimestampIndex","__WEBPACK_IMPORTED_MODULE_0__index__","Player","url","cbUI","source","match","progressive","maxAudioLag","loop","autoplay","demuxer","video","renderer","disableGl","IsSupported","STREAM","VIDEO_1","audio","audioOut","AUDIO_1","set","setCurrentTime","getVolume","setVolume","unpauseOnShow","pauseWhenHidden","addEventListener","showHide","bind","start","play","ev","visibilityState","wantsToPlay","pause","animationId","requestAnimationFrame","update","cancelAnimationFrame","isPlaying","stop","currentTime","volume","decodeFirstFrame","destroy","startOffset","established","renderProgress","progress","updateForStreaming","updateForStaticFile","decoded","enqueuedTime","resetEnqueuedTime","enabled","notEnoughData","headroom","targetTime","lateTime","frameTime","frameRate","resume","completed","r","_classCallCheck","instance","Constructor","TypeError","VideoElement","wrapper","videoUrl","_ref","_this","poster","_ref$aspectPercent","aspectPercent","_ref$picMode","picMode","_ref$autoplay","_ref$loop","_ref$decodeFirstFrame","_ref$progressive","_ref$hookInPlay","hookInPlay","_ref$hookInPause","hookInPause","_ref$hookInStop","hookInStop","isString","querySelector","container","createElement","canvas","player","playButton","containerInit","canvasInit","playButtonInit","playerInit","setWrapperHeight","addStyles","position","width","minWidth","height","paddingBottom","appendChild","top","left","display","_this2","assign","style","playerInstance","Image","src","zIndex","onClick","unlocked","unlockAudioElement","unmuteButton","innerHTML","UNMUTE_BUTTON","opacity","cursor","unlockAudioBound","onUnlockAudio","PLAY_BUTTON","bottom","right","maxWidth","maxHeight","margin","visibility","element","preventDefault","stopPropagation","unlock","removeEventListener","offsetHeight","styles","str","constructor","String","_typeof","Symbol","iterator","obj","BitBuffer","bufferOrLength","mode","bytes","Uint8Array","MODE","EXPAND","resize","size","newBytes","Math","min","evict","sizeNeeded","bytePos","available","copyWithin","subarray","isArrayOfBuffers","totalLength","newSize","max","appendSingleBuffer","buffer","findNextStartCode","findStartCode","code","current","nextBytesAreStartCode","peek","count","offset","currentByte","remaining","read","shift","skip","rewind","has","EVICT","AjaxSource","request","XMLHttpRequest","onreadystatechange","readyState","DONE","status","onLoad","response","onprogress","onProgress","open","responseType","send","secondsHeadroom","abort","loaded","total","data","AjaxProgressiveSource","fileSize","loadedSize","chunkSize","isLoading","loadStartTime","throttled","aborted","parseInt","getResponseHeader","loadNextChunk","loadTime","end","onChunkLoad","loadFails","setRequestHeader","WSSource","socket","callbacks","reconnectInterval","shouldAttemptReconnect","reconnectTimeoutId","clearTimeout","close","protocols","binaryType","onmessage","onMessage","onopen","onOpen","onerror","onClose","onclose","setTimeout","leftoverBytes","guessVideoFrameEnd","pidsToStreamIds","pesPacketInfo","streamId","currentLength","parsePacket","leftoverCount","resync","payloadStart","pid","adaptationField","pi","packetComplete","adaptationFieldLength","packetLength","ptsDtsFlag","headerLength","payloadBeginIndex","p32_30","p29_15","p14_0","payloadLength","packetStart","complete","packetAddData","hasPadding","byteIndex","foundSync","j","PACK_HEADER","SYSTEM_HEADER","PROGRAM_MAP","PRIVATE_1","PADDING","PRIVATE_2","DIRECTORY","__WEBPACK_IMPORTED_MODULE_1__decoder__","MPEG1","bufferSize","videoBufferSize","bufferMode","customIntraQuantMatrix","customNonIntraQuantMatrix","blockData","Int32Array","currentFrame","create","hasSequenceHeader","START","SEQUENCE","decodeSequenceHeader","PICTURE","decodePicture","readHuffman","codeTable","state","newWidth","newHeight","PICTURE_RATE","initBuffers","ZIG_ZAG","intraQuantMatrix","idx","nonIntraQuantMatrix","DEFAULT_INTRA_QUANT_MATRIX","DEFAULT_NON_INTRA_QUANT_MATRIX","mbWidth","mbHeight","mbSize","codedWidth","codedHeight","codedSize","halfWidth","halfHeight","currentY","Uint8ClampedArray","currentY32","Uint32Array","currentCr","currentCr32","currentCb","currentCb32","forwardY","forwardY32","forwardCr","forwardCr32","forwardCb","forwardCb32","pictureType","fullPelForward","forwardFCode","forwardRSize","forwardF","skipOutput","PICTURE_TYPE","B","PREDICTIVE","EXTENSION","USER_DATA","SLICE_FIRST","SLICE_LAST","decodeSlice","render","INTRA","tmpY","tmpY32","tmpCr","tmpCr32","tmpCb","tmpCb32","quantizerScale","sliceBegin","slice","macroblockAddress","motionFwH","motionFwHPrev","motionFwV","motionFwVPrev","dcPredictorY","dcPredictorCr","dcPredictorCb","decodeMacroblock","mbRow","mbCol","macroblockType","macroblockIntra","macroblockMotFw","increment","t","MACROBLOCK_ADDRESS_INCREMENT","copyMacroblock","mbTable","MACROBLOCK_TYPE","decodeMotionVectors","cbp","CODE_BLOCK_PATTERN","block","mask","decodeBlock","MOTION","abs","motionH","motionV","sY","sCr","sCb","scan","H","V","oddH","oddV","dest","last","dY","dCb","dCr","x","y1","y2","y","cr1","cr2","cr","cb1","cb2","cb","quantMatrix","predictor","dctSize","DCT_DC_SIZE_LUMINANCE","DCT_DC_SIZE_CHROMINANCE","differential","level","run","coeff","DCT_COEFF","dezigZagged","PREMULTIPLIER_MATRIX","destArray","destIndex","CopyValueToDestination","IDCT","CopyBlockToDestination","AddValueToDestination","AddBlockToDestination","b1","b3","b4","b6","b7","tmp1","tmp2","m0","x0","x1","x2","x3","x4","y3","y4","y5","y6","y7","Int16Array","MACROBLOCK_TYPE_INTRA","Int8Array","MACROBLOCK_TYPE_PREDICTIVE","MACROBLOCK_TYPE_B","MP2","audioBufferSize","Float32Array","sampleRate","D","SYNTHESIS_WINDOW","U","VPos","allocation","Array","scaleFactorInfo","scaleFactor","sample","pos","decodeFrame","sync","version","layer","hasCRC","FRAME_SYNC","VERSION","MPEG_1","LAYER","II","bitrateIndex","sampleRateIndex","SAMPLE_RATE","MPEG_2","padding","bound","JOINT_STEREO","MONO","bitrate","BIT_RATE","frameSize","tab3","sblimit","tab1","tab2","QUANT_LUT_STEP_1","QUANT_LUT_STEP_2","sb","readAllocation","channels","ch","sf","outPos","part","granule","readSamples","MatrixTransform","dIndex","vIndex","outChannel","tab4","QUANT_LUT_STEP_3","qtab","QUANT_LUT_STEP4","QUANT_TAB","q","val","SCALEFACTOR_BASE","adj","levels","group","scale","ss","dp","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","t13","t14","t15","t16","t17","t18","t19","t20","t21","t22","t23","t24","t25","t26","t27","t28","t29","t30","t31","t32","t33","MPEG_2_5","III","I","STEREO","DUAL_CHANNEL","Uint16Array","A","C","WebGLRenderer","contextCreateOptions","preserveDrawingBuffer","alpha","depth","stencil","antialias","gl","getContext","Error","vertexAttr","vertexBuffer","createBuffer","vertexCoords","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","program","createProgram","SHADER","VERTEX_IDENTITY","FRAGMENT_YCRCB_TO_RGBA","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","FLOAT","textureY","createTexture","textureCb","textureCr","loadingProgram","FRAGMENT_LOADING","shouldCreateUnclampedViews","allowsClampedTextureData","deleteTexture","deleteProgram","deleteBuffer","useProgram","viewport","texture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","uniform1i","getUniformLocation","vsh","fsh","attachShader","compileShader","VERTEX_SHADER","FRAGMENT_SHADER","linkProgram","type","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","texImage2D","LUMINANCE","UNSIGNED_BYTE","getError","loc","uniform1f","drawArrays","TRIANGLE_STRIP","w","h","w2","h2","updateTexture","TEXTURE0","TEXTURE1","TEXTURE2","unit","activeTexture","WebGLRenderingContext","err","join","CanvasRenderer","context","imageData","getImageData","ctx","fillStyle","fillRect","YCbCrToRGBA","putImageData","rgba","ccb","ccr","g","b","yIndex1","yIndex2","yNext2Lines","cIndex","cNextLine","rgbaIndex1","rgbaIndex2","rgbaNext2Lines","cols","rows","row","col","WebAudioOut","CachedContext","AudioContext","webkitAudioContext","gain","createGain","_connections","wallclockStartTime","NeedsUnlocking","getEnqueuedTime","disconnect","getChannelData","createBufferSource","duration","callback","unlockCallback","noteOn","checkIfUnlocked","attempt","playbackState","PLAYING_STATE","FINISHED_STATE","test","navigator","userAgent"],"mappings":"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","file":"JSMpeg.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"JSMpeg\"] = factory();\n\telse\n\t\troot[\"JSMpeg\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"JSMpeg\"] = factory();\n\telse\n\t\troot[\"JSMpeg\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Source\", function() { return Source; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Demuxer\", function() { return Demuxer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Decoder\", function() { return Decoder; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Renderer\", function() { return Renderer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AudioOutput\", function() { return AudioOutput; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Now\", function() { return Now; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CreateVideoElements\", function() { return CreateVideoElements; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Fill\", function() { return Fill; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__lib_player__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__lib_video_element__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__lib_buffer__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__lib_ajax__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__lib_ajax_progressive__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__lib_websocket__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_ts__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__lib_decoder__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__lib_mpeg1__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__lib_mp2__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__lib_webgl__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__lib_canvas2d__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__lib_webaudio__ = __webpack_require__(13);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Player\", function() { return __WEBPACK_IMPORTED_MODULE_0__lib_player__[\"a\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"VideoElement\", function() { return __WEBPACK_IMPORTED_MODULE_1__lib_video_element__[\"a\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"BitBuffer\", function() { return __WEBPACK_IMPORTED_MODULE_2__lib_buffer__[\"a\"]; });\n/* According to jsmpeg project(https://github.com/phoboslab/jsmpeg) modified */\n\n// ES6 modular\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar Source = {\n  Ajax: __WEBPACK_IMPORTED_MODULE_3__lib_ajax__[\"a\" /* default */],\n  AjaxProgressive: __WEBPACK_IMPORTED_MODULE_4__lib_ajax_progressive__[\"a\" /* default */],\n  WebSocket: __WEBPACK_IMPORTED_MODULE_5__lib_websocket__[\"a\" /* default */]\n},\n    Demuxer = {\n  TS: __WEBPACK_IMPORTED_MODULE_6__lib_ts__[\"a\" /* default */]\n},\n    Decoder = {\n  Base: __WEBPACK_IMPORTED_MODULE_7__lib_decoder__[\"a\" /* default */],\n  MPEG1Video: __WEBPACK_IMPORTED_MODULE_8__lib_mpeg1__[\"a\" /* default */],\n  MP2Audio: __WEBPACK_IMPORTED_MODULE_9__lib_mp2__[\"a\" /* default */]\n},\n    Renderer = {\n  WebGL: __WEBPACK_IMPORTED_MODULE_10__lib_webgl__[\"a\" /* default */],\n  Canvas2D: __WEBPACK_IMPORTED_MODULE_11__lib_canvas2d__[\"a\" /* default */]\n},\n    AudioOutput = {\n  WebAudio: __WEBPACK_IMPORTED_MODULE_12__lib_webaudio__[\"a\" /* default */]\n},\n    Now = function Now() {\n  return window.performance ? window.performance.now() / 1000 : Date.now() / 1000;\n},\n    CreateVideoElements = function CreateVideoElements() {\n  var elements = document.querySelectorAll('.jsmpeg');\n  for (var i = 0; i < elements.length; i++) {\n    new __WEBPACK_IMPORTED_MODULE_1__lib_video_element__[\"a\" /* default */](elements[i]);\n  }\n},\n    Fill = function Fill(array, value) {\n  if (array.fill) {\n    array.fill(value);\n  } else {\n    for (var i = 0; i < array.length; i++) {\n      array[i] = value;\n    }\n  }\n};\n\n// This sets up the JSMpeg \"Namespace\". The object is empty apart from the Now()\n// utility function and the automatic CreateVideoElements() after DOMReady.\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar BaseDecoder = function BaseDecoder(options) {\n\tthis.destination = null;\n\tthis.canPlay = false;\n\n\tthis.collectTimestamps = !options.streaming;\n\tthis.timestamps = [];\n\tthis.timestampIndex = 0;\n\n\tthis.startTime = 0;\n\tthis.decodedTime = 0;\n\n\tObject.defineProperty(this, 'currentTime', { get: this.getCurrentTime });\n};\n\nBaseDecoder.prototype.connect = function (destination) {\n\tthis.destination = destination;\n};\n\nBaseDecoder.prototype.write = function (pts, buffers) {\n\tif (this.collectTimestamps) {\n\t\tif (this.timestamps.length === 0) {\n\t\t\tthis.startTime = pts;\n\t\t\tthis.decodedTime = pts;\n\t\t}\n\t\tthis.timestamps.push({ index: this.bits.byteLength << 3, time: pts });\n\t}\n\n\tthis.bits.write(buffers);\n\tthis.canPlay = true;\n};\n\nBaseDecoder.prototype.seek = function (time) {\n\tif (!this.collectTimestamps) {\n\t\treturn;\n\t}\n\n\tthis.timestampIndex = 0;\n\tfor (var i = 0; i < this.timestamps.length; i++) {\n\t\tif (this.timestamps[i].time > time) {\n\t\t\tbreak;\n\t\t}\n\t\tthis.timestampIndex = i;\n\t}\n\n\tvar ts = this.timestamps[this.timestampIndex];\n\tif (ts) {\n\t\tthis.bits.index = ts.index;\n\t\tthis.decodedTime = ts.time;\n\t} else {\n\t\tthis.bits.index = 0;\n\t\tthis.decodedTime = this.startTime;\n\t}\n};\n\nBaseDecoder.prototype.decode = function () {\n\tthis.advanceDecodedTime(0);\n};\n\nBaseDecoder.prototype.advanceDecodedTime = function (seconds) {\n\tif (this.collectTimestamps) {\n\t\tvar newTimestampIndex = -1;\n\t\tfor (var i = this.timestampIndex; i < this.timestamps.length; i++) {\n\t\t\tif (this.timestamps[i].index > this.bits.index) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tnewTimestampIndex = i;\n\t\t}\n\n\t\t// Did we find a new PTS, different from the last? If so, we don't have\n\t\t// to advance the decoded time manually and can instead sync it exactly\n\t\t// to the PTS.\n\t\tif (newTimestampIndex !== -1 && newTimestampIndex !== this.timestampIndex) {\n\t\t\tthis.timestampIndex = newTimestampIndex;\n\t\t\tthis.decodedTime = this.timestamps[this.timestampIndex].time;\n\t\t\treturn;\n\t\t}\n\t}\n\n\tthis.decodedTime += seconds;\n};\n\nBaseDecoder.prototype.getCurrentTime = function () {\n\treturn this.decodedTime;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (BaseDecoder);\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__index__ = __webpack_require__(0);\n\n\n/**\r\n * @param url\r\n * @param options\r\n * @param cbUI {play: function, pause: function, stop: function} UI\r\n * @constructor\r\n */\nvar Player = function Player(url, options, cbUI) {\n  this.options = options || {};\n  this.cbUI = cbUI || {};\n\n  if (options.source) {\n    this.source = new options.source(url, options);\n    options.streaming = !!this.source.streaming;\n  } else if (url.match(/^wss?:\\/\\//)) {\n    this.source = new __WEBPACK_IMPORTED_MODULE_0__index__[\"Source\"].WebSocket(url, options);\n    options.streaming = true;\n  } else if (options.progressive) {\n    this.source = new __WEBPACK_IMPORTED_MODULE_0__index__[\"Source\"].AjaxProgressive(url, options);\n    options.streaming = false;\n  } else {\n    this.source = new __WEBPACK_IMPORTED_MODULE_0__index__[\"Source\"].Ajax(url, options);\n    options.streaming = false;\n  }\n\n  this.maxAudioLag = options.maxAudioLag || 0.25;\n  this.loop = options.loop !== false;\n  this.autoplay = !!options.autoplay || options.streaming;\n\n  this.demuxer = new __WEBPACK_IMPORTED_MODULE_0__index__[\"Demuxer\"].TS(options);\n  this.source.connect(this.demuxer);\n\n  if (options.video !== false) {\n    this.video = new __WEBPACK_IMPORTED_MODULE_0__index__[\"Decoder\"].MPEG1Video(options);\n    this.renderer = !options.disableGl && __WEBPACK_IMPORTED_MODULE_0__index__[\"Renderer\"].WebGL.IsSupported() ? new __WEBPACK_IMPORTED_MODULE_0__index__[\"Renderer\"].WebGL(options) : new __WEBPACK_IMPORTED_MODULE_0__index__[\"Renderer\"].Canvas2D(options);\n    this.demuxer.connect(__WEBPACK_IMPORTED_MODULE_0__index__[\"Demuxer\"].TS.STREAM.VIDEO_1, this.video);\n    this.video.connect(this.renderer);\n  }\n\n  if (options.audio !== false && __WEBPACK_IMPORTED_MODULE_0__index__[\"AudioOutput\"].WebAudio.IsSupported()) {\n    this.audio = new __WEBPACK_IMPORTED_MODULE_0__index__[\"Decoder\"].MP2Audio(options);\n    this.audioOut = new __WEBPACK_IMPORTED_MODULE_0__index__[\"AudioOutput\"].WebAudio(options);\n    this.demuxer.connect(__WEBPACK_IMPORTED_MODULE_0__index__[\"Demuxer\"].TS.STREAM.AUDIO_1, this.audio);\n    this.audio.connect(this.audioOut);\n  }\n\n  Object.defineProperty(this, 'currentTime', {\n    get: this.getCurrentTime,\n    set: this.setCurrentTime\n  });\n  Object.defineProperty(this, 'volume', {\n    get: this.getVolume,\n    set: this.setVolume\n  });\n\n  this.unpauseOnShow = false;\n  if (options.pauseWhenHidden !== false) {\n    document.addEventListener('visibilitychange', this.showHide.bind(this));\n  }\n\n  this.source.start();\n\n  if (this.autoplay) {\n    this.play();\n  }\n};\n\nPlayer.prototype.showHide = function (ev) {\n  if (document.visibilityState === 'hidden') {\n    this.unpauseOnShow = this.wantsToPlay;\n    this.pause();\n  } else if (this.unpauseOnShow) {\n    this.play();\n  }\n};\n\nPlayer.prototype.play = function (ev) {\n  this.animationId = requestAnimationFrame(this.update.bind(this));\n  this.wantsToPlay = true;\n\n  if (this.cbUI.play) {\n    this.cbUI.play();\n  }\n};\n\nPlayer.prototype.pause = function (ev) {\n  cancelAnimationFrame(this.animationId);\n  this.wantsToPlay = false;\n  this.isPlaying = false;\n\n  if (this.audio && this.audio.canPlay) {\n    // Seek to the currentTime again - audio may already be enqueued a bit\n    // further, so we have to rewind it.\n    this.audioOut.stop();\n    this.seek(this.currentTime);\n  }\n\n  if (this.cbUI.pause) {\n    this.cbUI.pause();\n  }\n};\n\nPlayer.prototype.getVolume = function () {\n  return this.audioOut ? this.audioOut.volume : 0;\n};\n\nPlayer.prototype.setVolume = function (volume) {\n  if (this.audioOut) {\n    this.audioOut.volume = volume;\n  }\n};\n\nPlayer.prototype.stop = function (ev) {\n  this.pause();\n  this.seek(0);\n  if (this.video && this.options.decodeFirstFrame !== false) {\n    this.video.decode();\n  }\n\n  if (this.cbUI.stop) {\n    this.cbUI.stop();\n  }\n};\n\nPlayer.prototype.destroy = function () {\n  this.pause();\n  this.source.destroy();\n  this.renderer.destroy();\n  this.audioOut.destroy();\n};\n\nPlayer.prototype.seek = function (time) {\n  var startOffset = this.audio && this.audio.canPlay ? this.audio.startTime : this.video.startTime;\n\n  if (this.video) {\n    this.video.seek(time + startOffset);\n  }\n  if (this.audio) {\n    this.audio.seek(time + startOffset);\n  }\n\n  this.startTime = Object(__WEBPACK_IMPORTED_MODULE_0__index__[\"Now\"])() - time;\n};\n\nPlayer.prototype.getCurrentTime = function () {\n  return this.audio && this.audio.canPlay ? this.audio.currentTime - this.audio.startTime : this.video.currentTime - this.video.startTime;\n};\n\nPlayer.prototype.setCurrentTime = function (time) {\n  this.seek(time);\n};\n\nPlayer.prototype.update = function () {\n  this.animationId = requestAnimationFrame(this.update.bind(this));\n\n  if (!this.source.established) {\n    if (this.renderer) {\n      this.renderer.renderProgress(this.source.progress);\n    }\n    return;\n  }\n\n  if (!this.isPlaying) {\n    this.isPlaying = true;\n    this.startTime = Object(__WEBPACK_IMPORTED_MODULE_0__index__[\"Now\"])() - this.currentTime;\n  }\n\n  if (this.options.streaming) {\n    this.updateForStreaming();\n  } else {\n    this.updateForStaticFile();\n  }\n};\n\nPlayer.prototype.updateForStreaming = function () {\n  // When streaming, immediately decode everything we have buffered up until\n  // now to minimize playback latency.\n\n  if (this.video) {\n    this.video.decode();\n  }\n\n  if (this.audio) {\n    var decoded = false;\n    do {\n      // If there's a lot of audio enqueued already, disable output and\n      // catch up with the encoding.\n      if (this.audioOut.enqueuedTime > this.maxAudioLag) {\n        this.audioOut.resetEnqueuedTime();\n        this.audioOut.enabled = false;\n      }\n      decoded = this.audio.decode();\n    } while (decoded);\n    this.audioOut.enabled = true;\n  }\n};\n\nPlayer.prototype.updateForStaticFile = function () {\n  var notEnoughData = false,\n      headroom = 0;\n\n  // If we have an audio track, we always try to sync the video to the audio.\n  // Gaps and discontinuities are far more percetable in audio than in video.\n\n  if (this.audio && this.audio.canPlay) {\n    // Do we have to decode and enqueue some more audio data?\n    while (!notEnoughData && this.audio.decodedTime - this.audio.currentTime < 0.25) {\n      notEnoughData = !this.audio.decode();\n    }\n\n    // Sync video to audio\n    if (this.video && this.video.currentTime < this.audio.currentTime) {\n      notEnoughData = !this.video.decode();\n    }\n\n    headroom = this.demuxer.currentTime - this.audio.currentTime;\n  } else if (this.video) {\n    // Video only - sync it to player's wallclock\n    var targetTime = Object(__WEBPACK_IMPORTED_MODULE_0__index__[\"Now\"])() - this.startTime + this.video.startTime,\n        lateTime = targetTime - this.video.currentTime,\n        frameTime = 1 / this.video.frameRate;\n\n    if (this.video && lateTime > 0) {\n      // If the video is too far behind (>2 frames), simply reset the\n      // target time to the next frame instead of trying to catch up.\n      if (lateTime > frameTime * 2) {\n        this.startTime += lateTime;\n      }\n\n      notEnoughData = !this.video.decode();\n    }\n\n    headroom = this.demuxer.currentTime - targetTime;\n  }\n\n  // Notify the source of the playhead headroom, so it can decide whether to\n  // continue loading further data.\n  this.source.resume(headroom);\n\n  // If we failed to decode and the source is complete, it means we reached\n  // the end of our data. We may want to loop.\n  if (notEnoughData && this.source.completed) {\n    if (this.loop) {\n      this.seek(0);\n    } else {\n      // this.pause();\n      this.stop();\n    }\n  }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Player);\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__index__ = __webpack_require__(0);\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\nvar VideoElement = function () {\n  function VideoElement(wrapper, videoUrl, _ref) {\n    var _this = this;\n\n    var poster = _ref.poster,\n        _ref$aspectPercent = _ref.aspectPercent,\n        aspectPercent = _ref$aspectPercent === undefined ? '56.25%' : _ref$aspectPercent,\n        _ref$picMode = _ref.picMode,\n        picMode = _ref$picMode === undefined ? false : _ref$picMode,\n        _ref$autoplay = _ref.autoplay,\n        autoplay = _ref$autoplay === undefined ? false : _ref$autoplay,\n        _ref$loop = _ref.loop,\n        loop = _ref$loop === undefined ? false : _ref$loop,\n        _ref$decodeFirstFrame = _ref.decodeFirstFrame,\n        decodeFirstFrame = _ref$decodeFirstFrame === undefined ? true : _ref$decodeFirstFrame,\n        _ref$progressive = _ref.progressive,\n        progressive = _ref$progressive === undefined ? true : _ref$progressive,\n        _ref$hookInPlay = _ref.hookInPlay,\n        hookInPlay = _ref$hookInPlay === undefined ? function () {} : _ref$hookInPlay,\n        _ref$hookInPause = _ref.hookInPause,\n        hookInPause = _ref$hookInPause === undefined ? function () {} : _ref$hookInPause,\n        _ref$hookInStop = _ref.hookInStop,\n        hookInStop = _ref$hookInStop === undefined ? function () {} : _ref$hookInStop;\n\n    _classCallCheck(this, VideoElement);\n\n    // Setup the div container, canvas and play button\n    this.options = {\n      videoUrl: videoUrl,\n      poster: poster,\n      aspectPercent: aspectPercent,\n      picMode: picMode,\n      autoplay: autoplay,\n      loop: loop,\n      decodeFirstFrame: decodeFirstFrame,\n      progressive: progressive,\n      hookInPlay: hookInPlay,\n      hookInPause: hookInPause,\n      hookInStop: hookInStop\n    };\n    this.wrapper = isString(wrapper) ? document.querySelector(wrapper) : wrapper;\n    this.container = document.createElement('div');\n    this.canvas = document.createElement('canvas');\n    this.player = null;\n    this.playButton = document.createElement('div');\n\n    this.containerInit();\n    this.canvasInit();\n    this.playButtonInit();\n    this.playerInit();\n\n    // Assignment height of wrapper. prevent page shake when destroyed.\n    this.setWrapperHeight();\n    window.addEventListener('resize', function () {\n      return _this.setWrapperHeight();\n    });\n  }\n\n  VideoElement.prototype.containerInit = function containerInit() {\n    addStyles(this.container, {\n      position: 'relative',\n      width: '100%',\n      minWidth: '80px',\n      height: '0',\n      paddingBottom: this.options.aspectPercent\n    });\n    this.wrapper.appendChild(this.container);\n  };\n\n  VideoElement.prototype.canvasInit = function canvasInit() {\n    addStyles(this.canvas, {\n      position: 'absolute',\n      top: '0',\n      left: '0',\n      display: 'block',\n      width: '100%',\n      height: '100%'\n    });\n    this.container.appendChild(this.canvas);\n  };\n\n  VideoElement.prototype.playerInit = function playerInit() {\n    var _this2 = this;\n\n    // Parse the data-options - we try to decode the values as json. This way\n    // we can get proper boolean and number values. If JSON.parse() fails,\n    // treat it as a string.\n    this.options = Object.assign(this.options, {\n      canvas: this.canvas\n    });\n\n    // Create the player instance\n    this.player = new __WEBPACK_IMPORTED_MODULE_0__index__[\"Player\"](this.options.videoUrl, this.options, {\n      play: function play() {\n        _this2.playButton.style.display = 'none';\n        if (_this2.poster) {\n          _this2.poster.style.display = 'none';\n        }\n        _this2.options.hookInPlay();\n      },\n      pause: function pause() {\n        _this2.playButton.style.display = 'block';\n        _this2.options.hookInPause();\n      },\n      stop: function stop() {\n        if (_this2.poster) {\n          _this2.poster.style.display = 'block';\n        }\n        _this2.options.hookInStop();\n      }\n    });\n    this.wrapper.playerInstance = this.player;\n\n    // Setup the poster element, if any\n    if (this.options.poster && !this.options.autoplay && !this.player.options.streaming) {\n      this.options.decodeFirstFrame = false;\n      this.poster = new Image();\n      this.poster.src = this.options.poster;\n      addStyles(this.poster, {\n        display: 'block', zIndex: 1, position: 'absolute',\n        top: '0', left: '0', width: '100%', height: '100%'\n      });\n      this.container.appendChild(this.poster);\n    }\n\n    // Add the click handler if this video is pausable\n    if (!this.player.options.streaming) {\n      this.container.addEventListener('click', this.onClick.bind(this));\n    }\n\n    // Hide the play button if this video immediately begins playing\n    if (this.options.autoplay || this.player.options.streaming) {\n      this.playButton.style.display = 'none';\n    }\n\n    // Set up the unlock audio buton for iOS devices. iOS only allows us to\n    // play audio after a user action has initiated playing. For autoplay or\n    // streaming players we set up a muted speaker icon as the button. For all\n    // others, we can simply use the play button.\n    if (this.player.audioOut && !this.player.audioOut.unlocked) {\n      var unlockAudioElement = this.container;\n\n      if (this.options.autoplay || this.player.options.streaming) {\n        this.unmuteButton = document.createElement('div');\n        this.unmuteButton.innerHTML = UNMUTE_BUTTON;\n        addStyles(this.unmuteButton, {\n          zIndex: 2, position: 'absolute',\n          top: '0', left: '0',\n          width: '100%', height: '100%',\n          opacity: '0.7',\n          cursor: 'pointer'\n        });\n        this.container.appendChild(this.unmuteButton);\n        unlockAudioElement = this.unmuteButton;\n      }\n\n      this.unlockAudioBound = this.onUnlockAudio.bind(this, unlockAudioElement);\n      unlockAudioElement.addEventListener('touchstart', this.unlockAudioBound, false);\n      unlockAudioElement.addEventListener('click', this.unlockAudioBound, true);\n    }\n  };\n\n  VideoElement.prototype.playButtonInit = function playButtonInit() {\n    this.playButton.innerHTML = PLAY_BUTTON;\n    addStyles(this.playButton, {\n      zIndex: 2, position: 'absolute',\n      top: '0', bottom: '0', left: '0', right: '0',\n      maxWidth: '60px', maxHeight: '60px',\n      margin: 'auto',\n      opacity: '0.7',\n      cursor: 'pointer'\n    });\n    if (this.options.picMode) {\n      this.playButton.style.visibility = 'hidden';\n    }\n    this.container.appendChild(this.playButton);\n  };\n\n  VideoElement.prototype.onUnlockAudio = function onUnlockAudio(element, ev) {\n    if (this.unmuteButton) {\n      ev.preventDefault();\n      ev.stopPropagation();\n    }\n    this.player.audioOut.unlock(function () {\n      if (this.unmuteButton) {\n        this.unmuteButton.style.display = 'none';\n      }\n      element.removeEventListener('touchstart', this.unlockAudioBound);\n      element.removeEventListener('click', this.unlockAudioBound);\n    }.bind(this));\n  };\n\n  VideoElement.prototype.onClick = function onClick() {\n    if (this.player.isPlaying) {\n      this.player.pause();\n    } else {\n      this.player.play();\n    }\n  };\n\n  VideoElement.prototype.setWrapperHeight = function setWrapperHeight() {\n    this.wrapper.style.height = this.container.offsetHeight + 'px';\n  };\n\n  VideoElement.prototype.destroy = function destroy() {\n    this.player.destroy();\n    this.wrapper.innerHTML = '';\n    window.removeEventListener('resize', this.setWrapperHeight);\n  };\n\n  return VideoElement;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (VideoElement);\n;\n\nvar PLAY_BUTTON = '\\n<svg style=\"max-width: 60px; max-height: 60px; fill: #fff;\" viewBox=\"0 0 64 64\">\\n\\t<path d=\"M26,45.5L44,32L26,18.6v27V45.5L26,45.5z M32,2C15.4,2,2,15.5,2,32c0,16.6,13.4,30,30,30c16.6,0,30-13.4,30-30\\n\\tC62,15.4,48.5,2,32,2L32,2z M32,56c-9.7,0-18.5-5.9-22.2-14.8C6.1,32.2,8.1,21.9,15,15c6.9-6.9,17.2-8.9,26.2-5.2\\n\\tC50.1,13.5,56,22.3,56,32C56,45.3,45.2,56,32,56L32,56z\"/>\\n</svg>\\n',\n    UNMUTE_BUTTON = '\\n<svg style=\"position: absolute; bottom: 15px; right: 15px; width: 40px; height: 40px; fill: #fff;\" viewBox=\"0 0 64 64\">\\n\\t<path d=\"M58.3,45.5l-4.8-4.3c1.4-2.9,2.2-6.2,2.2-9.6c0-11.1-8.2-20.3-18.9-21.9V3.3C50.9,4.9,62,16.9,62,31.6\\n\\tC62,36.6,60.6,41.4,58.3,45.5L58.3,45.5z M30.4,5.6v15.2l-8.3-7.3L30.4,5.6L30.4,5.6z M36.7,19.9c4.6,1.9,7.9,6.4,7.9,11.7\\n\\tc0,0.6-0.1,1.1-0.1,1.7l-7.8-6.9V19.9L36.7,19.9z M57.5,60.7l-7.1-6.3c-3.9,2.9-8.6,4.8-13.7,5.4v-6.4c3.2-0.5,6.2-1.7,8.8-3.4\\n\\tl-8.1-7.2c-0.2,0.1-0.5,0.3-0.7,0.4v-1l-6.3-5.6v20.2L15.4,42.6H2V20.5h10.2l-9.7-8.6l4.2-4.7L61.7,56L57.5,60.7L57.5,60.7z\"/>\\n</svg>\\n';\n\nvar addStyles = function addStyles(element, styles) {\n  for (var name in styles) {\n    element.style[name] = styles[name];\n  }\n},\n    isString = function isString(str) {\n  return typeof str === 'string' && str.constructor === String;\n};\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar BitBuffer = function BitBuffer(bufferOrLength, mode) {\n\tif ((typeof bufferOrLength === 'undefined' ? 'undefined' : _typeof(bufferOrLength)) === 'object') {\n\t\tthis.bytes = bufferOrLength instanceof Uint8Array ? bufferOrLength : new Uint8Array(bufferOrLength);\n\n\t\tthis.byteLength = this.bytes.length;\n\t} else {\n\t\tthis.bytes = new Uint8Array(bufferOrLength || 1024 * 1024);\n\t\tthis.byteLength = 0;\n\t}\n\n\tthis.mode = mode || BitBuffer.MODE.EXPAND;\n\tthis.index = 0;\n};\n\nBitBuffer.prototype.resize = function (size) {\n\tvar newBytes = new Uint8Array(size);\n\tif (this.byteLength !== 0) {\n\t\tthis.byteLength = Math.min(this.byteLength, size);\n\t\tnewBytes.set(this.bytes, 0, this.byteLength);\n\t}\n\tthis.bytes = newBytes;\n\tthis.index = Math.min(this.index, this.byteLength << 3);\n};\n\nBitBuffer.prototype.evict = function (sizeNeeded) {\n\tvar bytePos = this.index >> 3,\n\t    available = this.bytes.length - this.byteLength;\n\n\t// If the current index is the write position, we can simply reset both\n\t// to 0. Also reset (and throw away yet unread data) if we won't be able\n\t// to fit the new data in even after a normal eviction.\n\tif (this.index === this.byteLength << 3 || sizeNeeded > available + bytePos // emergency evac\n\t) {\n\t\t\tthis.byteLength = 0;\n\t\t\tthis.index = 0;\n\t\t\treturn;\n\t\t} else if (bytePos === 0) {\n\t\t// Nothing read yet - we can't evict anything\n\t\treturn;\n\t}\n\n\t// Some browsers don't support copyWithin() yet - we may have to do \n\t// it manually using set and a subarray\n\tif (this.bytes.copyWithin) {\n\t\tthis.bytes.copyWithin(0, bytePos, this.byteLength);\n\t} else {\n\t\tthis.bytes.set(this.bytes.subarray(bytePos, this.byteLength));\n\t}\n\n\tthis.byteLength = this.byteLength - bytePos;\n\tthis.index -= bytePos << 3;\n\treturn;\n};\n\nBitBuffer.prototype.write = function (buffers) {\n\tvar isArrayOfBuffers = _typeof(buffers[0]) === 'object',\n\t    totalLength = 0,\n\t    available = this.bytes.length - this.byteLength;\n\n\t// Calculate total byte length\n\tif (isArrayOfBuffers) {\n\t\tvar totalLength = 0;\n\t\tfor (var i = 0; i < buffers.length; i++) {\n\t\t\ttotalLength += buffers[i].byteLength;\n\t\t}\n\t} else {\n\t\ttotalLength = buffers.byteLength;\n\t}\n\n\t// Do we need to resize or evict?\n\tif (totalLength > available) {\n\t\tif (this.mode === BitBuffer.MODE.EXPAND) {\n\t\t\tvar newSize = Math.max(this.bytes.length * 2, totalLength - available);\n\t\t\tthis.resize(newSize);\n\t\t} else {\n\t\t\tthis.evict(totalLength);\n\t\t}\n\t}\n\n\tif (isArrayOfBuffers) {\n\t\tfor (var i = 0; i < buffers.length; i++) {\n\t\t\tthis.appendSingleBuffer(buffers[i]);\n\t\t}\n\t} else {\n\t\tthis.appendSingleBuffer(buffers);\n\t}\n};\n\nBitBuffer.prototype.appendSingleBuffer = function (buffer) {\n\tbuffer = buffer instanceof Uint8Array ? buffer : new Uint8Array(buffer);\n\n\tthis.bytes.set(buffer, this.byteLength);\n\tthis.byteLength += buffer.length;\n};\n\nBitBuffer.prototype.findNextStartCode = function () {\n\tfor (var i = this.index + 7 >> 3; i < this.byteLength; i++) {\n\t\tif (this.bytes[i] == 0x00 && this.bytes[i + 1] == 0x00 && this.bytes[i + 2] == 0x01) {\n\t\t\tthis.index = i + 4 << 3;\n\t\t\treturn this.bytes[i + 3];\n\t\t}\n\t}\n\tthis.index = this.byteLength << 3;\n\treturn -1;\n};\n\nBitBuffer.prototype.findStartCode = function (code) {\n\tvar current = 0;\n\twhile (true) {\n\t\tcurrent = this.findNextStartCode();\n\t\tif (current === code || current === -1) {\n\t\t\treturn current;\n\t\t}\n\t}\n\treturn -1;\n};\n\nBitBuffer.prototype.nextBytesAreStartCode = function () {\n\tvar i = this.index + 7 >> 3;\n\treturn i >= this.byteLength || this.bytes[i] == 0x00 && this.bytes[i + 1] == 0x00 && this.bytes[i + 2] == 0x01;\n};\n\nBitBuffer.prototype.peek = function (count) {\n\tvar offset = this.index;\n\tvar value = 0;\n\twhile (count) {\n\t\tvar currentByte = this.bytes[offset >> 3],\n\t\t    remaining = 8 - (offset & 7),\n\t\t    // remaining bits in byte\n\t\tread = remaining < count ? remaining : count,\n\t\t    // bits in this run\n\t\tshift = remaining - read,\n\t\t    mask = 0xff >> 8 - read;\n\n\t\tvalue = value << read | (currentByte & mask << shift) >> shift;\n\n\t\toffset += read;\n\t\tcount -= read;\n\t}\n\n\treturn value;\n};\n\nBitBuffer.prototype.read = function (count) {\n\tvar value = this.peek(count);\n\tthis.index += count;\n\treturn value;\n};\n\nBitBuffer.prototype.skip = function (count) {\n\treturn this.index += count;\n};\n\nBitBuffer.prototype.rewind = function (count) {\n\tthis.index = Math.max(this.index - count, 0);\n};\n\nBitBuffer.prototype.has = function (count) {\n\treturn (this.byteLength << 3) - this.index >= count;\n};\n\nBitBuffer.MODE = {\n\tEVICT: 1,\n\tEXPAND: 2\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (BitBuffer);\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar AjaxSource = function AjaxSource(url, options) {\n\tthis.url = url;\n\tthis.destination = null;\n\tthis.request = null;\n\n\tthis.completed = false;\n\tthis.established = false;\n\tthis.progress = 0;\n};\n\nAjaxSource.prototype.connect = function (destination) {\n\tthis.destination = destination;\n};\n\nAjaxSource.prototype.start = function () {\n\tthis.request = new XMLHttpRequest();\n\n\tthis.request.onreadystatechange = function () {\n\t\tif (this.request.readyState === this.request.DONE && this.request.status === 200) {\n\t\t\tthis.onLoad(this.request.response);\n\t\t}\n\t}.bind(this);\n\n\tthis.request.onprogress = this.onProgress.bind(this);\n\tthis.request.open('GET', this.url);\n\tthis.request.responseType = \"arraybuffer\";\n\tthis.request.send();\n};\n\nAjaxSource.prototype.resume = function (secondsHeadroom) {\n\t// Nothing to do here\n};\n\nAjaxSource.prototype.destroy = function () {\n\tthis.request.abort();\n};\n\nAjaxSource.prototype.onProgress = function (ev) {\n\tthis.progress = ev.loaded / ev.total;\n};\n\nAjaxSource.prototype.onLoad = function (data) {\n\tthis.established = true;\n\tthis.completed = true;\n\tthis.progress = 1;\n\n\tif (this.destination) {\n\t\tthis.destination.write(data);\n\t}\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AjaxSource);\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__index__ = __webpack_require__(0);\n\n\nvar AjaxProgressiveSource = function AjaxProgressiveSource(url, options) {\n  this.url = url;\n  this.destination = null;\n  this.request = null;\n\n  this.completed = false;\n  this.established = false;\n  this.progress = 0;\n\n  this.fileSize = 0;\n  this.loadedSize = 0;\n  this.chunkSize = options.chunkSize || 1024 * 1024;\n\n  this.isLoading = false;\n  this.loadStartTime = 0;\n  this.throttled = options.throttled !== false;\n  this.aborted = false;\n};\n\nAjaxProgressiveSource.prototype.connect = function (destination) {\n  this.destination = destination;\n};\n\nAjaxProgressiveSource.prototype.start = function () {\n  this.request = new XMLHttpRequest();\n\n  this.request.onreadystatechange = function () {\n    if (this.request.readyState === this.request.DONE) {\n      this.fileSize = parseInt(this.request.getResponseHeader(\"Content-Length\"));\n      this.loadNextChunk();\n    }\n  }.bind(this);\n\n  this.request.onprogress = this.onProgress.bind(this);\n  this.request.open('HEAD', this.url);\n  this.request.send();\n};\n\nAjaxProgressiveSource.prototype.resume = function (secondsHeadroom) {\n  if (this.isLoading || !this.throttled) {\n    return;\n  }\n\n  // Guess the worst case loading time with lots of safety margin. This is\n  // somewhat arbitrary...\n  var worstCaseLoadingTime = this.loadTime * 8 + 2;\n  if (worstCaseLoadingTime > secondsHeadroom) {\n    this.loadNextChunk();\n  }\n};\n\nAjaxProgressiveSource.prototype.destroy = function () {\n  this.request.abort();\n  this.aborted = true;\n};\n\nAjaxProgressiveSource.prototype.loadNextChunk = function () {\n  var start = this.loadedSize,\n      end = Math.min(this.loadedSize + this.chunkSize - 1, this.fileSize - 1);\n\n  if (start >= this.fileSize || this.aborted) {\n    this.completed = true;\n    return;\n  }\n\n  this.isLoading = true;\n  this.loadStartTime = JSMpeg.Now();\n  this.request = new XMLHttpRequest();\n\n  this.request.onreadystatechange = function () {\n    if (this.request.readyState === this.request.DONE && this.request.status >= 200 && this.request.status < 300) {\n      this.onChunkLoad(this.request.response);\n    } else if (this.request.readyState === this.request.DONE) {\n      // Retry?\n      if (this.loadFails++ < 3) {\n        this.loadNextChunk();\n      }\n    }\n  }.bind(this);\n\n  if (start === 0) {\n    this.request.onprogress = this.onProgress.bind(this);\n  }\n\n  this.request.open('GET', this.url + '?' + start + \"-\" + end);\n  this.request.setRequestHeader(\"Range\", \"bytes=\" + start + \"-\" + end);\n  this.request.responseType = \"arraybuffer\";\n  this.request.send();\n};\n\nAjaxProgressiveSource.prototype.onProgress = function (ev) {\n  this.progress = ev.loaded / ev.total;\n};\n\nAjaxProgressiveSource.prototype.onChunkLoad = function (data) {\n  this.established = true;\n  this.progress = 1;\n  this.loadedSize += data.byteLength;\n  this.loadFails = 0;\n  this.isLoading = false;\n\n  if (this.destination) {\n    this.destination.write(data);\n  }\n\n  this.loadTime = JSMpeg.Now() - this.loadStartTime;\n  if (!this.throttled) {\n    this.loadNextChunk();\n  }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AjaxProgressiveSource);\n\n/***/ }),\n/* 7 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar WSSource = function WSSource(url, options) {\n\tthis.url = url;\n\tthis.options = options;\n\tthis.socket = null;\n\n\tthis.callbacks = { connect: [], data: [] };\n\tthis.destination = null;\n\n\tthis.reconnectInterval = options.reconnectInterval !== undefined ? options.reconnectInterval : 5;\n\tthis.shouldAttemptReconnect = !!this.reconnectInterval;\n\n\tthis.completed = false;\n\tthis.established = false;\n\tthis.progress = 0;\n\n\tthis.reconnectTimeoutId = 0;\n};\n\nWSSource.prototype.connect = function (destination) {\n\tthis.destination = destination;\n};\n\nWSSource.prototype.destroy = function () {\n\tclearTimeout(this.reconnectTimeoutId);\n\tthis.shouldAttemptReconnect = false;\n\tthis.socket.close();\n};\n\nWSSource.prototype.start = function () {\n\tthis.shouldAttemptReconnect = !!this.reconnectInterval;\n\tthis.progress = 0;\n\tthis.established = false;\n\n\tthis.socket = new WebSocket(this.url, this.options.protocols || null);\n\tthis.socket.binaryType = 'arraybuffer';\n\tthis.socket.onmessage = this.onMessage.bind(this);\n\tthis.socket.onopen = this.onOpen.bind(this);\n\tthis.socket.onerror = this.onClose.bind(this);\n\tthis.socket.onclose = this.onClose.bind(this);\n};\n\nWSSource.prototype.resume = function (secondsHeadroom) {\n\t// Nothing to do here\n};\n\nWSSource.prototype.onOpen = function () {\n\tthis.progress = 1;\n\tthis.established = true;\n};\n\nWSSource.prototype.onClose = function () {\n\tif (this.shouldAttemptReconnect) {\n\t\tclearTimeout(this.reconnectTimeoutId);\n\t\tthis.reconnectTimeoutId = setTimeout(function () {\n\t\t\tthis.start();\n\t\t}.bind(this), this.reconnectInterval * 1000);\n\t}\n};\n\nWSSource.prototype.onMessage = function (ev) {\n\tif (this.destination) {\n\t\tthis.destination.write(ev.data);\n\t}\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (WSSource);\n\n/***/ }),\n/* 8 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__index__ = __webpack_require__(0);\n\n\nvar TS = function TS(options) {\n  this.bits = null;\n  this.leftoverBytes = null;\n\n  this.guessVideoFrameEnd = true;\n  this.pidsToStreamIds = {};\n\n  this.pesPacketInfo = {};\n  this.startTime = 0;\n  this.currentTime = 0;\n};\n\nTS.prototype.connect = function (streamId, destination) {\n  this.pesPacketInfo[streamId] = {\n    destination: destination,\n    currentLength: 0,\n    totalLength: 0,\n    pts: 0,\n    buffers: []\n  };\n};\n\nTS.prototype.write = function (buffer) {\n  if (this.leftoverBytes) {\n    var totalLength = buffer.byteLength + this.leftoverBytes.byteLength;\n    this.bits = new __WEBPACK_IMPORTED_MODULE_0__index__[\"BitBuffer\"](totalLength);\n    this.bits.write([this.leftoverBytes, buffer]);\n  } else {\n    this.bits = new __WEBPACK_IMPORTED_MODULE_0__index__[\"BitBuffer\"](buffer);\n  }\n\n  while (this.bits.has(188 << 3) && this.parsePacket()) {}\n\n  var leftoverCount = this.bits.byteLength - (this.bits.index >> 3);\n  this.leftoverBytes = leftoverCount > 0 ? this.bits.bytes.subarray(this.bits.index >> 3) : null;\n};\n\nTS.prototype.parsePacket = function () {\n  // Check if we're in sync with packet boundaries; attempt to resync if not.\n  if (this.bits.read(8) !== 0x47) {\n    if (!this.resync()) {\n      // Couldn't resync; maybe next time...\n      return false;\n    }\n  }\n\n  var end = (this.bits.index >> 3) + 187;\n  var transportError = this.bits.read(1),\n      payloadStart = this.bits.read(1),\n      transportPriority = this.bits.read(1),\n      pid = this.bits.read(13),\n      transportScrambling = this.bits.read(2),\n      adaptationField = this.bits.read(2),\n      continuityCounter = this.bits.read(4);\n\n  // If this is the start of a new payload; signal the end of the previous\n  // frame, if we didn't do so already.\n  var streamId = this.pidsToStreamIds[pid];\n  if (payloadStart && streamId) {\n    var pi = this.pesPacketInfo[streamId];\n    if (pi && pi.currentLength) {\n      this.packetComplete(pi);\n    }\n  }\n\n  // Extract current payload\n  if (adaptationField & 0x1) {\n    if (adaptationField & 0x2) {\n      var adaptationFieldLength = this.bits.read(8);\n      this.bits.skip(adaptationFieldLength << 3);\n    }\n\n    if (payloadStart && this.bits.nextBytesAreStartCode()) {\n      this.bits.skip(24);\n      streamId = this.bits.read(8);\n      this.pidsToStreamIds[pid] = streamId;\n\n      var packetLength = this.bits.read(16);\n      this.bits.skip(8);\n      var ptsDtsFlag = this.bits.read(2);\n      this.bits.skip(6);\n      var headerLength = this.bits.read(8);\n      var payloadBeginIndex = this.bits.index + (headerLength << 3);\n\n      var pi = this.pesPacketInfo[streamId];\n      if (pi) {\n        var pts = 0;\n        if (ptsDtsFlag & 0x2) {\n          // The Presentation Timestamp is encoded as 33(!) bit\n          // integer, but has a \"marker bit\" inserted at weird places\n          // in between, making the whole thing 5 bytes in size.\n          // You can't make this shit up...\n          this.bits.skip(4);\n          var p32_30 = this.bits.read(3);\n          this.bits.skip(1);\n          var p29_15 = this.bits.read(15);\n          this.bits.skip(1);\n          var p14_0 = this.bits.read(15);\n          this.bits.skip(1);\n\n          // Can't use bit shifts here; we need 33 bits of precision,\n          // so we're using JavaScript's double number type. Also\n          // divide by the 90khz clock to get the pts in seconds.\n          pts = (p32_30 * 1073741824 + p29_15 * 32768 + p14_0) / 90000;\n\n          this.currentTime = pts;\n          if (this.startTime === -1) {\n            this.startTime = pts;\n          }\n        }\n\n        var payloadLength = packetLength ? packetLength - headerLength - 3 : 0;\n        this.packetStart(pi, pts, payloadLength);\n      }\n\n      // Skip the rest of the header without parsing it\n      this.bits.index = payloadBeginIndex;\n    }\n\n    if (streamId) {\n      // Attempt to detect if the PES packet is complete. For Audio (and\n      // other) packets, we received a total packet length with the PES\n      // header, so we can check the current length.\n\n      // For Video packets, we have to guess the end by detecting if this\n      // TS packet was padded - there's no good reason to pad a TS packet\n      // in between, but it might just fit exactly. If this fails, we can\n      // only wait for the next PES header for that stream.\n\n      var pi = this.pesPacketInfo[streamId];\n      if (pi) {\n        var start = this.bits.index >> 3;\n        var complete = this.packetAddData(pi, start, end);\n\n        var hasPadding = !payloadStart && adaptationField & 0x2;\n        if (complete || this.guessVideoFrameEnd && hasPadding) {\n          this.packetComplete(pi);\n        }\n      }\n    }\n  }\n\n  this.bits.index = end << 3;\n  return true;\n};\n\nTS.prototype.resync = function () {\n  // Check if we have enough data to attempt a resync. We need 5 full packets.\n  if (!this.bits.has(188 * 6 << 3)) {\n    return false;\n  }\n\n  var byteIndex = this.bits.index >> 3;\n\n  // Look for the first sync token in the first 187 bytes\n  for (var i = 0; i < 187; i++) {\n    if (this.bits.bytes[byteIndex + i] === 0x47) {\n\n      // Look for 4 more sync tokens, each 188 bytes appart\n      var foundSync = true;\n      for (var j = 1; j < 5; j++) {\n        if (this.bits.bytes[byteIndex + i + 188 * j] !== 0x47) {\n          foundSync = false;\n          break;\n        }\n      }\n\n      if (foundSync) {\n        this.bits.index = byteIndex + i + 1 << 3;\n        return true;\n      }\n    }\n  }\n\n  // In theory, we shouldn't arrive here. If we do, we had enough data but\n  // still didn't find sync - this can only happen if we were fed garbage\n  // data. Check your source!\n  console.warn('JSMpeg: Possible garbage data. Skipping.');\n  this.bits.skip(187 << 3);\n  return false;\n};\n\nTS.prototype.packetStart = function (pi, pts, payloadLength) {\n  pi.totalLength = payloadLength;\n  pi.currentLength = 0;\n  pi.pts = pts;\n};\n\nTS.prototype.packetAddData = function (pi, start, end) {\n  pi.buffers.push(this.bits.bytes.subarray(start, end));\n  pi.currentLength += end - start;\n\n  var complete = pi.totalLength !== 0 && pi.currentLength >= pi.totalLength;\n  return complete;\n};\n\nTS.prototype.packetComplete = function (pi) {\n  pi.destination.write(pi.pts, pi.buffers);\n  pi.totalLength = 0;\n  pi.currentLength = 0;\n  pi.buffers = [];\n};\n\nTS.STREAM = {\n  PACK_HEADER: 0xBA,\n  SYSTEM_HEADER: 0xBB,\n  PROGRAM_MAP: 0xBC,\n  PRIVATE_1: 0xBD,\n  PADDING: 0xBE,\n  PRIVATE_2: 0xBF,\n  AUDIO_1: 0xC0,\n  VIDEO_1: 0xE0,\n  DIRECTORY: 0xFF\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (TS);\n\n/***/ }),\n/* 9 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__index__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__decoder__ = __webpack_require__(1);\n// Inspired by Java MPEG-1 Video Decoder and Player by Zoltan Korandi\n// https://sourceforge.net/projects/javampeg1video/\n\n\n\n\n\nvar MPEG1 = function MPEG1(options) {\n\t__WEBPACK_IMPORTED_MODULE_0__index__[\"Decoder\"].Base.call(this, options);\n\n\tvar bufferSize = options.videoBufferSize || 512 * 1024;\n\tvar bufferMode = options.streaming ? __WEBPACK_IMPORTED_MODULE_0__index__[\"BitBuffer\"].MODE.EVICT : __WEBPACK_IMPORTED_MODULE_0__index__[\"BitBuffer\"].MODE.EXPAND;\n\n\tthis.bits = new __WEBPACK_IMPORTED_MODULE_0__index__[\"BitBuffer\"](bufferSize, bufferMode);\n\n\tthis.customIntraQuantMatrix = new Uint8Array(64);\n\tthis.customNonIntraQuantMatrix = new Uint8Array(64);\n\tthis.blockData = new Int32Array(64);\n\n\tthis.currentFrame = 0;\n\tthis.decodeFirstFrame = options.decodeFirstFrame !== false;\n};\n\nMPEG1.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__decoder__[\"a\" /* default */].prototype);\nMPEG1.prototype.constructor = MPEG1;\n\nMPEG1.prototype.write = function (pts, buffers) {\n\t__WEBPACK_IMPORTED_MODULE_0__index__[\"Decoder\"].Base.prototype.write.call(this, pts, buffers);\n\n\tif (!this.hasSequenceHeader) {\n\t\tif (this.bits.findStartCode(MPEG1.START.SEQUENCE) === -1) {\n\t\t\treturn false;\n\t\t}\n\t\tthis.decodeSequenceHeader();\n\n\t\tif (this.decodeFirstFrame) {\n\t\t\tthis.decode();\n\t\t}\n\t}\n};\n\nMPEG1.prototype.decode = function () {\n\tif (!this.hasSequenceHeader) {\n\t\treturn false;\n\t}\n\n\tif (this.bits.findStartCode(MPEG1.START.PICTURE) === -1) {\n\t\tvar bufferedBytes = this.bits.byteLength - (this.bits.index >> 3);\n\t\treturn false;\n\t}\n\n\tthis.decodePicture();\n\tthis.advanceDecodedTime(1 / this.frameRate);\n\treturn true;\n};\n\nMPEG1.prototype.readHuffman = function (codeTable) {\n\tvar state = 0;\n\tdo {\n\t\tstate = codeTable[state + this.bits.read(1)];\n\t} while (state >= 0 && codeTable[state] !== 0);\n\treturn codeTable[state + 2];\n};\n\n// Sequence Layer\n\nMPEG1.prototype.frameRate = 30;\nMPEG1.prototype.decodeSequenceHeader = function () {\n\tvar newWidth = this.bits.read(12),\n\t    newHeight = this.bits.read(12);\n\n\t// skip pixel aspect ratio\n\tthis.bits.skip(4);\n\n\tthis.frameRate = MPEG1.PICTURE_RATE[this.bits.read(4)];\n\n\t// skip bitRate, marker, bufferSize and constrained bit\n\tthis.bits.skip(18 + 1 + 10 + 1);\n\n\tif (newWidth !== this.width || newHeight !== this.height) {\n\t\tthis.width = newWidth;\n\t\tthis.height = newHeight;\n\n\t\tthis.initBuffers();\n\n\t\tif (this.destination) {\n\t\t\tthis.destination.resize(newWidth, newHeight);\n\t\t}\n\t}\n\n\tif (this.bits.read(1)) {\n\t\t// load custom intra quant matrix?\n\t\tfor (var i = 0; i < 64; i++) {\n\t\t\tthis.customIntraQuantMatrix[MPEG1.ZIG_ZAG[i]] = this.bits.read(8);\n\t\t}\n\t\tthis.intraQuantMatrix = this.customIntraQuantMatrix;\n\t}\n\n\tif (this.bits.read(1)) {\n\t\t// load custom non intra quant matrix?\n\t\tfor (var i = 0; i < 64; i++) {\n\t\t\tvar idx = MPEG1.ZIG_ZAG[i];\n\t\t\tthis.customNonIntraQuantMatrix[idx] = this.bits.read(8);\n\t\t}\n\t\tthis.nonIntraQuantMatrix = this.customNonIntraQuantMatrix;\n\t}\n\n\tthis.hasSequenceHeader = true;\n};\n\nMPEG1.prototype.initBuffers = function () {\n\tthis.intraQuantMatrix = MPEG1.DEFAULT_INTRA_QUANT_MATRIX;\n\tthis.nonIntraQuantMatrix = MPEG1.DEFAULT_NON_INTRA_QUANT_MATRIX;\n\n\tthis.mbWidth = this.width + 15 >> 4;\n\tthis.mbHeight = this.height + 15 >> 4;\n\tthis.mbSize = this.mbWidth * this.mbHeight;\n\n\tthis.codedWidth = this.mbWidth << 4;\n\tthis.codedHeight = this.mbHeight << 4;\n\tthis.codedSize = this.codedWidth * this.codedHeight;\n\n\tthis.halfWidth = this.mbWidth << 3;\n\tthis.halfHeight = this.mbHeight << 3;\n\n\t// Allocated buffers and resize the canvas\n\tthis.currentY = new Uint8ClampedArray(this.codedSize);\n\tthis.currentY32 = new Uint32Array(this.currentY.buffer);\n\n\tthis.currentCr = new Uint8ClampedArray(this.codedSize >> 2);\n\tthis.currentCr32 = new Uint32Array(this.currentCr.buffer);\n\n\tthis.currentCb = new Uint8ClampedArray(this.codedSize >> 2);\n\tthis.currentCb32 = new Uint32Array(this.currentCb.buffer);\n\n\tthis.forwardY = new Uint8ClampedArray(this.codedSize);\n\tthis.forwardY32 = new Uint32Array(this.forwardY.buffer);\n\n\tthis.forwardCr = new Uint8ClampedArray(this.codedSize >> 2);\n\tthis.forwardCr32 = new Uint32Array(this.forwardCr.buffer);\n\n\tthis.forwardCb = new Uint8ClampedArray(this.codedSize >> 2);\n\tthis.forwardCb32 = new Uint32Array(this.forwardCb.buffer);\n};\n\n// Picture Layer\n\nMPEG1.prototype.currentY = null;\nMPEG1.prototype.currentCr = null;\nMPEG1.prototype.currentCb = null;\n\nMPEG1.prototype.pictureType = 0;\n\n// Buffers for motion compensation\nMPEG1.prototype.forwardY = null;\nMPEG1.prototype.forwardCr = null;\nMPEG1.prototype.forwardCb = null;\n\nMPEG1.prototype.fullPelForward = false;\nMPEG1.prototype.forwardFCode = 0;\nMPEG1.prototype.forwardRSize = 0;\nMPEG1.prototype.forwardF = 0;\n\nMPEG1.prototype.decodePicture = function (skipOutput) {\n\tthis.currentFrame++;\n\n\tthis.bits.skip(10); // skip temporalReference\n\tthis.pictureType = this.bits.read(3);\n\tthis.bits.skip(16); // skip vbv_delay\n\n\t// Skip B and D frames or unknown coding type\n\tif (this.pictureType <= 0 || this.pictureType >= MPEG1.PICTURE_TYPE.B) {\n\t\treturn;\n\t}\n\n\t// full_pel_forward, forward_f_code\n\tif (this.pictureType === MPEG1.PICTURE_TYPE.PREDICTIVE) {\n\t\tthis.fullPelForward = this.bits.read(1);\n\t\tthis.forwardFCode = this.bits.read(3);\n\t\tif (this.forwardFCode === 0) {\n\t\t\t// Ignore picture with zero forward_f_code\n\t\t\treturn;\n\t\t}\n\t\tthis.forwardRSize = this.forwardFCode - 1;\n\t\tthis.forwardF = 1 << this.forwardRSize;\n\t}\n\n\tvar code = 0;\n\tdo {\n\t\tcode = this.bits.findNextStartCode();\n\t} while (code === MPEG1.START.EXTENSION || code === MPEG1.START.USER_DATA);\n\n\twhile (code >= MPEG1.START.SLICE_FIRST && code <= MPEG1.START.SLICE_LAST) {\n\t\tthis.decodeSlice(code & 0x000000FF);\n\t\tcode = this.bits.findNextStartCode();\n\t}\n\n\tif (code !== -1) {\n\t\t// We found the next start code; rewind 32bits and let the main loop\n\t\t// handle it.\n\t\tthis.bits.rewind(32);\n\t}\n\n\t// Invoke decode callbacks\n\tif (this.destination) {\n\t\tthis.destination.render(this.currentY, this.currentCr, this.currentCb);\n\t}\n\n\t// If this is a reference picutre then rotate the prediction pointers\n\tif (this.pictureType === MPEG1.PICTURE_TYPE.INTRA || this.pictureType === MPEG1.PICTURE_TYPE.PREDICTIVE) {\n\t\tvar tmpY = this.forwardY,\n\t\t    tmpY32 = this.forwardY32,\n\t\t    tmpCr = this.forwardCr,\n\t\t    tmpCr32 = this.forwardCr32,\n\t\t    tmpCb = this.forwardCb,\n\t\t    tmpCb32 = this.forwardCb32;\n\n\t\tthis.forwardY = this.currentY;\n\t\tthis.forwardY32 = this.currentY32;\n\t\tthis.forwardCr = this.currentCr;\n\t\tthis.forwardCr32 = this.currentCr32;\n\t\tthis.forwardCb = this.currentCb;\n\t\tthis.forwardCb32 = this.currentCb32;\n\n\t\tthis.currentY = tmpY;\n\t\tthis.currentY32 = tmpY32;\n\t\tthis.currentCr = tmpCr;\n\t\tthis.currentCr32 = tmpCr32;\n\t\tthis.currentCb = tmpCb;\n\t\tthis.currentCb32 = tmpCb32;\n\t}\n};\n\n// Slice Layer\n\nMPEG1.prototype.quantizerScale = 0;\nMPEG1.prototype.sliceBegin = false;\n\nMPEG1.prototype.decodeSlice = function (slice) {\n\tthis.sliceBegin = true;\n\tthis.macroblockAddress = (slice - 1) * this.mbWidth - 1;\n\n\t// Reset motion vectors and DC predictors\n\tthis.motionFwH = this.motionFwHPrev = 0;\n\tthis.motionFwV = this.motionFwVPrev = 0;\n\tthis.dcPredictorY = 128;\n\tthis.dcPredictorCr = 128;\n\tthis.dcPredictorCb = 128;\n\n\tthis.quantizerScale = this.bits.read(5);\n\n\t// skip extra bits\n\twhile (this.bits.read(1)) {\n\t\tthis.bits.skip(8);\n\t}\n\n\tdo {\n\t\tthis.decodeMacroblock();\n\t} while (!this.bits.nextBytesAreStartCode());\n};\n\n// Macroblock Layer\n\nMPEG1.prototype.macroblockAddress = 0;\nMPEG1.prototype.mbRow = 0;\nMPEG1.prototype.mbCol = 0;\n\nMPEG1.prototype.macroblockType = 0;\nMPEG1.prototype.macroblockIntra = false;\nMPEG1.prototype.macroblockMotFw = false;\n\nMPEG1.prototype.motionFwH = 0;\nMPEG1.prototype.motionFwV = 0;\nMPEG1.prototype.motionFwHPrev = 0;\nMPEG1.prototype.motionFwVPrev = 0;\n\nMPEG1.prototype.decodeMacroblock = function () {\n\t// Decode macroblock_address_increment\n\tvar increment = 0,\n\t    t = this.readHuffman(MPEG1.MACROBLOCK_ADDRESS_INCREMENT);\n\n\twhile (t === 34) {\n\t\t// macroblock_stuffing\n\t\tt = this.readHuffman(MPEG1.MACROBLOCK_ADDRESS_INCREMENT);\n\t}\n\twhile (t === 35) {\n\t\t// macroblock_escape\n\t\tincrement += 33;\n\t\tt = this.readHuffman(MPEG1.MACROBLOCK_ADDRESS_INCREMENT);\n\t}\n\tincrement += t;\n\n\t// Process any skipped macroblocks\n\tif (this.sliceBegin) {\n\t\t// The first macroblock_address_increment of each slice is relative\n\t\t// to beginning of the preverious row, not the preverious macroblock\n\t\tthis.sliceBegin = false;\n\t\tthis.macroblockAddress += increment;\n\t} else {\n\t\tif (this.macroblockAddress + increment >= this.mbSize) {\n\t\t\t// Illegal (too large) macroblock_address_increment\n\t\t\treturn;\n\t\t}\n\t\tif (increment > 1) {\n\t\t\t// Skipped macroblocks reset DC predictors\n\t\t\tthis.dcPredictorY = 128;\n\t\t\tthis.dcPredictorCr = 128;\n\t\t\tthis.dcPredictorCb = 128;\n\n\t\t\t// Skipped macroblocks in P-pictures reset motion vectors\n\t\t\tif (this.pictureType === MPEG1.PICTURE_TYPE.PREDICTIVE) {\n\t\t\t\tthis.motionFwH = this.motionFwHPrev = 0;\n\t\t\t\tthis.motionFwV = this.motionFwVPrev = 0;\n\t\t\t}\n\t\t}\n\n\t\t// Predict skipped macroblocks\n\t\twhile (increment > 1) {\n\t\t\tthis.macroblockAddress++;\n\t\t\tthis.mbRow = this.macroblockAddress / this.mbWidth | 0;\n\t\t\tthis.mbCol = this.macroblockAddress % this.mbWidth;\n\t\t\tthis.copyMacroblock(this.motionFwH, this.motionFwV, this.forwardY, this.forwardCr, this.forwardCb);\n\t\t\tincrement--;\n\t\t}\n\t\tthis.macroblockAddress++;\n\t}\n\tthis.mbRow = this.macroblockAddress / this.mbWidth | 0;\n\tthis.mbCol = this.macroblockAddress % this.mbWidth;\n\n\t// Process the current macroblock\n\tvar mbTable = MPEG1.MACROBLOCK_TYPE[this.pictureType];\n\tthis.macroblockType = this.readHuffman(mbTable);\n\tthis.macroblockIntra = this.macroblockType & 0x01;\n\tthis.macroblockMotFw = this.macroblockType & 0x08;\n\n\t// Quantizer scale\n\tif ((this.macroblockType & 0x10) !== 0) {\n\t\tthis.quantizerScale = this.bits.read(5);\n\t}\n\n\tif (this.macroblockIntra) {\n\t\t// Intra-coded macroblocks reset motion vectors\n\t\tthis.motionFwH = this.motionFwHPrev = 0;\n\t\tthis.motionFwV = this.motionFwVPrev = 0;\n\t} else {\n\t\t// Non-intra macroblocks reset DC predictors\n\t\tthis.dcPredictorY = 128;\n\t\tthis.dcPredictorCr = 128;\n\t\tthis.dcPredictorCb = 128;\n\n\t\tthis.decodeMotionVectors();\n\t\tthis.copyMacroblock(this.motionFwH, this.motionFwV, this.forwardY, this.forwardCr, this.forwardCb);\n\t}\n\n\t// Decode blocks\n\tvar cbp = (this.macroblockType & 0x02) !== 0 ? this.readHuffman(MPEG1.CODE_BLOCK_PATTERN) : this.macroblockIntra ? 0x3f : 0;\n\n\tfor (var block = 0, mask = 0x20; block < 6; block++) {\n\t\tif ((cbp & mask) !== 0) {\n\t\t\tthis.decodeBlock(block);\n\t\t}\n\t\tmask >>= 1;\n\t}\n};\n\nMPEG1.prototype.decodeMotionVectors = function () {\n\tvar code,\n\t    d,\n\t    r = 0;\n\n\t// Forward\n\tif (this.macroblockMotFw) {\n\t\t// Horizontal forward\n\t\tcode = this.readHuffman(MPEG1.MOTION);\n\t\tif (code !== 0 && this.forwardF !== 1) {\n\t\t\tr = this.bits.read(this.forwardRSize);\n\t\t\td = (Math.abs(code) - 1 << this.forwardRSize) + r + 1;\n\t\t\tif (code < 0) {\n\t\t\t\td = -d;\n\t\t\t}\n\t\t} else {\n\t\t\td = code;\n\t\t}\n\n\t\tthis.motionFwHPrev += d;\n\t\tif (this.motionFwHPrev > (this.forwardF << 4) - 1) {\n\t\t\tthis.motionFwHPrev -= this.forwardF << 5;\n\t\t} else if (this.motionFwHPrev < -this.forwardF << 4) {\n\t\t\tthis.motionFwHPrev += this.forwardF << 5;\n\t\t}\n\n\t\tthis.motionFwH = this.motionFwHPrev;\n\t\tif (this.fullPelForward) {\n\t\t\tthis.motionFwH <<= 1;\n\t\t}\n\n\t\t// Vertical forward\n\t\tcode = this.readHuffman(MPEG1.MOTION);\n\t\tif (code !== 0 && this.forwardF !== 1) {\n\t\t\tr = this.bits.read(this.forwardRSize);\n\t\t\td = (Math.abs(code) - 1 << this.forwardRSize) + r + 1;\n\t\t\tif (code < 0) {\n\t\t\t\td = -d;\n\t\t\t}\n\t\t} else {\n\t\t\td = code;\n\t\t}\n\n\t\tthis.motionFwVPrev += d;\n\t\tif (this.motionFwVPrev > (this.forwardF << 4) - 1) {\n\t\t\tthis.motionFwVPrev -= this.forwardF << 5;\n\t\t} else if (this.motionFwVPrev < -this.forwardF << 4) {\n\t\t\tthis.motionFwVPrev += this.forwardF << 5;\n\t\t}\n\n\t\tthis.motionFwV = this.motionFwVPrev;\n\t\tif (this.fullPelForward) {\n\t\t\tthis.motionFwV <<= 1;\n\t\t}\n\t} else if (this.pictureType === MPEG1.PICTURE_TYPE.PREDICTIVE) {\n\t\t// No motion information in P-picture, reset vectors\n\t\tthis.motionFwH = this.motionFwHPrev = 0;\n\t\tthis.motionFwV = this.motionFwVPrev = 0;\n\t}\n};\n\nMPEG1.prototype.copyMacroblock = function (motionH, motionV, sY, sCr, sCb) {\n\tvar width, scan, H, V, oddH, oddV, src, dest, last;\n\n\t// We use 32bit writes here\n\tvar dY = this.currentY32,\n\t    dCb = this.currentCb32,\n\t    dCr = this.currentCr32;\n\n\t// Luminance\n\twidth = this.codedWidth;\n\tscan = width - 16;\n\n\tH = motionH >> 1;\n\tV = motionV >> 1;\n\toddH = (motionH & 1) === 1;\n\toddV = (motionV & 1) === 1;\n\n\tsrc = ((this.mbRow << 4) + V) * width + (this.mbCol << 4) + H;\n\tdest = this.mbRow * width + this.mbCol << 2;\n\tlast = dest + (width << 2);\n\n\tvar x, y1, y2, y;\n\tif (oddH) {\n\t\tif (oddV) {\n\t\t\twhile (dest < last) {\n\t\t\t\ty1 = sY[src] + sY[src + width];src++;\n\t\t\t\tfor (x = 0; x < 4; x++) {\n\t\t\t\t\ty2 = sY[src] + sY[src + width];src++;\n\t\t\t\t\ty = y1 + y2 + 2 >> 2 & 0xff;\n\n\t\t\t\t\ty1 = sY[src] + sY[src + width];src++;\n\t\t\t\t\ty |= y1 + y2 + 2 << 6 & 0xff00;\n\n\t\t\t\t\ty2 = sY[src] + sY[src + width];src++;\n\t\t\t\t\ty |= y1 + y2 + 2 << 14 & 0xff0000;\n\n\t\t\t\t\ty1 = sY[src] + sY[src + width];src++;\n\t\t\t\t\ty |= y1 + y2 + 2 << 22 & 0xff000000;\n\n\t\t\t\t\tdY[dest++] = y;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2;src += scan - 1;\n\t\t\t}\n\t\t} else {\n\t\t\twhile (dest < last) {\n\t\t\t\ty1 = sY[src++];\n\t\t\t\tfor (x = 0; x < 4; x++) {\n\t\t\t\t\ty2 = sY[src++];\n\t\t\t\t\ty = y1 + y2 + 1 >> 1 & 0xff;\n\n\t\t\t\t\ty1 = sY[src++];\n\t\t\t\t\ty |= y1 + y2 + 1 << 7 & 0xff00;\n\n\t\t\t\t\ty2 = sY[src++];\n\t\t\t\t\ty |= y1 + y2 + 1 << 15 & 0xff0000;\n\n\t\t\t\t\ty1 = sY[src++];\n\t\t\t\t\ty |= y1 + y2 + 1 << 23 & 0xff000000;\n\n\t\t\t\t\tdY[dest++] = y;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2;src += scan - 1;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (oddV) {\n\t\t\twhile (dest < last) {\n\t\t\t\tfor (x = 0; x < 4; x++) {\n\t\t\t\t\ty = sY[src] + sY[src + width] + 1 >> 1 & 0xff;src++;\n\t\t\t\t\ty |= sY[src] + sY[src + width] + 1 << 7 & 0xff00;src++;\n\t\t\t\t\ty |= sY[src] + sY[src + width] + 1 << 15 & 0xff0000;src++;\n\t\t\t\t\ty |= sY[src] + sY[src + width] + 1 << 23 & 0xff000000;src++;\n\n\t\t\t\t\tdY[dest++] = y;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2;src += scan;\n\t\t\t}\n\t\t} else {\n\t\t\twhile (dest < last) {\n\t\t\t\tfor (x = 0; x < 4; x++) {\n\t\t\t\t\ty = sY[src];src++;\n\t\t\t\t\ty |= sY[src] << 8;src++;\n\t\t\t\t\ty |= sY[src] << 16;src++;\n\t\t\t\t\ty |= sY[src] << 24;src++;\n\n\t\t\t\t\tdY[dest++] = y;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2;src += scan;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Chrominance\n\n\twidth = this.halfWidth;\n\tscan = width - 8;\n\n\tH = motionH / 2 >> 1;\n\tV = motionV / 2 >> 1;\n\toddH = (motionH / 2 & 1) === 1;\n\toddV = (motionV / 2 & 1) === 1;\n\n\tsrc = ((this.mbRow << 3) + V) * width + (this.mbCol << 3) + H;\n\tdest = this.mbRow * width + this.mbCol << 1;\n\tlast = dest + (width << 1);\n\n\tvar cr1, cr2, cr, cb1, cb2, cb;\n\tif (oddH) {\n\t\tif (oddV) {\n\t\t\twhile (dest < last) {\n\t\t\t\tcr1 = sCr[src] + sCr[src + width];\n\t\t\t\tcb1 = sCb[src] + sCb[src + width];\n\t\t\t\tsrc++;\n\t\t\t\tfor (x = 0; x < 2; x++) {\n\t\t\t\t\tcr2 = sCr[src] + sCr[src + width];\n\t\t\t\t\tcb2 = sCb[src] + sCb[src + width];src++;\n\t\t\t\t\tcr = cr1 + cr2 + 2 >> 2 & 0xff;\n\t\t\t\t\tcb = cb1 + cb2 + 2 >> 2 & 0xff;\n\n\t\t\t\t\tcr1 = sCr[src] + sCr[src + width];\n\t\t\t\t\tcb1 = sCb[src] + sCb[src + width];src++;\n\t\t\t\t\tcr |= cr1 + cr2 + 2 << 6 & 0xff00;\n\t\t\t\t\tcb |= cb1 + cb2 + 2 << 6 & 0xff00;\n\n\t\t\t\t\tcr2 = sCr[src] + sCr[src + width];\n\t\t\t\t\tcb2 = sCb[src] + sCb[src + width];src++;\n\t\t\t\t\tcr |= cr1 + cr2 + 2 << 14 & 0xff0000;\n\t\t\t\t\tcb |= cb1 + cb2 + 2 << 14 & 0xff0000;\n\n\t\t\t\t\tcr1 = sCr[src] + sCr[src + width];\n\t\t\t\t\tcb1 = sCb[src] + sCb[src + width];src++;\n\t\t\t\t\tcr |= cr1 + cr2 + 2 << 22 & 0xff000000;\n\t\t\t\t\tcb |= cb1 + cb2 + 2 << 22 & 0xff000000;\n\n\t\t\t\t\tdCr[dest] = cr;\n\t\t\t\t\tdCb[dest] = cb;\n\t\t\t\t\tdest++;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2;src += scan - 1;\n\t\t\t}\n\t\t} else {\n\t\t\twhile (dest < last) {\n\t\t\t\tcr1 = sCr[src];\n\t\t\t\tcb1 = sCb[src];\n\t\t\t\tsrc++;\n\t\t\t\tfor (x = 0; x < 2; x++) {\n\t\t\t\t\tcr2 = sCr[src];\n\t\t\t\t\tcb2 = sCb[src++];\n\t\t\t\t\tcr = cr1 + cr2 + 1 >> 1 & 0xff;\n\t\t\t\t\tcb = cb1 + cb2 + 1 >> 1 & 0xff;\n\n\t\t\t\t\tcr1 = sCr[src];\n\t\t\t\t\tcb1 = sCb[src++];\n\t\t\t\t\tcr |= cr1 + cr2 + 1 << 7 & 0xff00;\n\t\t\t\t\tcb |= cb1 + cb2 + 1 << 7 & 0xff00;\n\n\t\t\t\t\tcr2 = sCr[src];\n\t\t\t\t\tcb2 = sCb[src++];\n\t\t\t\t\tcr |= cr1 + cr2 + 1 << 15 & 0xff0000;\n\t\t\t\t\tcb |= cb1 + cb2 + 1 << 15 & 0xff0000;\n\n\t\t\t\t\tcr1 = sCr[src];\n\t\t\t\t\tcb1 = sCb[src++];\n\t\t\t\t\tcr |= cr1 + cr2 + 1 << 23 & 0xff000000;\n\t\t\t\t\tcb |= cb1 + cb2 + 1 << 23 & 0xff000000;\n\n\t\t\t\t\tdCr[dest] = cr;\n\t\t\t\t\tdCb[dest] = cb;\n\t\t\t\t\tdest++;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2;src += scan - 1;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (oddV) {\n\t\t\twhile (dest < last) {\n\t\t\t\tfor (x = 0; x < 2; x++) {\n\t\t\t\t\tcr = sCr[src] + sCr[src + width] + 1 >> 1 & 0xff;\n\t\t\t\t\tcb = sCb[src] + sCb[src + width] + 1 >> 1 & 0xff;src++;\n\n\t\t\t\t\tcr |= sCr[src] + sCr[src + width] + 1 << 7 & 0xff00;\n\t\t\t\t\tcb |= sCb[src] + sCb[src + width] + 1 << 7 & 0xff00;src++;\n\n\t\t\t\t\tcr |= sCr[src] + sCr[src + width] + 1 << 15 & 0xff0000;\n\t\t\t\t\tcb |= sCb[src] + sCb[src + width] + 1 << 15 & 0xff0000;src++;\n\n\t\t\t\t\tcr |= sCr[src] + sCr[src + width] + 1 << 23 & 0xff000000;\n\t\t\t\t\tcb |= sCb[src] + sCb[src + width] + 1 << 23 & 0xff000000;src++;\n\n\t\t\t\t\tdCr[dest] = cr;\n\t\t\t\t\tdCb[dest] = cb;\n\t\t\t\t\tdest++;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2;src += scan;\n\t\t\t}\n\t\t} else {\n\t\t\twhile (dest < last) {\n\t\t\t\tfor (x = 0; x < 2; x++) {\n\t\t\t\t\tcr = sCr[src];\n\t\t\t\t\tcb = sCb[src];src++;\n\n\t\t\t\t\tcr |= sCr[src] << 8;\n\t\t\t\t\tcb |= sCb[src] << 8;src++;\n\n\t\t\t\t\tcr |= sCr[src] << 16;\n\t\t\t\t\tcb |= sCb[src] << 16;src++;\n\n\t\t\t\t\tcr |= sCr[src] << 24;\n\t\t\t\t\tcb |= sCb[src] << 24;src++;\n\n\t\t\t\t\tdCr[dest] = cr;\n\t\t\t\t\tdCb[dest] = cb;\n\t\t\t\t\tdest++;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2;src += scan;\n\t\t\t}\n\t\t}\n\t}\n};\n\n// Block layer\n\nMPEG1.prototype.dcPredictorY = 0;\nMPEG1.prototype.dcPredictorCr = 0;\nMPEG1.prototype.dcPredictorCb = 0;\n\nMPEG1.prototype.blockData = null;\n\nMPEG1.prototype.decodeBlock = function (block) {\n\n\tvar n = 0,\n\t    quantMatrix;\n\n\t// Decode DC coefficient of intra-coded blocks\n\tif (this.macroblockIntra) {\n\t\tvar predictor, dctSize;\n\n\t\t// DC prediction\n\n\t\tif (block < 4) {\n\t\t\tpredictor = this.dcPredictorY;\n\t\t\tdctSize = this.readHuffman(MPEG1.DCT_DC_SIZE_LUMINANCE);\n\t\t} else {\n\t\t\tpredictor = block === 4 ? this.dcPredictorCr : this.dcPredictorCb;\n\t\t\tdctSize = this.readHuffman(MPEG1.DCT_DC_SIZE_CHROMINANCE);\n\t\t}\n\n\t\t// Read DC coeff\n\t\tif (dctSize > 0) {\n\t\t\tvar differential = this.bits.read(dctSize);\n\t\t\tif ((differential & 1 << dctSize - 1) !== 0) {\n\t\t\t\tthis.blockData[0] = predictor + differential;\n\t\t\t} else {\n\t\t\t\tthis.blockData[0] = predictor + (-1 << dctSize | differential + 1);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.blockData[0] = predictor;\n\t\t}\n\n\t\t// Save predictor value\n\t\tif (block < 4) {\n\t\t\tthis.dcPredictorY = this.blockData[0];\n\t\t} else if (block === 4) {\n\t\t\tthis.dcPredictorCr = this.blockData[0];\n\t\t} else {\n\t\t\tthis.dcPredictorCb = this.blockData[0];\n\t\t}\n\n\t\t// Dequantize + premultiply\n\t\tthis.blockData[0] <<= 3 + 5;\n\n\t\tquantMatrix = this.intraQuantMatrix;\n\t\tn = 1;\n\t} else {\n\t\tquantMatrix = this.nonIntraQuantMatrix;\n\t}\n\n\t// Decode AC coefficients (+DC for non-intra)\n\tvar level = 0;\n\twhile (true) {\n\t\tvar run = 0,\n\t\t    coeff = this.readHuffman(MPEG1.DCT_COEFF);\n\n\t\tif (coeff === 0x0001 && n > 0 && this.bits.read(1) === 0) {\n\t\t\t// end_of_block\n\t\t\tbreak;\n\t\t}\n\t\tif (coeff === 0xffff) {\n\t\t\t// escape\n\t\t\trun = this.bits.read(6);\n\t\t\tlevel = this.bits.read(8);\n\t\t\tif (level === 0) {\n\t\t\t\tlevel = this.bits.read(8);\n\t\t\t} else if (level === 128) {\n\t\t\t\tlevel = this.bits.read(8) - 256;\n\t\t\t} else if (level > 128) {\n\t\t\t\tlevel = level - 256;\n\t\t\t}\n\t\t} else {\n\t\t\trun = coeff >> 8;\n\t\t\tlevel = coeff & 0xff;\n\t\t\tif (this.bits.read(1)) {\n\t\t\t\tlevel = -level;\n\t\t\t}\n\t\t}\n\n\t\tn += run;\n\t\tvar dezigZagged = MPEG1.ZIG_ZAG[n];\n\t\tn++;\n\n\t\t// Dequantize, oddify, clip\n\t\tlevel <<= 1;\n\t\tif (!this.macroblockIntra) {\n\t\t\tlevel += level < 0 ? -1 : 1;\n\t\t}\n\t\tlevel = level * this.quantizerScale * quantMatrix[dezigZagged] >> 4;\n\t\tif ((level & 1) === 0) {\n\t\t\tlevel -= level > 0 ? 1 : -1;\n\t\t}\n\t\tif (level > 2047) {\n\t\t\tlevel = 2047;\n\t\t} else if (level < -2048) {\n\t\t\tlevel = -2048;\n\t\t}\n\n\t\t// Save premultiplied coefficient\n\t\tthis.blockData[dezigZagged] = level * MPEG1.PREMULTIPLIER_MATRIX[dezigZagged];\n\t}\n\n\t// Move block to its place\n\tvar destArray, destIndex, scan;\n\n\tif (block < 4) {\n\t\tdestArray = this.currentY;\n\t\tscan = this.codedWidth - 8;\n\t\tdestIndex = this.mbRow * this.codedWidth + this.mbCol << 4;\n\t\tif ((block & 1) !== 0) {\n\t\t\tdestIndex += 8;\n\t\t}\n\t\tif ((block & 2) !== 0) {\n\t\t\tdestIndex += this.codedWidth << 3;\n\t\t}\n\t} else {\n\t\tdestArray = block === 4 ? this.currentCb : this.currentCr;\n\t\tscan = (this.codedWidth >> 1) - 8;\n\t\tdestIndex = (this.mbRow * this.codedWidth << 2) + (this.mbCol << 3);\n\t}\n\n\tif (this.macroblockIntra) {\n\t\t// Overwrite (no prediction)\n\t\tif (n === 1) {\n\t\t\tMPEG1.CopyValueToDestination(this.blockData[0] + 128 >> 8, destArray, destIndex, scan);\n\t\t\tthis.blockData[0] = 0;\n\t\t} else {\n\t\t\tMPEG1.IDCT(this.blockData);\n\t\t\tMPEG1.CopyBlockToDestination(this.blockData, destArray, destIndex, scan);\n\t\t\tObject(__WEBPACK_IMPORTED_MODULE_0__index__[\"Fill\"])(this.blockData, 0);\n\t\t}\n\t} else {\n\t\t// Add data to the predicted macroblock\n\t\tif (n === 1) {\n\t\t\tMPEG1.AddValueToDestination(this.blockData[0] + 128 >> 8, destArray, destIndex, scan);\n\t\t\tthis.blockData[0] = 0;\n\t\t} else {\n\t\t\tMPEG1.IDCT(this.blockData);\n\t\t\tMPEG1.AddBlockToDestination(this.blockData, destArray, destIndex, scan);\n\t\t\tObject(__WEBPACK_IMPORTED_MODULE_0__index__[\"Fill\"])(this.blockData, 0);\n\t\t}\n\t}\n\n\tn = 0;\n};\n\nMPEG1.CopyBlockToDestination = function (block, dest, index, scan) {\n\tfor (var n = 0; n < 64; n += 8, index += scan + 8) {\n\t\tdest[index + 0] = block[n + 0];\n\t\tdest[index + 1] = block[n + 1];\n\t\tdest[index + 2] = block[n + 2];\n\t\tdest[index + 3] = block[n + 3];\n\t\tdest[index + 4] = block[n + 4];\n\t\tdest[index + 5] = block[n + 5];\n\t\tdest[index + 6] = block[n + 6];\n\t\tdest[index + 7] = block[n + 7];\n\t}\n};\n\nMPEG1.AddBlockToDestination = function (block, dest, index, scan) {\n\tfor (var n = 0; n < 64; n += 8, index += scan + 8) {\n\t\tdest[index + 0] += block[n + 0];\n\t\tdest[index + 1] += block[n + 1];\n\t\tdest[index + 2] += block[n + 2];\n\t\tdest[index + 3] += block[n + 3];\n\t\tdest[index + 4] += block[n + 4];\n\t\tdest[index + 5] += block[n + 5];\n\t\tdest[index + 6] += block[n + 6];\n\t\tdest[index + 7] += block[n + 7];\n\t}\n};\n\nMPEG1.CopyValueToDestination = function (value, dest, index, scan) {\n\tfor (var n = 0; n < 64; n += 8, index += scan + 8) {\n\t\tdest[index + 0] = value;\n\t\tdest[index + 1] = value;\n\t\tdest[index + 2] = value;\n\t\tdest[index + 3] = value;\n\t\tdest[index + 4] = value;\n\t\tdest[index + 5] = value;\n\t\tdest[index + 6] = value;\n\t\tdest[index + 7] = value;\n\t}\n};\n\nMPEG1.AddValueToDestination = function (value, dest, index, scan) {\n\tfor (var n = 0; n < 64; n += 8, index += scan + 8) {\n\t\tdest[index + 0] += value;\n\t\tdest[index + 1] += value;\n\t\tdest[index + 2] += value;\n\t\tdest[index + 3] += value;\n\t\tdest[index + 4] += value;\n\t\tdest[index + 5] += value;\n\t\tdest[index + 6] += value;\n\t\tdest[index + 7] += value;\n\t}\n};\n\nMPEG1.IDCT = function (block) {\n\t// See http://vsr.informatik.tu-chemnitz.de/~jan/MPEG/HTML/IDCT.html\n\t// for more info.\n\n\tvar b1, b3, b4, b6, b7, tmp1, tmp2, m0, x0, x1, x2, x3, x4, y3, y4, y5, y6, y7;\n\n\t// Transform columns\n\tfor (var i = 0; i < 8; ++i) {\n\t\tb1 = block[4 * 8 + i];\n\t\tb3 = block[2 * 8 + i] + block[6 * 8 + i];\n\t\tb4 = block[5 * 8 + i] - block[3 * 8 + i];\n\t\ttmp1 = block[1 * 8 + i] + block[7 * 8 + i];\n\t\ttmp2 = block[3 * 8 + i] + block[5 * 8 + i];\n\t\tb6 = block[1 * 8 + i] - block[7 * 8 + i];\n\t\tb7 = tmp1 + tmp2;\n\t\tm0 = block[0 * 8 + i];\n\t\tx4 = (b6 * 473 - b4 * 196 + 128 >> 8) - b7;\n\t\tx0 = x4 - ((tmp1 - tmp2) * 362 + 128 >> 8);\n\t\tx1 = m0 - b1;\n\t\tx2 = ((block[2 * 8 + i] - block[6 * 8 + i]) * 362 + 128 >> 8) - b3;\n\t\tx3 = m0 + b1;\n\t\ty3 = x1 + x2;\n\t\ty4 = x3 + b3;\n\t\ty5 = x1 - x2;\n\t\ty6 = x3 - b3;\n\t\ty7 = -x0 - (b4 * 473 + b6 * 196 + 128 >> 8);\n\t\tblock[0 * 8 + i] = b7 + y4;\n\t\tblock[1 * 8 + i] = x4 + y3;\n\t\tblock[2 * 8 + i] = y5 - x0;\n\t\tblock[3 * 8 + i] = y6 - y7;\n\t\tblock[4 * 8 + i] = y6 + y7;\n\t\tblock[5 * 8 + i] = x0 + y5;\n\t\tblock[6 * 8 + i] = y3 - x4;\n\t\tblock[7 * 8 + i] = y4 - b7;\n\t}\n\n\t// Transform rows\n\tfor (var i = 0; i < 64; i += 8) {\n\t\tb1 = block[4 + i];\n\t\tb3 = block[2 + i] + block[6 + i];\n\t\tb4 = block[5 + i] - block[3 + i];\n\t\ttmp1 = block[1 + i] + block[7 + i];\n\t\ttmp2 = block[3 + i] + block[5 + i];\n\t\tb6 = block[1 + i] - block[7 + i];\n\t\tb7 = tmp1 + tmp2;\n\t\tm0 = block[0 + i];\n\t\tx4 = (b6 * 473 - b4 * 196 + 128 >> 8) - b7;\n\t\tx0 = x4 - ((tmp1 - tmp2) * 362 + 128 >> 8);\n\t\tx1 = m0 - b1;\n\t\tx2 = ((block[2 + i] - block[6 + i]) * 362 + 128 >> 8) - b3;\n\t\tx3 = m0 + b1;\n\t\ty3 = x1 + x2;\n\t\ty4 = x3 + b3;\n\t\ty5 = x1 - x2;\n\t\ty6 = x3 - b3;\n\t\ty7 = -x0 - (b4 * 473 + b6 * 196 + 128 >> 8);\n\t\tblock[0 + i] = b7 + y4 + 128 >> 8;\n\t\tblock[1 + i] = x4 + y3 + 128 >> 8;\n\t\tblock[2 + i] = y5 - x0 + 128 >> 8;\n\t\tblock[3 + i] = y6 - y7 + 128 >> 8;\n\t\tblock[4 + i] = y6 + y7 + 128 >> 8;\n\t\tblock[5 + i] = x0 + y5 + 128 >> 8;\n\t\tblock[6 + i] = y3 - x4 + 128 >> 8;\n\t\tblock[7 + i] = y4 - b7 + 128 >> 8;\n\t}\n};\n\n// VLC Tables and Constants\n\nMPEG1.PICTURE_RATE = [0.000, 23.976, 24.000, 25.000, 29.970, 30.000, 50.000, 59.940, 60.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000];\n\nMPEG1.ZIG_ZAG = new Uint8Array([0, 1, 8, 16, 9, 2, 3, 10, 17, 24, 32, 25, 18, 11, 4, 5, 12, 19, 26, 33, 40, 48, 41, 34, 27, 20, 13, 6, 7, 14, 21, 28, 35, 42, 49, 56, 57, 50, 43, 36, 29, 22, 15, 23, 30, 37, 44, 51, 58, 59, 52, 45, 38, 31, 39, 46, 53, 60, 61, 54, 47, 55, 62, 63]);\n\nMPEG1.DEFAULT_INTRA_QUANT_MATRIX = new Uint8Array([8, 16, 19, 22, 26, 27, 29, 34, 16, 16, 22, 24, 27, 29, 34, 37, 19, 22, 26, 27, 29, 34, 34, 38, 22, 22, 26, 27, 29, 34, 37, 40, 22, 26, 27, 29, 32, 35, 40, 48, 26, 27, 29, 32, 35, 40, 48, 58, 26, 27, 29, 34, 38, 46, 56, 69, 27, 29, 35, 38, 46, 56, 69, 83]);\n\nMPEG1.DEFAULT_NON_INTRA_QUANT_MATRIX = new Uint8Array([16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]);\n\nMPEG1.PREMULTIPLIER_MATRIX = new Uint8Array([32, 44, 42, 38, 32, 25, 17, 9, 44, 62, 58, 52, 44, 35, 24, 12, 42, 58, 55, 49, 42, 33, 23, 12, 38, 52, 49, 44, 38, 30, 20, 10, 32, 44, 42, 38, 32, 25, 17, 9, 25, 35, 33, 30, 25, 20, 14, 7, 17, 24, 23, 20, 17, 14, 9, 5, 9, 12, 12, 10, 9, 7, 5, 2]);\n\n// MPEG-1 VLC\n\n//  macroblock_stuffing decodes as 34.\n//  macroblock_escape decodes as 35.\n\nMPEG1.MACROBLOCK_ADDRESS_INCREMENT = new Int16Array([1 * 3, 2 * 3, 0, //   0\n3 * 3, 4 * 3, 0, //   1  0\n0, 0, 1, //   2  1.\n5 * 3, 6 * 3, 0, //   3  00\n7 * 3, 8 * 3, 0, //   4  01\n9 * 3, 10 * 3, 0, //   5  000\n11 * 3, 12 * 3, 0, //   6  001\n0, 0, 3, //   7  010.\n0, 0, 2, //   8  011.\n13 * 3, 14 * 3, 0, //   9  0000\n15 * 3, 16 * 3, 0, //  10  0001\n0, 0, 5, //  11  0010.\n0, 0, 4, //  12  0011.\n17 * 3, 18 * 3, 0, //  13  0000 0\n19 * 3, 20 * 3, 0, //  14  0000 1\n0, 0, 7, //  15  0001 0.\n0, 0, 6, //  16  0001 1.\n21 * 3, 22 * 3, 0, //  17  0000 00\n23 * 3, 24 * 3, 0, //  18  0000 01\n25 * 3, 26 * 3, 0, //  19  0000 10\n27 * 3, 28 * 3, 0, //  20  0000 11\n-1, 29 * 3, 0, //  21  0000 000\n-1, 30 * 3, 0, //  22  0000 001\n31 * 3, 32 * 3, 0, //  23  0000 010\n33 * 3, 34 * 3, 0, //  24  0000 011\n35 * 3, 36 * 3, 0, //  25  0000 100\n37 * 3, 38 * 3, 0, //  26  0000 101\n0, 0, 9, //  27  0000 110.\n0, 0, 8, //  28  0000 111.\n39 * 3, 40 * 3, 0, //  29  0000 0001\n41 * 3, 42 * 3, 0, //  30  0000 0011\n43 * 3, 44 * 3, 0, //  31  0000 0100\n45 * 3, 46 * 3, 0, //  32  0000 0101\n0, 0, 15, //  33  0000 0110.\n0, 0, 14, //  34  0000 0111.\n0, 0, 13, //  35  0000 1000.\n0, 0, 12, //  36  0000 1001.\n0, 0, 11, //  37  0000 1010.\n0, 0, 10, //  38  0000 1011.\n47 * 3, -1, 0, //  39  0000 0001 0\n-1, 48 * 3, 0, //  40  0000 0001 1\n49 * 3, 50 * 3, 0, //  41  0000 0011 0\n51 * 3, 52 * 3, 0, //  42  0000 0011 1\n53 * 3, 54 * 3, 0, //  43  0000 0100 0\n55 * 3, 56 * 3, 0, //  44  0000 0100 1\n57 * 3, 58 * 3, 0, //  45  0000 0101 0\n59 * 3, 60 * 3, 0, //  46  0000 0101 1\n61 * 3, -1, 0, //  47  0000 0001 00\n-1, 62 * 3, 0, //  48  0000 0001 11\n63 * 3, 64 * 3, 0, //  49  0000 0011 00\n65 * 3, 66 * 3, 0, //  50  0000 0011 01\n67 * 3, 68 * 3, 0, //  51  0000 0011 10\n69 * 3, 70 * 3, 0, //  52  0000 0011 11\n71 * 3, 72 * 3, 0, //  53  0000 0100 00\n73 * 3, 74 * 3, 0, //  54  0000 0100 01\n0, 0, 21, //  55  0000 0100 10.\n0, 0, 20, //  56  0000 0100 11.\n0, 0, 19, //  57  0000 0101 00.\n0, 0, 18, //  58  0000 0101 01.\n0, 0, 17, //  59  0000 0101 10.\n0, 0, 16, //  60  0000 0101 11.\n0, 0, 35, //  61  0000 0001 000. -- macroblock_escape\n0, 0, 34, //  62  0000 0001 111. -- macroblock_stuffing\n0, 0, 33, //  63  0000 0011 000.\n0, 0, 32, //  64  0000 0011 001.\n0, 0, 31, //  65  0000 0011 010.\n0, 0, 30, //  66  0000 0011 011.\n0, 0, 29, //  67  0000 0011 100.\n0, 0, 28, //  68  0000 0011 101.\n0, 0, 27, //  69  0000 0011 110.\n0, 0, 26, //  70  0000 0011 111.\n0, 0, 25, //  71  0000 0100 000.\n0, 0, 24, //  72  0000 0100 001.\n0, 0, 23, //  73  0000 0100 010.\n0, 0, 22 //  74  0000 0100 011.\n]);\n\n//  macroblock_type bitmap:\n//    0x10  macroblock_quant\n//    0x08  macroblock_motion_forward\n//    0x04  macroblock_motion_backward\n//    0x02  macrobkock_pattern\n//    0x01  macroblock_intra\n//\n\nMPEG1.MACROBLOCK_TYPE_INTRA = new Int8Array([1 * 3, 2 * 3, 0, //   0\n-1, 3 * 3, 0, //   1  0\n0, 0, 0x01, //   2  1.\n0, 0, 0x11 //   3  01.\n]);\n\nMPEG1.MACROBLOCK_TYPE_PREDICTIVE = new Int8Array([1 * 3, 2 * 3, 0, //  0\n3 * 3, 4 * 3, 0, //  1  0\n0, 0, 0x0a, //  2  1.\n5 * 3, 6 * 3, 0, //  3  00\n0, 0, 0x02, //  4  01.\n7 * 3, 8 * 3, 0, //  5  000\n0, 0, 0x08, //  6  001.\n9 * 3, 10 * 3, 0, //  7  0000\n11 * 3, 12 * 3, 0, //  8  0001\n-1, 13 * 3, 0, //  9  00000\n0, 0, 0x12, // 10  00001.\n0, 0, 0x1a, // 11  00010.\n0, 0, 0x01, // 12  00011.\n0, 0, 0x11 // 13  000001.\n]);\n\nMPEG1.MACROBLOCK_TYPE_B = new Int8Array([1 * 3, 2 * 3, 0, //  0\n3 * 3, 5 * 3, 0, //  1  0\n4 * 3, 6 * 3, 0, //  2  1\n8 * 3, 7 * 3, 0, //  3  00\n0, 0, 0x0c, //  4  10.\n9 * 3, 10 * 3, 0, //  5  01\n0, 0, 0x0e, //  6  11.\n13 * 3, 14 * 3, 0, //  7  001\n12 * 3, 11 * 3, 0, //  8  000\n0, 0, 0x04, //  9  010.\n0, 0, 0x06, // 10  011.\n18 * 3, 16 * 3, 0, // 11  0001\n15 * 3, 17 * 3, 0, // 12  0000\n0, 0, 0x08, // 13  0010.\n0, 0, 0x0a, // 14  0011.\n-1, 19 * 3, 0, // 15  00000\n0, 0, 0x01, // 16  00011.\n20 * 3, 21 * 3, 0, // 17  00001\n0, 0, 0x1e, // 18  00010.\n0, 0, 0x11, // 19  000001.\n0, 0, 0x16, // 20  000010.\n0, 0, 0x1a // 21  000011.\n]);\n\nMPEG1.MACROBLOCK_TYPE = [null, MPEG1.MACROBLOCK_TYPE_INTRA, MPEG1.MACROBLOCK_TYPE_PREDICTIVE, MPEG1.MACROBLOCK_TYPE_B];\n\nMPEG1.CODE_BLOCK_PATTERN = new Int16Array([2 * 3, 1 * 3, 0, //   0\n3 * 3, 6 * 3, 0, //   1  1\n4 * 3, 5 * 3, 0, //   2  0\n8 * 3, 11 * 3, 0, //   3  10\n12 * 3, 13 * 3, 0, //   4  00\n9 * 3, 7 * 3, 0, //   5  01\n10 * 3, 14 * 3, 0, //   6  11\n20 * 3, 19 * 3, 0, //   7  011\n18 * 3, 16 * 3, 0, //   8  100\n23 * 3, 17 * 3, 0, //   9  010\n27 * 3, 25 * 3, 0, //  10  110\n21 * 3, 28 * 3, 0, //  11  101\n15 * 3, 22 * 3, 0, //  12  000\n24 * 3, 26 * 3, 0, //  13  001\n0, 0, 60, //  14  111.\n35 * 3, 40 * 3, 0, //  15  0000\n44 * 3, 48 * 3, 0, //  16  1001\n38 * 3, 36 * 3, 0, //  17  0101\n42 * 3, 47 * 3, 0, //  18  1000\n29 * 3, 31 * 3, 0, //  19  0111\n39 * 3, 32 * 3, 0, //  20  0110\n0, 0, 32, //  21  1010.\n45 * 3, 46 * 3, 0, //  22  0001\n33 * 3, 41 * 3, 0, //  23  0100\n43 * 3, 34 * 3, 0, //  24  0010\n0, 0, 4, //  25  1101.\n30 * 3, 37 * 3, 0, //  26  0011\n0, 0, 8, //  27  1100.\n0, 0, 16, //  28  1011.\n0, 0, 44, //  29  0111 0.\n50 * 3, 56 * 3, 0, //  30  0011 0\n0, 0, 28, //  31  0111 1.\n0, 0, 52, //  32  0110 1.\n0, 0, 62, //  33  0100 0.\n61 * 3, 59 * 3, 0, //  34  0010 1\n52 * 3, 60 * 3, 0, //  35  0000 0\n0, 0, 1, //  36  0101 1.\n55 * 3, 54 * 3, 0, //  37  0011 1\n0, 0, 61, //  38  0101 0.\n0, 0, 56, //  39  0110 0.\n57 * 3, 58 * 3, 0, //  40  0000 1\n0, 0, 2, //  41  0100 1.\n0, 0, 40, //  42  1000 0.\n51 * 3, 62 * 3, 0, //  43  0010 0\n0, 0, 48, //  44  1001 0.\n64 * 3, 63 * 3, 0, //  45  0001 0\n49 * 3, 53 * 3, 0, //  46  0001 1\n0, 0, 20, //  47  1000 1.\n0, 0, 12, //  48  1001 1.\n80 * 3, 83 * 3, 0, //  49  0001 10\n0, 0, 63, //  50  0011 00.\n77 * 3, 75 * 3, 0, //  51  0010 00\n65 * 3, 73 * 3, 0, //  52  0000 00\n84 * 3, 66 * 3, 0, //  53  0001 11\n0, 0, 24, //  54  0011 11.\n0, 0, 36, //  55  0011 10.\n0, 0, 3, //  56  0011 01.\n69 * 3, 87 * 3, 0, //  57  0000 10\n81 * 3, 79 * 3, 0, //  58  0000 11\n68 * 3, 71 * 3, 0, //  59  0010 11\n70 * 3, 78 * 3, 0, //  60  0000 01\n67 * 3, 76 * 3, 0, //  61  0010 10\n72 * 3, 74 * 3, 0, //  62  0010 01\n86 * 3, 85 * 3, 0, //  63  0001 01\n88 * 3, 82 * 3, 0, //  64  0001 00\n-1, 94 * 3, 0, //  65  0000 000\n95 * 3, 97 * 3, 0, //  66  0001 111\n0, 0, 33, //  67  0010 100.\n0, 0, 9, //  68  0010 110.\n106 * 3, 110 * 3, 0, //  69  0000 100\n102 * 3, 116 * 3, 0, //  70  0000 010\n0, 0, 5, //  71  0010 111.\n0, 0, 10, //  72  0010 010.\n93 * 3, 89 * 3, 0, //  73  0000 001\n0, 0, 6, //  74  0010 011.\n0, 0, 18, //  75  0010 001.\n0, 0, 17, //  76  0010 101.\n0, 0, 34, //  77  0010 000.\n113 * 3, 119 * 3, 0, //  78  0000 011\n103 * 3, 104 * 3, 0, //  79  0000 111\n90 * 3, 92 * 3, 0, //  80  0001 100\n109 * 3, 107 * 3, 0, //  81  0000 110\n117 * 3, 118 * 3, 0, //  82  0001 001\n101 * 3, 99 * 3, 0, //  83  0001 101\n98 * 3, 96 * 3, 0, //  84  0001 110\n100 * 3, 91 * 3, 0, //  85  0001 011\n114 * 3, 115 * 3, 0, //  86  0001 010\n105 * 3, 108 * 3, 0, //  87  0000 101\n112 * 3, 111 * 3, 0, //  88  0001 000\n121 * 3, 125 * 3, 0, //  89  0000 0011\n0, 0, 41, //  90  0001 1000.\n0, 0, 14, //  91  0001 0111.\n0, 0, 21, //  92  0001 1001.\n124 * 3, 122 * 3, 0, //  93  0000 0010\n120 * 3, 123 * 3, 0, //  94  0000 0001\n0, 0, 11, //  95  0001 1110.\n0, 0, 19, //  96  0001 1101.\n0, 0, 7, //  97  0001 1111.\n0, 0, 35, //  98  0001 1100.\n0, 0, 13, //  99  0001 1011.\n0, 0, 50, // 100  0001 0110.\n0, 0, 49, // 101  0001 1010.\n0, 0, 58, // 102  0000 0100.\n0, 0, 37, // 103  0000 1110.\n0, 0, 25, // 104  0000 1111.\n0, 0, 45, // 105  0000 1010.\n0, 0, 57, // 106  0000 1000.\n0, 0, 26, // 107  0000 1101.\n0, 0, 29, // 108  0000 1011.\n0, 0, 38, // 109  0000 1100.\n0, 0, 53, // 110  0000 1001.\n0, 0, 23, // 111  0001 0001.\n0, 0, 43, // 112  0001 0000.\n0, 0, 46, // 113  0000 0110.\n0, 0, 42, // 114  0001 0100.\n0, 0, 22, // 115  0001 0101.\n0, 0, 54, // 116  0000 0101.\n0, 0, 51, // 117  0001 0010.\n0, 0, 15, // 118  0001 0011.\n0, 0, 30, // 119  0000 0111.\n0, 0, 39, // 120  0000 0001 0.\n0, 0, 47, // 121  0000 0011 0.\n0, 0, 55, // 122  0000 0010 1.\n0, 0, 27, // 123  0000 0001 1.\n0, 0, 59, // 124  0000 0010 0.\n0, 0, 31 // 125  0000 0011 1.\n]);\n\nMPEG1.MOTION = new Int16Array([1 * 3, 2 * 3, 0, //   0\n4 * 3, 3 * 3, 0, //   1  0\n0, 0, 0, //   2  1.\n6 * 3, 5 * 3, 0, //   3  01\n8 * 3, 7 * 3, 0, //   4  00\n0, 0, -1, //   5  011.\n0, 0, 1, //   6  010.\n9 * 3, 10 * 3, 0, //   7  001\n12 * 3, 11 * 3, 0, //   8  000\n0, 0, 2, //   9  0010.\n0, 0, -2, //  10  0011.\n14 * 3, 15 * 3, 0, //  11  0001\n16 * 3, 13 * 3, 0, //  12  0000\n20 * 3, 18 * 3, 0, //  13  0000 1\n0, 0, 3, //  14  0001 0.\n0, 0, -3, //  15  0001 1.\n17 * 3, 19 * 3, 0, //  16  0000 0\n-1, 23 * 3, 0, //  17  0000 00\n27 * 3, 25 * 3, 0, //  18  0000 11\n26 * 3, 21 * 3, 0, //  19  0000 01\n24 * 3, 22 * 3, 0, //  20  0000 10\n32 * 3, 28 * 3, 0, //  21  0000 011\n29 * 3, 31 * 3, 0, //  22  0000 101\n-1, 33 * 3, 0, //  23  0000 001\n36 * 3, 35 * 3, 0, //  24  0000 100\n0, 0, -4, //  25  0000 111.\n30 * 3, 34 * 3, 0, //  26  0000 010\n0, 0, 4, //  27  0000 110.\n0, 0, -7, //  28  0000 0111.\n0, 0, 5, //  29  0000 1010.\n37 * 3, 41 * 3, 0, //  30  0000 0100\n0, 0, -5, //  31  0000 1011.\n0, 0, 7, //  32  0000 0110.\n38 * 3, 40 * 3, 0, //  33  0000 0011\n42 * 3, 39 * 3, 0, //  34  0000 0101\n0, 0, -6, //  35  0000 1001.\n0, 0, 6, //  36  0000 1000.\n51 * 3, 54 * 3, 0, //  37  0000 0100 0\n50 * 3, 49 * 3, 0, //  38  0000 0011 0\n45 * 3, 46 * 3, 0, //  39  0000 0101 1\n52 * 3, 47 * 3, 0, //  40  0000 0011 1\n43 * 3, 53 * 3, 0, //  41  0000 0100 1\n44 * 3, 48 * 3, 0, //  42  0000 0101 0\n0, 0, 10, //  43  0000 0100 10.\n0, 0, 9, //  44  0000 0101 00.\n0, 0, 8, //  45  0000 0101 10.\n0, 0, -8, //  46  0000 0101 11.\n57 * 3, 66 * 3, 0, //  47  0000 0011 11\n0, 0, -9, //  48  0000 0101 01.\n60 * 3, 64 * 3, 0, //  49  0000 0011 01\n56 * 3, 61 * 3, 0, //  50  0000 0011 00\n55 * 3, 62 * 3, 0, //  51  0000 0100 00\n58 * 3, 63 * 3, 0, //  52  0000 0011 10\n0, 0, -10, //  53  0000 0100 11.\n59 * 3, 65 * 3, 0, //  54  0000 0100 01\n0, 0, 12, //  55  0000 0100 000.\n0, 0, 16, //  56  0000 0011 000.\n0, 0, 13, //  57  0000 0011 110.\n0, 0, 14, //  58  0000 0011 100.\n0, 0, 11, //  59  0000 0100 010.\n0, 0, 15, //  60  0000 0011 010.\n0, 0, -16, //  61  0000 0011 001.\n0, 0, -12, //  62  0000 0100 001.\n0, 0, -14, //  63  0000 0011 101.\n0, 0, -15, //  64  0000 0011 011.\n0, 0, -11, //  65  0000 0100 011.\n0, 0, -13 //  66  0000 0011 111.\n]);\n\nMPEG1.DCT_DC_SIZE_LUMINANCE = new Int8Array([2 * 3, 1 * 3, 0, //   0\n6 * 3, 5 * 3, 0, //   1  1\n3 * 3, 4 * 3, 0, //   2  0\n0, 0, 1, //   3  00.\n0, 0, 2, //   4  01.\n9 * 3, 8 * 3, 0, //   5  11\n7 * 3, 10 * 3, 0, //   6  10\n0, 0, 0, //   7  100.\n12 * 3, 11 * 3, 0, //   8  111\n0, 0, 4, //   9  110.\n0, 0, 3, //  10  101.\n13 * 3, 14 * 3, 0, //  11  1111\n0, 0, 5, //  12  1110.\n0, 0, 6, //  13  1111 0.\n16 * 3, 15 * 3, 0, //  14  1111 1\n17 * 3, -1, 0, //  15  1111 11\n0, 0, 7, //  16  1111 10.\n0, 0, 8 //  17  1111 110.\n]);\n\nMPEG1.DCT_DC_SIZE_CHROMINANCE = new Int8Array([2 * 3, 1 * 3, 0, //   0\n4 * 3, 3 * 3, 0, //   1  1\n6 * 3, 5 * 3, 0, //   2  0\n8 * 3, 7 * 3, 0, //   3  11\n0, 0, 2, //   4  10.\n0, 0, 1, //   5  01.\n0, 0, 0, //   6  00.\n10 * 3, 9 * 3, 0, //   7  111\n0, 0, 3, //   8  110.\n12 * 3, 11 * 3, 0, //   9  1111\n0, 0, 4, //  10  1110.\n14 * 3, 13 * 3, 0, //  11  1111 1\n0, 0, 5, //  12  1111 0.\n16 * 3, 15 * 3, 0, //  13  1111 11\n0, 0, 6, //  14  1111 10.\n17 * 3, -1, 0, //  15  1111 111\n0, 0, 7, //  16  1111 110.\n0, 0, 8 //  17  1111 1110.\n]);\n\n//  dct_coeff bitmap:\n//    0xff00  run\n//    0x00ff  level\n\n//  Decoded values are unsigned. Sign bit follows in the stream.\n\n//  Interpretation of the value 0x0001\n//    for dc_coeff_first:  run=0, level=1\n//    for dc_coeff_next:   If the next bit is 1: run=0, level=1\n//                         If the next bit is 0: end_of_block\n\n//  escape decodes as 0xffff.\n\nMPEG1.DCT_COEFF = new Int32Array([1 * 3, 2 * 3, 0, //   0\n4 * 3, 3 * 3, 0, //   1  0\n0, 0, 0x0001, //   2  1.\n7 * 3, 8 * 3, 0, //   3  01\n6 * 3, 5 * 3, 0, //   4  00\n13 * 3, 9 * 3, 0, //   5  001\n11 * 3, 10 * 3, 0, //   6  000\n14 * 3, 12 * 3, 0, //   7  010\n0, 0, 0x0101, //   8  011.\n20 * 3, 22 * 3, 0, //   9  0011\n18 * 3, 21 * 3, 0, //  10  0001\n16 * 3, 19 * 3, 0, //  11  0000\n0, 0, 0x0201, //  12  0101.\n17 * 3, 15 * 3, 0, //  13  0010\n0, 0, 0x0002, //  14  0100.\n0, 0, 0x0003, //  15  0010 1.\n27 * 3, 25 * 3, 0, //  16  0000 0\n29 * 3, 31 * 3, 0, //  17  0010 0\n24 * 3, 26 * 3, 0, //  18  0001 0\n32 * 3, 30 * 3, 0, //  19  0000 1\n0, 0, 0x0401, //  20  0011 0.\n23 * 3, 28 * 3, 0, //  21  0001 1\n0, 0, 0x0301, //  22  0011 1.\n0, 0, 0x0102, //  23  0001 10.\n0, 0, 0x0701, //  24  0001 00.\n0, 0, 0xffff, //  25  0000 01. -- escape\n0, 0, 0x0601, //  26  0001 01.\n37 * 3, 36 * 3, 0, //  27  0000 00\n0, 0, 0x0501, //  28  0001 11.\n35 * 3, 34 * 3, 0, //  29  0010 00\n39 * 3, 38 * 3, 0, //  30  0000 11\n33 * 3, 42 * 3, 0, //  31  0010 01\n40 * 3, 41 * 3, 0, //  32  0000 10\n52 * 3, 50 * 3, 0, //  33  0010 010\n54 * 3, 53 * 3, 0, //  34  0010 001\n48 * 3, 49 * 3, 0, //  35  0010 000\n43 * 3, 45 * 3, 0, //  36  0000 001\n46 * 3, 44 * 3, 0, //  37  0000 000\n0, 0, 0x0801, //  38  0000 111.\n0, 0, 0x0004, //  39  0000 110.\n0, 0, 0x0202, //  40  0000 100.\n0, 0, 0x0901, //  41  0000 101.\n51 * 3, 47 * 3, 0, //  42  0010 011\n55 * 3, 57 * 3, 0, //  43  0000 0010\n60 * 3, 56 * 3, 0, //  44  0000 0001\n59 * 3, 58 * 3, 0, //  45  0000 0011\n61 * 3, 62 * 3, 0, //  46  0000 0000\n0, 0, 0x0a01, //  47  0010 0111.\n0, 0, 0x0d01, //  48  0010 0000.\n0, 0, 0x0006, //  49  0010 0001.\n0, 0, 0x0103, //  50  0010 0101.\n0, 0, 0x0005, //  51  0010 0110.\n0, 0, 0x0302, //  52  0010 0100.\n0, 0, 0x0b01, //  53  0010 0011.\n0, 0, 0x0c01, //  54  0010 0010.\n76 * 3, 75 * 3, 0, //  55  0000 0010 0\n67 * 3, 70 * 3, 0, //  56  0000 0001 1\n73 * 3, 71 * 3, 0, //  57  0000 0010 1\n78 * 3, 74 * 3, 0, //  58  0000 0011 1\n72 * 3, 77 * 3, 0, //  59  0000 0011 0\n69 * 3, 64 * 3, 0, //  60  0000 0001 0\n68 * 3, 63 * 3, 0, //  61  0000 0000 0\n66 * 3, 65 * 3, 0, //  62  0000 0000 1\n81 * 3, 87 * 3, 0, //  63  0000 0000 01\n91 * 3, 80 * 3, 0, //  64  0000 0001 01\n82 * 3, 79 * 3, 0, //  65  0000 0000 11\n83 * 3, 86 * 3, 0, //  66  0000 0000 10\n93 * 3, 92 * 3, 0, //  67  0000 0001 10\n84 * 3, 85 * 3, 0, //  68  0000 0000 00\n90 * 3, 94 * 3, 0, //  69  0000 0001 00\n88 * 3, 89 * 3, 0, //  70  0000 0001 11\n0, 0, 0x0203, //  71  0000 0010 11.\n0, 0, 0x0104, //  72  0000 0011 00.\n0, 0, 0x0007, //  73  0000 0010 10.\n0, 0, 0x0402, //  74  0000 0011 11.\n0, 0, 0x0502, //  75  0000 0010 01.\n0, 0, 0x1001, //  76  0000 0010 00.\n0, 0, 0x0f01, //  77  0000 0011 01.\n0, 0, 0x0e01, //  78  0000 0011 10.\n105 * 3, 107 * 3, 0, //  79  0000 0000 111\n111 * 3, 114 * 3, 0, //  80  0000 0001 011\n104 * 3, 97 * 3, 0, //  81  0000 0000 010\n125 * 3, 119 * 3, 0, //  82  0000 0000 110\n96 * 3, 98 * 3, 0, //  83  0000 0000 100\n-1, 123 * 3, 0, //  84  0000 0000 000\n95 * 3, 101 * 3, 0, //  85  0000 0000 001\n106 * 3, 121 * 3, 0, //  86  0000 0000 101\n99 * 3, 102 * 3, 0, //  87  0000 0000 011\n113 * 3, 103 * 3, 0, //  88  0000 0001 110\n112 * 3, 116 * 3, 0, //  89  0000 0001 111\n110 * 3, 100 * 3, 0, //  90  0000 0001 000\n124 * 3, 115 * 3, 0, //  91  0000 0001 010\n117 * 3, 122 * 3, 0, //  92  0000 0001 101\n109 * 3, 118 * 3, 0, //  93  0000 0001 100\n120 * 3, 108 * 3, 0, //  94  0000 0001 001\n127 * 3, 136 * 3, 0, //  95  0000 0000 0010\n139 * 3, 140 * 3, 0, //  96  0000 0000 1000\n130 * 3, 126 * 3, 0, //  97  0000 0000 0101\n145 * 3, 146 * 3, 0, //  98  0000 0000 1001\n128 * 3, 129 * 3, 0, //  99  0000 0000 0110\n0, 0, 0x0802, // 100  0000 0001 0001.\n132 * 3, 134 * 3, 0, // 101  0000 0000 0011\n155 * 3, 154 * 3, 0, // 102  0000 0000 0111\n0, 0, 0x0008, // 103  0000 0001 1101.\n137 * 3, 133 * 3, 0, // 104  0000 0000 0100\n143 * 3, 144 * 3, 0, // 105  0000 0000 1110\n151 * 3, 138 * 3, 0, // 106  0000 0000 1010\n142 * 3, 141 * 3, 0, // 107  0000 0000 1111\n0, 0, 0x000a, // 108  0000 0001 0011.\n0, 0, 0x0009, // 109  0000 0001 1000.\n0, 0, 0x000b, // 110  0000 0001 0000.\n0, 0, 0x1501, // 111  0000 0001 0110.\n0, 0, 0x0602, // 112  0000 0001 1110.\n0, 0, 0x0303, // 113  0000 0001 1100.\n0, 0, 0x1401, // 114  0000 0001 0111.\n0, 0, 0x0702, // 115  0000 0001 0101.\n0, 0, 0x1101, // 116  0000 0001 1111.\n0, 0, 0x1201, // 117  0000 0001 1010.\n0, 0, 0x1301, // 118  0000 0001 1001.\n148 * 3, 152 * 3, 0, // 119  0000 0000 1101\n0, 0, 0x0403, // 120  0000 0001 0010.\n153 * 3, 150 * 3, 0, // 121  0000 0000 1011\n0, 0, 0x0105, // 122  0000 0001 1011.\n131 * 3, 135 * 3, 0, // 123  0000 0000 0001\n0, 0, 0x0204, // 124  0000 0001 0100.\n149 * 3, 147 * 3, 0, // 125  0000 0000 1100\n172 * 3, 173 * 3, 0, // 126  0000 0000 0101 1\n162 * 3, 158 * 3, 0, // 127  0000 0000 0010 0\n170 * 3, 161 * 3, 0, // 128  0000 0000 0110 0\n168 * 3, 166 * 3, 0, // 129  0000 0000 0110 1\n157 * 3, 179 * 3, 0, // 130  0000 0000 0101 0\n169 * 3, 167 * 3, 0, // 131  0000 0000 0001 0\n174 * 3, 171 * 3, 0, // 132  0000 0000 0011 0\n178 * 3, 177 * 3, 0, // 133  0000 0000 0100 1\n156 * 3, 159 * 3, 0, // 134  0000 0000 0011 1\n164 * 3, 165 * 3, 0, // 135  0000 0000 0001 1\n183 * 3, 182 * 3, 0, // 136  0000 0000 0010 1\n175 * 3, 176 * 3, 0, // 137  0000 0000 0100 0\n0, 0, 0x0107, // 138  0000 0000 1010 1.\n0, 0, 0x0a02, // 139  0000 0000 1000 0.\n0, 0, 0x0902, // 140  0000 0000 1000 1.\n0, 0, 0x1601, // 141  0000 0000 1111 1.\n0, 0, 0x1701, // 142  0000 0000 1111 0.\n0, 0, 0x1901, // 143  0000 0000 1110 0.\n0, 0, 0x1801, // 144  0000 0000 1110 1.\n0, 0, 0x0503, // 145  0000 0000 1001 0.\n0, 0, 0x0304, // 146  0000 0000 1001 1.\n0, 0, 0x000d, // 147  0000 0000 1100 1.\n0, 0, 0x000c, // 148  0000 0000 1101 0.\n0, 0, 0x000e, // 149  0000 0000 1100 0.\n0, 0, 0x000f, // 150  0000 0000 1011 1.\n0, 0, 0x0205, // 151  0000 0000 1010 0.\n0, 0, 0x1a01, // 152  0000 0000 1101 1.\n0, 0, 0x0106, // 153  0000 0000 1011 0.\n180 * 3, 181 * 3, 0, // 154  0000 0000 0111 1\n160 * 3, 163 * 3, 0, // 155  0000 0000 0111 0\n196 * 3, 199 * 3, 0, // 156  0000 0000 0011 10\n0, 0, 0x001b, // 157  0000 0000 0101 00.\n203 * 3, 185 * 3, 0, // 158  0000 0000 0010 01\n202 * 3, 201 * 3, 0, // 159  0000 0000 0011 11\n0, 0, 0x0013, // 160  0000 0000 0111 00.\n0, 0, 0x0016, // 161  0000 0000 0110 01.\n197 * 3, 207 * 3, 0, // 162  0000 0000 0010 00\n0, 0, 0x0012, // 163  0000 0000 0111 01.\n191 * 3, 192 * 3, 0, // 164  0000 0000 0001 10\n188 * 3, 190 * 3, 0, // 165  0000 0000 0001 11\n0, 0, 0x0014, // 166  0000 0000 0110 11.\n184 * 3, 194 * 3, 0, // 167  0000 0000 0001 01\n0, 0, 0x0015, // 168  0000 0000 0110 10.\n186 * 3, 193 * 3, 0, // 169  0000 0000 0001 00\n0, 0, 0x0017, // 170  0000 0000 0110 00.\n204 * 3, 198 * 3, 0, // 171  0000 0000 0011 01\n0, 0, 0x0019, // 172  0000 0000 0101 10.\n0, 0, 0x0018, // 173  0000 0000 0101 11.\n200 * 3, 205 * 3, 0, // 174  0000 0000 0011 00\n0, 0, 0x001f, // 175  0000 0000 0100 00.\n0, 0, 0x001e, // 176  0000 0000 0100 01.\n0, 0, 0x001c, // 177  0000 0000 0100 11.\n0, 0, 0x001d, // 178  0000 0000 0100 10.\n0, 0, 0x001a, // 179  0000 0000 0101 01.\n0, 0, 0x0011, // 180  0000 0000 0111 10.\n0, 0, 0x0010, // 181  0000 0000 0111 11.\n189 * 3, 206 * 3, 0, // 182  0000 0000 0010 11\n187 * 3, 195 * 3, 0, // 183  0000 0000 0010 10\n218 * 3, 211 * 3, 0, // 184  0000 0000 0001 010\n0, 0, 0x0025, // 185  0000 0000 0010 011.\n215 * 3, 216 * 3, 0, // 186  0000 0000 0001 000\n0, 0, 0x0024, // 187  0000 0000 0010 100.\n210 * 3, 212 * 3, 0, // 188  0000 0000 0001 110\n0, 0, 0x0022, // 189  0000 0000 0010 110.\n213 * 3, 209 * 3, 0, // 190  0000 0000 0001 111\n221 * 3, 222 * 3, 0, // 191  0000 0000 0001 100\n219 * 3, 208 * 3, 0, // 192  0000 0000 0001 101\n217 * 3, 214 * 3, 0, // 193  0000 0000 0001 001\n223 * 3, 220 * 3, 0, // 194  0000 0000 0001 011\n0, 0, 0x0023, // 195  0000 0000 0010 101.\n0, 0, 0x010b, // 196  0000 0000 0011 100.\n0, 0, 0x0028, // 197  0000 0000 0010 000.\n0, 0, 0x010c, // 198  0000 0000 0011 011.\n0, 0, 0x010a, // 199  0000 0000 0011 101.\n0, 0, 0x0020, // 200  0000 0000 0011 000.\n0, 0, 0x0108, // 201  0000 0000 0011 111.\n0, 0, 0x0109, // 202  0000 0000 0011 110.\n0, 0, 0x0026, // 203  0000 0000 0010 010.\n0, 0, 0x010d, // 204  0000 0000 0011 010.\n0, 0, 0x010e, // 205  0000 0000 0011 001.\n0, 0, 0x0021, // 206  0000 0000 0010 111.\n0, 0, 0x0027, // 207  0000 0000 0010 001.\n0, 0, 0x1f01, // 208  0000 0000 0001 1011.\n0, 0, 0x1b01, // 209  0000 0000 0001 1111.\n0, 0, 0x1e01, // 210  0000 0000 0001 1100.\n0, 0, 0x1002, // 211  0000 0000 0001 0101.\n0, 0, 0x1d01, // 212  0000 0000 0001 1101.\n0, 0, 0x1c01, // 213  0000 0000 0001 1110.\n0, 0, 0x010f, // 214  0000 0000 0001 0011.\n0, 0, 0x0112, // 215  0000 0000 0001 0000.\n0, 0, 0x0111, // 216  0000 0000 0001 0001.\n0, 0, 0x0110, // 217  0000 0000 0001 0010.\n0, 0, 0x0603, // 218  0000 0000 0001 0100.\n0, 0, 0x0b02, // 219  0000 0000 0001 1010.\n0, 0, 0x0e02, // 220  0000 0000 0001 0111.\n0, 0, 0x0d02, // 221  0000 0000 0001 1000.\n0, 0, 0x0c02, // 222  0000 0000 0001 1001.\n0, 0, 0x0f02 // 223  0000 0000 0001 0110.\n]);\n\nMPEG1.PICTURE_TYPE = {\n\tINTRA: 1,\n\tPREDICTIVE: 2,\n\tB: 3\n};\n\nMPEG1.START = {\n\tSEQUENCE: 0xB3,\n\tSLICE_FIRST: 0x01,\n\tSLICE_LAST: 0xAF,\n\tPICTURE: 0x00,\n\tEXTENSION: 0xB5,\n\tUSER_DATA: 0xB2\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (MPEG1);\n\n/***/ }),\n/* 10 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__index__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__decoder__ = __webpack_require__(1);\n// Based on kjmp2 by Martin J. Fiedler\n// http://keyj.emphy.de/kjmp2/\n\n\n\n\n\nvar MP2 = function MP2(options) {\n\t__WEBPACK_IMPORTED_MODULE_0__index__[\"Decoder\"].Base.call(this, options);\n\n\tvar bufferSize = options.audioBufferSize || 128 * 1024;\n\tvar bufferMode = options.streaming ? __WEBPACK_IMPORTED_MODULE_0__index__[\"BitBuffer\"].MODE.EVICT : __WEBPACK_IMPORTED_MODULE_0__index__[\"BitBuffer\"].MODE.EXPAND;\n\n\tthis.bits = new __WEBPACK_IMPORTED_MODULE_0__index__[\"BitBuffer\"](bufferSize, bufferMode);\n\n\tthis.left = new Float32Array(1152);\n\tthis.right = new Float32Array(1152);\n\tthis.sampleRate = 44100;\n\n\tthis.D = new Float32Array(1024);\n\tthis.D.set(MP2.SYNTHESIS_WINDOW, 0);\n\tthis.D.set(MP2.SYNTHESIS_WINDOW, 512);\n\tthis.V = new Float32Array(1024);\n\tthis.U = new Int32Array(32);\n\tthis.VPos = 0;\n\n\tthis.allocation = [new Array(32), new Array(32)];\n\tthis.scaleFactorInfo = [new Uint8Array(32), new Uint8Array(32)];\n\tthis.scaleFactor = [new Array(32), new Array(32)];\n\tthis.sample = [new Array(32), new Array(32)];\n\n\tfor (var j = 0; j < 2; j++) {\n\t\tfor (var i = 0; i < 32; i++) {\n\t\t\tthis.scaleFactor[j][i] = [0, 0, 0];\n\t\t\tthis.sample[j][i] = [0, 0, 0];\n\t\t}\n\t}\n};\n\nMP2.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__decoder__[\"a\" /* default */].prototype);\nMP2.prototype.constructor = MP2;\n\nMP2.prototype.decode = function () {\n\tvar pos = this.bits.index >> 3;\n\tif (pos >= this.bits.byteLength) {\n\t\treturn false;\n\t}\n\n\tvar decoded = this.decodeFrame(this.left, this.right);\n\tthis.bits.index = pos + decoded << 3;\n\n\tif (!decoded) {\n\t\treturn false;\n\t}\n\n\tif (this.destination) {\n\t\tthis.destination.play(this.sampleRate, this.left, this.right);\n\t}\n\n\tthis.advanceDecodedTime(this.left.length / this.sampleRate);\n\treturn true;\n};\n\nMP2.prototype.getCurrentTime = function () {\n\tvar enqueuedTime = this.destination ? this.destination.enqueuedTime : 0;\n\treturn this.decodedTime - enqueuedTime;\n};\n\nMP2.prototype.decodeFrame = function (left, right) {\n\t// Check for valid header: syncword OK, MPEG-Audio Layer 2\n\tvar sync = this.bits.read(11),\n\t    version = this.bits.read(2),\n\t    layer = this.bits.read(2),\n\t    hasCRC = !this.bits.read(1);\n\n\tif (sync !== MP2.FRAME_SYNC || version !== MP2.VERSION.MPEG_1 || layer !== MP2.LAYER.II) {\n\t\treturn 0; // Invalid header or unsupported version\n\t}\n\n\tvar bitrateIndex = this.bits.read(4) - 1;\n\tif (bitrateIndex > 13) {\n\t\treturn 0; // Invalid bit rate or 'free format'\n\t}\n\n\tvar sampleRateIndex = this.bits.read(2);\n\tvar sampleRate = MP2.SAMPLE_RATE[sampleRateIndex];\n\tif (sampleRateIndex === 3) {\n\t\treturn 0; // Invalid sample rate\n\t}\n\tif (version === MP2.VERSION.MPEG_2) {\n\t\tsampleRateIndex += 4;\n\t\tbitrateIndex += 14;\n\t}\n\tvar padding = this.bits.read(1),\n\t    privat = this.bits.read(1),\n\t    mode = this.bits.read(2);\n\n\t// Parse the mode_extension, set up the stereo bound\n\tvar bound = 0;\n\tif (mode === MP2.MODE.JOINT_STEREO) {\n\t\tbound = this.bits.read(2) + 1 << 2;\n\t} else {\n\t\tthis.bits.skip(2);\n\t\tbound = mode === MP2.MODE.MONO ? 0 : 32;\n\t}\n\n\t// Discard the last 4 bits of the header and the CRC value, if present\n\tthis.bits.skip(4);\n\tif (hasCRC) {\n\t\tthis.bits.skip(16);\n\t}\n\n\t// Compute the frame size\n\tvar bitrate = MP2.BIT_RATE[bitrateIndex],\n\t    sampleRate = MP2.SAMPLE_RATE[sampleRateIndex],\n\t    frameSize = 144000 * bitrate / sampleRate + padding | 0;\n\n\t// Prepare the quantizer table lookups\n\tvar tab3 = 0;\n\tvar sblimit = 0;\n\tif (version === MP2.VERSION.MPEG_2) {\n\t\t// MPEG-2 (LSR)\n\t\ttab3 = 2;\n\t\tsblimit = 30;\n\t} else {\n\t\t// MPEG-1\n\t\tvar tab1 = mode === MP2.MODE.MONO ? 0 : 1;\n\t\tvar tab2 = MP2.QUANT_LUT_STEP_1[tab1][bitrateIndex];\n\t\ttab3 = MP2.QUANT_LUT_STEP_2[tab2][sampleRateIndex];\n\t\tsblimit = tab3 & 63;\n\t\ttab3 >>= 6;\n\t}\n\n\tif (bound > sblimit) {\n\t\tbound = sblimit;\n\t}\n\n\t// Read the allocation information\n\tfor (var sb = 0; sb < bound; sb++) {\n\t\tthis.allocation[0][sb] = this.readAllocation(sb, tab3);\n\t\tthis.allocation[1][sb] = this.readAllocation(sb, tab3);\n\t}\n\n\tfor (var sb = bound; sb < sblimit; sb++) {\n\t\tthis.allocation[0][sb] = this.allocation[1][sb] = this.readAllocation(sb, tab3);\n\t}\n\n\t// Read scale factor selector information\n\tvar channels = mode === MP2.MODE.MONO ? 1 : 2;\n\tfor (var sb = 0; sb < sblimit; sb++) {\n\t\tfor (ch = 0; ch < channels; ch++) {\n\t\t\tif (this.allocation[ch][sb]) {\n\t\t\t\tthis.scaleFactorInfo[ch][sb] = this.bits.read(2);\n\t\t\t}\n\t\t}\n\t\tif (mode === MP2.MODE.MONO) {\n\t\t\tthis.scaleFactorInfo[1][sb] = this.scaleFactorInfo[0][sb];\n\t\t}\n\t}\n\n\t// Read scale factors\n\tfor (var sb = 0; sb < sblimit; sb++) {\n\t\tfor (var ch = 0; ch < channels; ch++) {\n\t\t\tif (this.allocation[ch][sb]) {\n\t\t\t\tvar sf = this.scaleFactor[ch][sb];\n\t\t\t\tswitch (this.scaleFactorInfo[ch][sb]) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tsf[0] = this.bits.read(6);\n\t\t\t\t\t\tsf[1] = this.bits.read(6);\n\t\t\t\t\t\tsf[2] = this.bits.read(6);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tsf[0] = sf[1] = this.bits.read(6);\n\t\t\t\t\t\tsf[2] = this.bits.read(6);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tsf[0] = sf[1] = sf[2] = this.bits.read(6);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tsf[0] = this.bits.read(6);\n\t\t\t\t\t\tsf[1] = sf[2] = this.bits.read(6);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (mode === MP2.MODE.MONO) {\n\t\t\tthis.scaleFactor[1][sb][0] = this.scaleFactor[0][sb][0];\n\t\t\tthis.scaleFactor[1][sb][1] = this.scaleFactor[0][sb][1];\n\t\t\tthis.scaleFactor[1][sb][2] = this.scaleFactor[0][sb][2];\n\t\t}\n\t}\n\n\t// Coefficient input and reconstruction\n\tvar outPos = 0;\n\tfor (var part = 0; part < 3; part++) {\n\t\tfor (var granule = 0; granule < 4; granule++) {\n\n\t\t\t// Read the samples\n\t\t\tfor (var sb = 0; sb < bound; sb++) {\n\t\t\t\tthis.readSamples(0, sb, part);\n\t\t\t\tthis.readSamples(1, sb, part);\n\t\t\t}\n\t\t\tfor (var sb = bound; sb < sblimit; sb++) {\n\t\t\t\tthis.readSamples(0, sb, part);\n\t\t\t\tthis.sample[1][sb][0] = this.sample[0][sb][0];\n\t\t\t\tthis.sample[1][sb][1] = this.sample[0][sb][1];\n\t\t\t\tthis.sample[1][sb][2] = this.sample[0][sb][2];\n\t\t\t}\n\t\t\tfor (var sb = sblimit; sb < 32; sb++) {\n\t\t\t\tthis.sample[0][sb][0] = 0;\n\t\t\t\tthis.sample[0][sb][1] = 0;\n\t\t\t\tthis.sample[0][sb][2] = 0;\n\t\t\t\tthis.sample[1][sb][0] = 0;\n\t\t\t\tthis.sample[1][sb][1] = 0;\n\t\t\t\tthis.sample[1][sb][2] = 0;\n\t\t\t}\n\n\t\t\t// Synthesis loop\n\t\t\tfor (var p = 0; p < 3; p++) {\n\t\t\t\t// Shifting step\n\t\t\t\tthis.VPos = this.VPos - 64 & 1023;\n\n\t\t\t\tfor (var ch = 0; ch < 2; ch++) {\n\t\t\t\t\tMP2.MatrixTransform(this.sample[ch], p, this.V, this.VPos);\n\n\t\t\t\t\t// Build U, windowing, calculate output\n\t\t\t\t\tObject(__WEBPACK_IMPORTED_MODULE_0__index__[\"Fill\"])(this.U, 0);\n\n\t\t\t\t\tvar dIndex = 512 - (this.VPos >> 1);\n\t\t\t\t\tvar vIndex = this.VPos % 128 >> 1;\n\t\t\t\t\twhile (vIndex < 1024) {\n\t\t\t\t\t\tfor (var i = 0; i < 32; ++i) {\n\t\t\t\t\t\t\tthis.U[i] += this.D[dIndex++] * this.V[vIndex++];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvIndex += 128 - 32;\n\t\t\t\t\t\tdIndex += 64 - 32;\n\t\t\t\t\t}\n\n\t\t\t\t\tvIndex = 128 - 32 + 1024 - vIndex;\n\t\t\t\t\tdIndex -= 512 - 32;\n\t\t\t\t\twhile (vIndex < 1024) {\n\t\t\t\t\t\tfor (var i = 0; i < 32; ++i) {\n\t\t\t\t\t\t\tthis.U[i] += this.D[dIndex++] * this.V[vIndex++];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvIndex += 128 - 32;\n\t\t\t\t\t\tdIndex += 64 - 32;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Output samples\n\t\t\t\t\tvar outChannel = ch === 0 ? left : right;\n\t\t\t\t\tfor (var j = 0; j < 32; j++) {\n\t\t\t\t\t\toutChannel[outPos + j] = this.U[j] / 2147418112;\n\t\t\t\t\t}\n\t\t\t\t} // End of synthesis channel loop\n\t\t\t\toutPos += 32;\n\t\t\t} // End of synthesis sub-block loop\n\t\t} // Decoding of the granule finished\n\t}\n\n\tthis.sampleRate = sampleRate;\n\treturn frameSize;\n};\n\nMP2.prototype.readAllocation = function (sb, tab3) {\n\tvar tab4 = MP2.QUANT_LUT_STEP_3[tab3][sb];\n\tvar qtab = MP2.QUANT_LUT_STEP4[tab4 & 15][this.bits.read(tab4 >> 4)];\n\treturn qtab ? MP2.QUANT_TAB[qtab - 1] : 0;\n};\n\nMP2.prototype.readSamples = function (ch, sb, part) {\n\tvar q = this.allocation[ch][sb],\n\t    sf = this.scaleFactor[ch][sb][part],\n\t    sample = this.sample[ch][sb],\n\t    val = 0;\n\n\tif (!q) {\n\t\t// No bits allocated for this subband\n\t\tsample[0] = sample[1] = sample[2] = 0;\n\t\treturn;\n\t}\n\n\t// Resolve scalefactor\n\tif (sf === 63) {\n\t\tsf = 0;\n\t} else {\n\t\tvar shift = sf / 3 | 0;\n\t\tsf = MP2.SCALEFACTOR_BASE[sf % 3] + (1 << shift >> 1) >> shift;\n\t}\n\n\t// Decode samples\n\tvar adj = q.levels;\n\tif (q.group) {\n\t\t// Decode grouped samples\n\t\tval = this.bits.read(q.bits);\n\t\tsample[0] = val % adj;\n\t\tval = val / adj | 0;\n\t\tsample[1] = val % adj;\n\t\tsample[2] = val / adj | 0;\n\t} else {\n\t\t// Decode direct samples\n\t\tsample[0] = this.bits.read(q.bits);\n\t\tsample[1] = this.bits.read(q.bits);\n\t\tsample[2] = this.bits.read(q.bits);\n\t}\n\n\t// Postmultiply samples\n\tvar scale = 65536 / (adj + 1) | 0;\n\tadj = (adj + 1 >> 1) - 1;\n\n\tval = (adj - sample[0]) * scale;\n\tsample[0] = val * (sf >> 12) + (val * (sf & 4095) + 2048 >> 12) >> 12;\n\n\tval = (adj - sample[1]) * scale;\n\tsample[1] = val * (sf >> 12) + (val * (sf & 4095) + 2048 >> 12) >> 12;\n\n\tval = (adj - sample[2]) * scale;\n\tsample[2] = val * (sf >> 12) + (val * (sf & 4095) + 2048 >> 12) >> 12;\n};\n\nMP2.MatrixTransform = function (s, ss, d, dp) {\n\tvar t01, t02, t03, t04, t05, t06, t07, t08, t09, t10, t11, t12, t13, t14, t15, t16, t17, t18, t19, t20, t21, t22, t23, t24, t25, t26, t27, t28, t29, t30, t31, t32, t33;\n\n\tt01 = s[0][ss] + s[31][ss];t02 = (s[0][ss] - s[31][ss]) * 0.500602998235;\n\tt03 = s[1][ss] + s[30][ss];t04 = (s[1][ss] - s[30][ss]) * 0.505470959898;\n\tt05 = s[2][ss] + s[29][ss];t06 = (s[2][ss] - s[29][ss]) * 0.515447309923;\n\tt07 = s[3][ss] + s[28][ss];t08 = (s[3][ss] - s[28][ss]) * 0.53104259109;\n\tt09 = s[4][ss] + s[27][ss];t10 = (s[4][ss] - s[27][ss]) * 0.553103896034;\n\tt11 = s[5][ss] + s[26][ss];t12 = (s[5][ss] - s[26][ss]) * 0.582934968206;\n\tt13 = s[6][ss] + s[25][ss];t14 = (s[6][ss] - s[25][ss]) * 0.622504123036;\n\tt15 = s[7][ss] + s[24][ss];t16 = (s[7][ss] - s[24][ss]) * 0.674808341455;\n\tt17 = s[8][ss] + s[23][ss];t18 = (s[8][ss] - s[23][ss]) * 0.744536271002;\n\tt19 = s[9][ss] + s[22][ss];t20 = (s[9][ss] - s[22][ss]) * 0.839349645416;\n\tt21 = s[10][ss] + s[21][ss];t22 = (s[10][ss] - s[21][ss]) * 0.972568237862;\n\tt23 = s[11][ss] + s[20][ss];t24 = (s[11][ss] - s[20][ss]) * 1.16943993343;\n\tt25 = s[12][ss] + s[19][ss];t26 = (s[12][ss] - s[19][ss]) * 1.48416461631;\n\tt27 = s[13][ss] + s[18][ss];t28 = (s[13][ss] - s[18][ss]) * 2.05778100995;\n\tt29 = s[14][ss] + s[17][ss];t30 = (s[14][ss] - s[17][ss]) * 3.40760841847;\n\tt31 = s[15][ss] + s[16][ss];t32 = (s[15][ss] - s[16][ss]) * 10.1900081235;\n\n\tt33 = t01 + t31;t31 = (t01 - t31) * 0.502419286188;\n\tt01 = t03 + t29;t29 = (t03 - t29) * 0.52249861494;\n\tt03 = t05 + t27;t27 = (t05 - t27) * 0.566944034816;\n\tt05 = t07 + t25;t25 = (t07 - t25) * 0.64682178336;\n\tt07 = t09 + t23;t23 = (t09 - t23) * 0.788154623451;\n\tt09 = t11 + t21;t21 = (t11 - t21) * 1.06067768599;\n\tt11 = t13 + t19;t19 = (t13 - t19) * 1.72244709824;\n\tt13 = t15 + t17;t17 = (t15 - t17) * 5.10114861869;\n\tt15 = t33 + t13;t13 = (t33 - t13) * 0.509795579104;\n\tt33 = t01 + t11;t01 = (t01 - t11) * 0.601344886935;\n\tt11 = t03 + t09;t09 = (t03 - t09) * 0.899976223136;\n\tt03 = t05 + t07;t07 = (t05 - t07) * 2.56291544774;\n\tt05 = t15 + t03;t15 = (t15 - t03) * 0.541196100146;\n\tt03 = t33 + t11;t11 = (t33 - t11) * 1.30656296488;\n\tt33 = t05 + t03;t05 = (t05 - t03) * 0.707106781187;\n\tt03 = t15 + t11;t15 = (t15 - t11) * 0.707106781187;\n\tt03 += t15;\n\tt11 = t13 + t07;t13 = (t13 - t07) * 0.541196100146;\n\tt07 = t01 + t09;t09 = (t01 - t09) * 1.30656296488;\n\tt01 = t11 + t07;t07 = (t11 - t07) * 0.707106781187;\n\tt11 = t13 + t09;t13 = (t13 - t09) * 0.707106781187;\n\tt11 += t13;t01 += t11;\n\tt11 += t07;t07 += t13;\n\tt09 = t31 + t17;t31 = (t31 - t17) * 0.509795579104;\n\tt17 = t29 + t19;t29 = (t29 - t19) * 0.601344886935;\n\tt19 = t27 + t21;t21 = (t27 - t21) * 0.899976223136;\n\tt27 = t25 + t23;t23 = (t25 - t23) * 2.56291544774;\n\tt25 = t09 + t27;t09 = (t09 - t27) * 0.541196100146;\n\tt27 = t17 + t19;t19 = (t17 - t19) * 1.30656296488;\n\tt17 = t25 + t27;t27 = (t25 - t27) * 0.707106781187;\n\tt25 = t09 + t19;t19 = (t09 - t19) * 0.707106781187;\n\tt25 += t19;\n\tt09 = t31 + t23;t31 = (t31 - t23) * 0.541196100146;\n\tt23 = t29 + t21;t21 = (t29 - t21) * 1.30656296488;\n\tt29 = t09 + t23;t23 = (t09 - t23) * 0.707106781187;\n\tt09 = t31 + t21;t31 = (t31 - t21) * 0.707106781187;\n\tt09 += t31;t29 += t09;t09 += t23;t23 += t31;\n\tt17 += t29;t29 += t25;t25 += t09;t09 += t27;\n\tt27 += t23;t23 += t19;t19 += t31;\n\tt21 = t02 + t32;t02 = (t02 - t32) * 0.502419286188;\n\tt32 = t04 + t30;t04 = (t04 - t30) * 0.52249861494;\n\tt30 = t06 + t28;t28 = (t06 - t28) * 0.566944034816;\n\tt06 = t08 + t26;t08 = (t08 - t26) * 0.64682178336;\n\tt26 = t10 + t24;t10 = (t10 - t24) * 0.788154623451;\n\tt24 = t12 + t22;t22 = (t12 - t22) * 1.06067768599;\n\tt12 = t14 + t20;t20 = (t14 - t20) * 1.72244709824;\n\tt14 = t16 + t18;t16 = (t16 - t18) * 5.10114861869;\n\tt18 = t21 + t14;t14 = (t21 - t14) * 0.509795579104;\n\tt21 = t32 + t12;t32 = (t32 - t12) * 0.601344886935;\n\tt12 = t30 + t24;t24 = (t30 - t24) * 0.899976223136;\n\tt30 = t06 + t26;t26 = (t06 - t26) * 2.56291544774;\n\tt06 = t18 + t30;t18 = (t18 - t30) * 0.541196100146;\n\tt30 = t21 + t12;t12 = (t21 - t12) * 1.30656296488;\n\tt21 = t06 + t30;t30 = (t06 - t30) * 0.707106781187;\n\tt06 = t18 + t12;t12 = (t18 - t12) * 0.707106781187;\n\tt06 += t12;\n\tt18 = t14 + t26;t26 = (t14 - t26) * 0.541196100146;\n\tt14 = t32 + t24;t24 = (t32 - t24) * 1.30656296488;\n\tt32 = t18 + t14;t14 = (t18 - t14) * 0.707106781187;\n\tt18 = t26 + t24;t24 = (t26 - t24) * 0.707106781187;\n\tt18 += t24;t32 += t18;\n\tt18 += t14;t26 = t14 + t24;\n\tt14 = t02 + t16;t02 = (t02 - t16) * 0.509795579104;\n\tt16 = t04 + t20;t04 = (t04 - t20) * 0.601344886935;\n\tt20 = t28 + t22;t22 = (t28 - t22) * 0.899976223136;\n\tt28 = t08 + t10;t10 = (t08 - t10) * 2.56291544774;\n\tt08 = t14 + t28;t14 = (t14 - t28) * 0.541196100146;\n\tt28 = t16 + t20;t20 = (t16 - t20) * 1.30656296488;\n\tt16 = t08 + t28;t28 = (t08 - t28) * 0.707106781187;\n\tt08 = t14 + t20;t20 = (t14 - t20) * 0.707106781187;\n\tt08 += t20;\n\tt14 = t02 + t10;t02 = (t02 - t10) * 0.541196100146;\n\tt10 = t04 + t22;t22 = (t04 - t22) * 1.30656296488;\n\tt04 = t14 + t10;t10 = (t14 - t10) * 0.707106781187;\n\tt14 = t02 + t22;t02 = (t02 - t22) * 0.707106781187;\n\tt14 += t02;t04 += t14;t14 += t10;t10 += t02;\n\tt16 += t04;t04 += t08;t08 += t14;t14 += t28;\n\tt28 += t10;t10 += t20;t20 += t02;t21 += t16;\n\tt16 += t32;t32 += t04;t04 += t06;t06 += t08;\n\tt08 += t18;t18 += t14;t14 += t30;t30 += t28;\n\tt28 += t26;t26 += t10;t10 += t12;t12 += t20;\n\tt20 += t24;t24 += t02;\n\n\td[dp + 48] = -t33;\n\td[dp + 49] = d[dp + 47] = -t21;\n\td[dp + 50] = d[dp + 46] = -t17;\n\td[dp + 51] = d[dp + 45] = -t16;\n\td[dp + 52] = d[dp + 44] = -t01;\n\td[dp + 53] = d[dp + 43] = -t32;\n\td[dp + 54] = d[dp + 42] = -t29;\n\td[dp + 55] = d[dp + 41] = -t04;\n\td[dp + 56] = d[dp + 40] = -t03;\n\td[dp + 57] = d[dp + 39] = -t06;\n\td[dp + 58] = d[dp + 38] = -t25;\n\td[dp + 59] = d[dp + 37] = -t08;\n\td[dp + 60] = d[dp + 36] = -t11;\n\td[dp + 61] = d[dp + 35] = -t18;\n\td[dp + 62] = d[dp + 34] = -t09;\n\td[dp + 63] = d[dp + 33] = -t14;\n\td[dp + 32] = -t05;\n\td[dp + 0] = t05;d[dp + 31] = -t30;\n\td[dp + 1] = t30;d[dp + 30] = -t27;\n\td[dp + 2] = t27;d[dp + 29] = -t28;\n\td[dp + 3] = t28;d[dp + 28] = -t07;\n\td[dp + 4] = t07;d[dp + 27] = -t26;\n\td[dp + 5] = t26;d[dp + 26] = -t23;\n\td[dp + 6] = t23;d[dp + 25] = -t10;\n\td[dp + 7] = t10;d[dp + 24] = -t15;\n\td[dp + 8] = t15;d[dp + 23] = -t12;\n\td[dp + 9] = t12;d[dp + 22] = -t19;\n\td[dp + 10] = t19;d[dp + 21] = -t20;\n\td[dp + 11] = t20;d[dp + 20] = -t13;\n\td[dp + 12] = t13;d[dp + 19] = -t24;\n\td[dp + 13] = t24;d[dp + 18] = -t31;\n\td[dp + 14] = t31;d[dp + 17] = -t02;\n\td[dp + 15] = t02;d[dp + 16] = 0.0;\n};\n\nMP2.FRAME_SYNC = 0x7ff;\n\nMP2.VERSION = {\n\tMPEG_2_5: 0x0,\n\tMPEG_2: 0x2,\n\tMPEG_1: 0x3\n};\n\nMP2.LAYER = {\n\tIII: 0x1,\n\tII: 0x2,\n\tI: 0x3\n};\n\nMP2.MODE = {\n\tSTEREO: 0x0,\n\tJOINT_STEREO: 0x1,\n\tDUAL_CHANNEL: 0x2,\n\tMONO: 0x3\n};\n\nMP2.SAMPLE_RATE = new Uint16Array([44100, 48000, 32000, 0, // MPEG-1\n22050, 24000, 16000, 0 // MPEG-2\n]);\n\nMP2.BIT_RATE = new Uint16Array([32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, // MPEG-1\n8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160 // MPEG-2\n]);\n\nMP2.SCALEFACTOR_BASE = new Uint32Array([0x02000000, 0x01965FEA, 0x01428A30]);\n\nMP2.SYNTHESIS_WINDOW = new Float32Array([0.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.5, -1.5, -2.0, -2.0, -2.5, -2.5, -3.0, -3.5, -3.5, -4.0, -4.5, -5.0, -5.5, -6.5, -7.0, -8.0, -8.5, -9.5, -10.5, -12.0, -13.0, -14.5, -15.5, -17.5, -19.0, -20.5, -22.5, -24.5, -26.5, -29.0, -31.5, -34.0, -36.5, -39.5, -42.5, -45.5, -48.5, -52.0, -55.5, -58.5, -62.5, -66.0, -69.5, -73.5, -77.0, -80.5, -84.5, -88.0, -91.5, -95.0, -98.0, -101.0, -104.0, 106.5, 109.0, 111.0, 112.5, 113.5, 114.0, 114.0, 113.5, 112.0, 110.5, 107.5, 104.0, 100.0, 94.5, 88.5, 81.5, 73.0, 63.5, 53.0, 41.5, 28.5, 14.5, -1.0, -18.0, -36.0, -55.5, -76.5, -98.5, -122.0, -147.0, -173.5, -200.5, -229.5, -259.5, -290.5, -322.5, -355.5, -389.5, -424.0, -459.5, -495.5, -532.0, -568.5, -605.0, -641.5, -678.0, -714.0, -749.0, -783.5, -817.0, -849.0, -879.5, -908.5, -935.0, -959.5, -981.0, -1000.5, -1016.0, -1028.5, -1037.5, -1042.5, -1043.5, -1040.0, -1031.5, 1018.5, 1000.0, 976.0, 946.5, 911.0, 869.5, 822.0, 767.5, 707.0, 640.0, 565.5, 485.0, 397.0, 302.5, 201.0, 92.5, -22.5, -144.0, -272.5, -407.0, -547.5, -694.0, -846.0, -1003.0, -1165.0, -1331.5, -1502.0, -1675.5, -1852.5, -2031.5, -2212.5, -2394.0, -2576.5, -2758.5, -2939.5, -3118.5, -3294.5, -3467.5, -3635.5, -3798.5, -3955.0, -4104.5, -4245.5, -4377.5, -4499.0, -4609.5, -4708.0, -4792.5, -4863.5, -4919.0, -4958.0, -4979.5, -4983.0, -4967.5, -4931.5, -4875.0, -4796.0, -4694.5, -4569.5, -4420.0, -4246.0, -4046.0, -3820.0, -3567.0, 3287.0, 2979.5, 2644.0, 2280.5, 1888.0, 1467.5, 1018.5, 541.0, 35.0, -499.0, -1061.0, -1650.0, -2266.5, -2909.0, -3577.0, -4270.0, -4987.5, -5727.5, -6490.0, -7274.0, -8077.5, -8899.5, -9739.0, -10594.5, -11464.5, -12347.0, -13241.0, -14144.5, -15056.0, -15973.5, -16895.5, -17820.0, -18744.5, -19668.0, -20588.0, -21503.0, -22410.5, -23308.5, -24195.0, -25068.5, -25926.5, -26767.0, -27589.0, -28389.0, -29166.5, -29919.0, -30644.5, -31342.0, -32009.5, -32645.0, -33247.0, -33814.5, -34346.0, -34839.5, -35295.0, -35710.0, -36084.5, -36417.5, -36707.5, -36954.0, -37156.5, -37315.0, -37428.0, -37496.0, 37519.0, 37496.0, 37428.0, 37315.0, 37156.5, 36954.0, 36707.5, 36417.5, 36084.5, 35710.0, 35295.0, 34839.5, 34346.0, 33814.5, 33247.0, 32645.0, 32009.5, 31342.0, 30644.5, 29919.0, 29166.5, 28389.0, 27589.0, 26767.0, 25926.5, 25068.5, 24195.0, 23308.5, 22410.5, 21503.0, 20588.0, 19668.0, 18744.5, 17820.0, 16895.5, 15973.5, 15056.0, 14144.5, 13241.0, 12347.0, 11464.5, 10594.5, 9739.0, 8899.5, 8077.5, 7274.0, 6490.0, 5727.5, 4987.5, 4270.0, 3577.0, 2909.0, 2266.5, 1650.0, 1061.0, 499.0, -35.0, -541.0, -1018.5, -1467.5, -1888.0, -2280.5, -2644.0, -2979.5, 3287.0, 3567.0, 3820.0, 4046.0, 4246.0, 4420.0, 4569.5, 4694.5, 4796.0, 4875.0, 4931.5, 4967.5, 4983.0, 4979.5, 4958.0, 4919.0, 4863.5, 4792.5, 4708.0, 4609.5, 4499.0, 4377.5, 4245.5, 4104.5, 3955.0, 3798.5, 3635.5, 3467.5, 3294.5, 3118.5, 2939.5, 2758.5, 2576.5, 2394.0, 2212.5, 2031.5, 1852.5, 1675.5, 1502.0, 1331.5, 1165.0, 1003.0, 846.0, 694.0, 547.5, 407.0, 272.5, 144.0, 22.5, -92.5, -201.0, -302.5, -397.0, -485.0, -565.5, -640.0, -707.0, -767.5, -822.0, -869.5, -911.0, -946.5, -976.0, -1000.0, 1018.5, 1031.5, 1040.0, 1043.5, 1042.5, 1037.5, 1028.5, 1016.0, 1000.5, 981.0, 959.5, 935.0, 908.5, 879.5, 849.0, 817.0, 783.5, 749.0, 714.0, 678.0, 641.5, 605.0, 568.5, 532.0, 495.5, 459.5, 424.0, 389.5, 355.5, 322.5, 290.5, 259.5, 229.5, 200.5, 173.5, 147.0, 122.0, 98.5, 76.5, 55.5, 36.0, 18.0, 1.0, -14.5, -28.5, -41.5, -53.0, -63.5, -73.0, -81.5, -88.5, -94.5, -100.0, -104.0, -107.5, -110.5, -112.0, -113.5, -114.0, -114.0, -113.5, -112.5, -111.0, -109.0, 106.5, 104.0, 101.0, 98.0, 95.0, 91.5, 88.0, 84.5, 80.5, 77.0, 73.5, 69.5, 66.0, 62.5, 58.5, 55.5, 52.0, 48.5, 45.5, 42.5, 39.5, 36.5, 34.0, 31.5, 29.0, 26.5, 24.5, 22.5, 20.5, 19.0, 17.5, 15.5, 14.5, 13.0, 12.0, 10.5, 9.5, 8.5, 8.0, 7.0, 6.5, 5.5, 5.0, 4.5, 4.0, 3.5, 3.5, 3.0, 2.5, 2.5, 2.0, 2.0, 1.5, 1.5, 1.0, 1.0, 1.0, 1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]);\n\n// Quantizer lookup, step 1: bitrate classes\nMP2.QUANT_LUT_STEP_1 = [\n// 32, 48, 56, 64, 80, 96,112,128,160,192,224,256,320,384 <- bitrate\n[0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2], // mono\n// 16, 24, 28, 32, 40, 48, 56, 64, 80, 96,112,128,160,192 <- bitrate / chan\n[0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 2, 2] // stereo\n];\n\n// Quantizer lookup, step 2: bitrate class, sample rate -> B2 table idx, sblimit\nMP2.QUANT_TAB = {\n\tA: 27 | 64, // Table 3-B.2a: high-rate, sblimit = 27\n\tB: 30 | 64, // Table 3-B.2b: high-rate, sblimit = 30\n\tC: 8, // Table 3-B.2c:  low-rate, sblimit =  8\n\tD: 12 // Table 3-B.2d:  low-rate, sblimit = 12\n};\n\nMP2.QUANT_LUT_STEP_2 = [\n//   44.1 kHz,        48 kHz,          32 kHz\n[MP2.QUANT_TAB.C, MP2.QUANT_TAB.C, MP2.QUANT_TAB.D], // 32 - 48 kbit/sec/ch\n[MP2.QUANT_TAB.A, MP2.QUANT_TAB.A, MP2.QUANT_TAB.A], // 56 - 80 kbit/sec/ch\n[MP2.QUANT_TAB.B, MP2.QUANT_TAB.A, MP2.QUANT_TAB.B] // 96+\t kbit/sec/ch\n];\n\n// Quantizer lookup, step 3: B2 table, subband -> nbal, row index\n// (upper 4 bits: nbal, lower 4 bits: row index)\nMP2.QUANT_LUT_STEP_3 = [\n// Low-rate table (3-B.2c and 3-B.2d)\n[0x44, 0x44, 0x34, 0x34, 0x34, 0x34, 0x34, 0x34, 0x34, 0x34, 0x34, 0x34],\n// High-rate table (3-B.2a and 3-B.2b)\n[0x43, 0x43, 0x43, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20],\n// MPEG-2 LSR table (B.2 in ISO 13818-3)\n[0x45, 0x45, 0x45, 0x45, 0x34, 0x34, 0x34, 0x34, 0x34, 0x34, 0x34, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24]];\n\n// Quantizer lookup, step 4: table row, allocation[] value -> quant table index\nMP2.QUANT_LUT_STEP4 = [[0, 1, 2, 17], [0, 1, 2, 3, 4, 5, 6, 17], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 17], [0, 1, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]];\n\nMP2.QUANT_TAB = [{ levels: 3, group: 1, bits: 5 }, //  1\n{ levels: 5, group: 1, bits: 7 }, //  2\n{ levels: 7, group: 0, bits: 3 }, //  3\n{ levels: 9, group: 1, bits: 10 }, //  4\n{ levels: 15, group: 0, bits: 4 }, //  5\n{ levels: 31, group: 0, bits: 5 }, //  6\n{ levels: 63, group: 0, bits: 6 }, //  7\n{ levels: 127, group: 0, bits: 7 }, //  8\n{ levels: 255, group: 0, bits: 8 }, //  9\n{ levels: 511, group: 0, bits: 9 }, // 10\n{ levels: 1023, group: 0, bits: 10 }, // 11\n{ levels: 2047, group: 0, bits: 11 }, // 12\n{ levels: 4095, group: 0, bits: 12 }, // 13\n{ levels: 8191, group: 0, bits: 13 }, // 14\n{ levels: 16383, group: 0, bits: 14 }, // 15\n{ levels: 32767, group: 0, bits: 15 }, // 16\n{ levels: 65535, group: 0, bits: 16 // 17\n}];\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (MP2);\n\n/***/ }),\n/* 11 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar WebGLRenderer = function WebGLRenderer(options) {\n\tthis.canvas = options.canvas || document.createElement('canvas');\n\tthis.width = this.canvas.width;\n\tthis.height = this.canvas.height;\n\tthis.enabled = true;\n\n\tvar contextCreateOptions = {\n\t\tpreserveDrawingBuffer: !!options.preserveDrawingBuffer,\n\t\talpha: false,\n\t\tdepth: false,\n\t\tstencil: false,\n\t\tantialias: false\n\t};\n\n\tthis.gl = this.canvas.getContext('webgl', contextCreateOptions) || this.canvas.getContext('experimental-webgl', contextCreateOptions);\n\n\tif (!this.gl) {\n\t\tthrow new Error('Failed to get WebGL Context');\n\t}\n\n\tvar gl = this.gl;\n\tvar vertexAttr = null;\n\n\t// Init buffers\n\tthis.vertexBuffer = gl.createBuffer();\n\tvar vertexCoords = new Float32Array([0, 0, 0, 1, 1, 0, 1, 1]);\n\tgl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n\tgl.bufferData(gl.ARRAY_BUFFER, vertexCoords, gl.STATIC_DRAW);\n\n\t// Setup the main YCrCbToRGBA shader\n\tthis.program = this.createProgram(WebGLRenderer.SHADER.VERTEX_IDENTITY, WebGLRenderer.SHADER.FRAGMENT_YCRCB_TO_RGBA);\n\tvertexAttr = gl.getAttribLocation(this.program, 'vertex');\n\tgl.enableVertexAttribArray(vertexAttr);\n\tgl.vertexAttribPointer(vertexAttr, 2, gl.FLOAT, false, 0, 0);\n\n\tthis.textureY = this.createTexture(0, 'textureY');\n\tthis.textureCb = this.createTexture(1, 'textureCb');\n\tthis.textureCr = this.createTexture(2, 'textureCr');\n\n\t// Setup the loading animation shader\n\tthis.loadingProgram = this.createProgram(WebGLRenderer.SHADER.VERTEX_IDENTITY, WebGLRenderer.SHADER.FRAGMENT_LOADING);\n\tvertexAttr = gl.getAttribLocation(this.loadingProgram, 'vertex');\n\tgl.enableVertexAttribArray(vertexAttr);\n\tgl.vertexAttribPointer(vertexAttr, 2, gl.FLOAT, false, 0, 0);\n\n\tthis.shouldCreateUnclampedViews = !this.allowsClampedTextureData();\n};\n\nWebGLRenderer.prototype.destroy = function () {\n\tvar gl = this.gl;\n\n\tgl.deleteTexture(this.textureY);\n\tgl.deleteTexture(this.textureCb);\n\tgl.deleteTexture(this.textureCr);\n\n\tgl.deleteProgram(this.program);\n\tgl.deleteProgram(this.loadingProgram);\n\n\tgl.deleteBuffer(this.vertexBuffer);\n};\n\nWebGLRenderer.prototype.resize = function (width, height) {\n\tthis.width = width | 0;\n\tthis.height = height | 0;\n\n\tthis.canvas.width = this.width;\n\tthis.canvas.height = this.height;\n\n\tthis.gl.useProgram(this.program);\n\tthis.gl.viewport(0, 0, this.width, this.height);\n};\n\nWebGLRenderer.prototype.createTexture = function (index, name) {\n\tvar gl = this.gl;\n\tvar texture = gl.createTexture();\n\n\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\tgl.uniform1i(gl.getUniformLocation(this.program, name), index);\n\n\treturn texture;\n};\n\nWebGLRenderer.prototype.createProgram = function (vsh, fsh) {\n\tvar gl = this.gl;\n\tvar program = gl.createProgram();\n\n\tgl.attachShader(program, this.compileShader(gl.VERTEX_SHADER, vsh));\n\tgl.attachShader(program, this.compileShader(gl.FRAGMENT_SHADER, fsh));\n\tgl.linkProgram(program);\n\tgl.useProgram(program);\n\n\treturn program;\n};\n\nWebGLRenderer.prototype.compileShader = function (type, source) {\n\tvar gl = this.gl;\n\tvar shader = gl.createShader(type);\n\tgl.shaderSource(shader, source);\n\tgl.compileShader(shader);\n\n\tif (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n\t\tthrow new Error(gl.getShaderInfoLog(shader));\n\t}\n\n\treturn shader;\n};\n\nWebGLRenderer.prototype.allowsClampedTextureData = function () {\n\tvar gl = this.gl;\n\tvar texture = gl.createTexture();\n\n\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.LUMINANCE, 1, 1, 0, gl.LUMINANCE, gl.UNSIGNED_BYTE, new Uint8ClampedArray([0]));\n\treturn gl.getError() === 0;\n};\n\nWebGLRenderer.prototype.renderProgress = function (progress) {\n\tvar gl = this.gl;\n\n\tgl.useProgram(this.loadingProgram);\n\n\tvar loc = gl.getUniformLocation(this.loadingProgram, 'progress');\n\tgl.uniform1f(loc, progress);\n\n\tgl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n};\n\nWebGLRenderer.prototype.render = function (y, cb, cr) {\n\tif (!this.enabled) {\n\t\treturn;\n\t}\n\n\tvar gl = this.gl;\n\tvar w = this.width + 15 >> 4 << 4,\n\t    h = this.height,\n\t    w2 = w >> 1,\n\t    h2 = h >> 1;\n\n\t// In some browsers WebGL doesn't like Uint8ClampedArrays (this is a bug\n\t// and should be fixed soon-ish), so we have to create a Uint8Array view \n\t// for each plane.\n\tif (this.shouldCreateUnclampedViews) {\n\t\ty = new Uint8Array(y.buffer), cb = new Uint8Array(cb.buffer), cr = new Uint8Array(cr.buffer);\n\t}\n\n\tgl.useProgram(this.program);\n\n\tthis.updateTexture(gl.TEXTURE0, this.textureY, w, h, y);\n\tthis.updateTexture(gl.TEXTURE1, this.textureCb, w2, h2, cb);\n\tthis.updateTexture(gl.TEXTURE2, this.textureCr, w2, h2, cr);\n\n\tgl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n};\n\nWebGLRenderer.prototype.updateTexture = function (unit, texture, w, h, data) {\n\tvar gl = this.gl;\n\tgl.activeTexture(unit);\n\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.LUMINANCE, w, h, 0, gl.LUMINANCE, gl.UNSIGNED_BYTE, data);\n};\n\nWebGLRenderer.IsSupported = function () {\n\ttry {\n\t\tif (!window.WebGLRenderingContext) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar canvas = document.createElement('canvas');\n\t\treturn !!(canvas.getContext('webgl') || canvas.getContext('experimental-webgl'));\n\t} catch (err) {\n\t\treturn false;\n\t}\n};\n\nWebGLRenderer.SHADER = {\n\tFRAGMENT_YCRCB_TO_RGBA: ['precision mediump float;', 'uniform sampler2D textureY;', 'uniform sampler2D textureCb;', 'uniform sampler2D textureCr;', 'varying vec2 texCoord;', 'mat4 rec601 = mat4(', '1.16438,  0.00000,  1.59603, -0.87079,', '1.16438, -0.39176, -0.81297,  0.52959,', '1.16438,  2.01723,  0.00000, -1.08139,', '0, 0, 0, 1', ');', 'void main() {', 'float y = texture2D(textureY, texCoord).r;', 'float cb = texture2D(textureCb, texCoord).r;', 'float cr = texture2D(textureCr, texCoord).r;', 'gl_FragColor = vec4(y, cr, cb, 1.0) * rec601;', '}'].join('\\n'),\n\n\tFRAGMENT_LOADING: ['precision mediump float;', 'uniform float progress;', 'varying vec2 texCoord;', 'void main() {', 'float c = ceil(progress-(1.0-texCoord.y));', 'gl_FragColor = vec4(c,c,c,1);', '}'].join('\\n'),\n\n\tVERTEX_IDENTITY: ['attribute vec2 vertex;', 'varying vec2 texCoord;', 'void main() {', 'texCoord = vertex;', 'gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);', '}'].join('\\n')\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (WebGLRenderer);\n\n/***/ }),\n/* 12 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__index__ = __webpack_require__(0);\n\n\nvar CanvasRenderer = function CanvasRenderer(options) {\n  this.canvas = options.canvas || document.createElement('canvas');\n  this.width = this.canvas.width;\n  this.height = this.canvas.height;\n  this.enabled = true;\n\n  this.context = this.canvas.getContext('2d');\n};\n\nCanvasRenderer.prototype.destroy = function () {\n  // Nothing to do here\n};\n\nCanvasRenderer.prototype.resize = function (width, height) {\n  this.width = width | 0;\n  this.height = height | 0;\n\n  this.canvas.width = this.width;\n  this.canvas.height = this.height;\n\n  this.imageData = this.context.getImageData(0, 0, this.width, this.height);\n  Object(__WEBPACK_IMPORTED_MODULE_0__index__[\"Fill\"])(this.imageData.data, 255);\n};\n\nCanvasRenderer.prototype.renderProgress = function (progress) {\n  var w = this.canvas.width,\n      h = this.canvas.height,\n      ctx = this.context;\n\n  ctx.fillStyle = '#222';\n  ctx.fillRect(0, 0, w, h);\n  ctx.fillStyle = '#fff';\n  ctx.fillRect(0, h - h * progress, w, h * progress);\n};\n\nCanvasRenderer.prototype.render = function (y, cb, cr) {\n  this.YCbCrToRGBA(y, cb, cr, this.imageData.data);\n  this.context.putImageData(this.imageData, 0, 0);\n};\n\nCanvasRenderer.prototype.YCbCrToRGBA = function (y, cb, cr, rgba) {\n  if (!this.enabled) {\n    return;\n  }\n\n  // Chroma values are the same for each block of 4 pixels, so we proccess\n  // 2 lines at a time, 2 neighboring pixels each.\n  // I wish we could use 32bit writes to the RGBA buffer instead of writing\n  // each byte separately, but we need the automatic clamping of the RGBA\n  // buffer.\n\n  var w = this.width + 15 >> 4 << 4,\n      w2 = w >> 1;\n\n  var yIndex1 = 0,\n      yIndex2 = w,\n      yNext2Lines = w + (w - this.width);\n\n  var cIndex = 0,\n      cNextLine = w2 - (this.width >> 1);\n\n  var rgbaIndex1 = 0,\n      rgbaIndex2 = this.width * 4,\n      rgbaNext2Lines = this.width * 4;\n\n  var cols = this.width >> 1,\n      rows = this.height >> 1;\n\n  var ccb, ccr, r, g, b;\n\n  for (var row = 0; row < rows; row++) {\n    for (var col = 0; col < cols; col++) {\n      ccb = cb[cIndex];\n      ccr = cr[cIndex];\n      cIndex++;\n\n      r = ccb + (ccb * 103 >> 8) - 179;\n      g = (ccr * 88 >> 8) - 44 + (ccb * 183 >> 8) - 91;\n      b = ccr + (ccr * 198 >> 8) - 227;\n\n      // Line 1\n      var y1 = y[yIndex1++];\n      var y2 = y[yIndex1++];\n      rgba[rgbaIndex1] = y1 + r;\n      rgba[rgbaIndex1 + 1] = y1 - g;\n      rgba[rgbaIndex1 + 2] = y1 + b;\n      rgba[rgbaIndex1 + 4] = y2 + r;\n      rgba[rgbaIndex1 + 5] = y2 - g;\n      rgba[rgbaIndex1 + 6] = y2 + b;\n      rgbaIndex1 += 8;\n\n      // Line 2\n      var y3 = y[yIndex2++];\n      var y4 = y[yIndex2++];\n      rgba[rgbaIndex2] = y3 + r;\n      rgba[rgbaIndex2 + 1] = y3 - g;\n      rgba[rgbaIndex2 + 2] = y3 + b;\n      rgba[rgbaIndex2 + 4] = y4 + r;\n      rgba[rgbaIndex2 + 5] = y4 - g;\n      rgba[rgbaIndex2 + 6] = y4 + b;\n      rgbaIndex2 += 8;\n    }\n\n    yIndex1 += yNext2Lines;\n    yIndex2 += yNext2Lines;\n    rgbaIndex1 += rgbaNext2Lines;\n    rgbaIndex2 += rgbaNext2Lines;\n    cIndex += cNextLine;\n  }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (CanvasRenderer);\n\n/***/ }),\n/* 13 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__index__ = __webpack_require__(0);\n\n\nvar WebAudioOut = function WebAudioOut(options) {\n\tthis.context = WebAudioOut.CachedContext = WebAudioOut.CachedContext || new (window.AudioContext || window.webkitAudioContext)();\n\n\tthis.gain = this.context.createGain();\n\tthis.destination = this.gain;\n\n\t// Keep track of the number of connections to this AudioContext, so we\n\t// can safely close() it when we're the only one connected to it.\n\tthis.gain.connect(this.context.destination);\n\tthis.context._connections = (this.context._connections || 0) + 1;\n\n\tthis.startTime = 0;\n\tthis.buffer = null;\n\tthis.wallclockStartTime = 0;\n\tthis.volume = 1;\n\tthis.enabled = true;\n\n\tthis.unlocked = !WebAudioOut.NeedsUnlocking();\n\n\tObject.defineProperty(this, 'enqueuedTime', { get: this.getEnqueuedTime });\n};\n\nWebAudioOut.prototype.destroy = function () {\n\tthis.gain.disconnect();\n\tthis.context._connections--;\n\n\tif (this.context._connections === 0) {\n\t\tthis.context.close();\n\t\tWebAudioOut.CachedContext = null;\n\t}\n};\n\nWebAudioOut.prototype.play = function (sampleRate, left, right) {\n\tif (!this.enabled) {\n\t\treturn;\n\t}\n\n\t// If the context is not unlocked yet, we simply advance the start time\n\t// to \"fake\" actually playing audio. This will keep the video in sync.\n\tif (!this.unlocked) {\n\t\tvar ts = Object(__WEBPACK_IMPORTED_MODULE_0__index__[\"Now\"])();\n\t\tif (this.wallclockStartTime < ts) {\n\t\t\tthis.wallclockStartTime = ts;\n\t\t}\n\t\tthis.wallclockStartTime += left.length / sampleRate;\n\t\treturn;\n\t}\n\n\tthis.gain.gain.value = this.volume;\n\n\tvar buffer = this.context.createBuffer(2, left.length, sampleRate);\n\tbuffer.getChannelData(0).set(left);\n\tbuffer.getChannelData(1).set(right);\n\n\tvar source = this.context.createBufferSource();\n\tsource.buffer = buffer;\n\tsource.connect(this.destination);\n\n\tvar now = this.context.currentTime;\n\tvar duration = buffer.duration;\n\tif (this.startTime < now) {\n\t\tthis.startTime = now;\n\t\tthis.wallclockStartTime = Object(__WEBPACK_IMPORTED_MODULE_0__index__[\"Now\"])();\n\t}\n\n\tsource.start(this.startTime);\n\tthis.startTime += duration;\n\tthis.wallclockStartTime += duration;\n};\n\nWebAudioOut.prototype.stop = function () {\n\t// Meh; there seems to be no simple way to get a list of currently\n\t// active source nodes from the Audio Context, and maintaining this\n\t// list ourselfs would be a pain, so we just set the gain to 0\n\t// to cut off all enqueued audio instantly.\n\tthis.gain.gain.value = 0;\n};\n\nWebAudioOut.prototype.getEnqueuedTime = function () {\n\t// The AudioContext.currentTime is only updated every so often, so if we\n\t// want to get exact timing, we need to rely on the system time.\n\treturn Math.max(this.wallclockStartTime - Object(__WEBPACK_IMPORTED_MODULE_0__index__[\"Now\"])(), 0);\n};\n\nWebAudioOut.prototype.resetEnqueuedTime = function () {\n\tthis.startTime = this.context.currentTime;\n\tthis.wallclockStartTime = Object(__WEBPACK_IMPORTED_MODULE_0__index__[\"Now\"])();\n};\n\nWebAudioOut.prototype.unlock = function (callback) {\n\tif (this.unlocked) {\n\t\tif (callback) {\n\t\t\tcallback();\n\t\t}\n\t\treturn;\n\t}\n\n\tthis.unlockCallback = callback;\n\n\t// Create empty buffer and play it\n\tvar buffer = this.context.createBuffer(1, 1, 22050);\n\tvar source = this.context.createBufferSource();\n\tsource.buffer = buffer;\n\tsource.connect(this.destination);\n\n\t// polyfill source.start(0);\n\tif (source.start) {\n\t\tsource.start(0);\n\t} else {\n\t\tsource.noteOn(0);\n\t}\n\n\tsetTimeout(this.checkIfUnlocked.bind(this, source, 0), 0);\n};\n\nWebAudioOut.prototype.checkIfUnlocked = function (source, attempt) {\n\tif (source.playbackState === source.PLAYING_STATE || source.playbackState === source.FINISHED_STATE) {\n\t\tthis.unlocked = true;\n\t\tif (this.unlockCallback) {\n\t\t\tthis.unlockCallback();\n\t\t\tthis.unlockCallback = null;\n\t\t}\n\t} else if (attempt < 10) {\n\t\t// Jeez, what a shit show. Thanks iOS!\n\t\tsetTimeout(this.checkIfUnlocked.bind(this, source, attempt + 1), 100);\n\t}\n};\n\nWebAudioOut.NeedsUnlocking = function () {\n\treturn (/iPhone|iPad|iPod/i.test(navigator.userAgent)\n\t);\n};\n\nWebAudioOut.IsSupported = function () {\n\treturn window.AudioContext || window.webkitAudioContext;\n};\n\nWebAudioOut.CachedContext = null;\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (WebAudioOut);\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// JSMpeg.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 677a42214b58282a8513","/* According to jsmpeg project(https://github.com/phoboslab/jsmpeg) modified */\r\n\r\n// ES6 modular\r\nimport Player from './lib/player';\r\nimport VideoElement from './lib/video-element'\r\nimport BitBuffer from './lib/buffer';\r\nimport AjaxSource from './lib/ajax';\r\nimport AjaxProgressiveSource from './lib/ajax-progressive';\r\nimport WSSource from './lib/websocket';\r\nimport TS from './lib/ts';\r\nimport BaseDecoder from './lib/decoder';\r\nimport MPEG1 from './lib/mpeg1';\r\nimport MP2 from './lib/mp2';\r\nimport WebGLRenderer from './lib/webgl';\r\nimport CanvasRenderer from './lib/canvas2d';\r\nimport WebAudioOut from './lib/webaudio';\r\n\r\nlet\r\n  Source = {\r\n    Ajax: AjaxSource,\r\n    AjaxProgressive: AjaxProgressiveSource,\r\n    WebSocket: WSSource,\r\n  }\r\n\r\n  , Demuxer = {\r\n    TS: TS,\r\n  }\r\n\r\n  , Decoder = {\r\n    Base: BaseDecoder,\r\n    MPEG1Video: MPEG1,\r\n    MP2Audio: MP2,\r\n  }\r\n\r\n  , Renderer = {\r\n    WebGL: WebGLRenderer,\r\n    Canvas2D: CanvasRenderer,\r\n  }\r\n\r\n  , AudioOutput = {\r\n    WebAudio: WebAudioOut,\r\n  }\r\n\r\n  , Now = () => {\r\n    return window.performance\r\n      ? window.performance.now() / 1000\r\n      : Date.now() / 1000;\r\n  }\r\n  , CreateVideoElements = () => {\r\n    let elements = document.querySelectorAll('.jsmpeg');\r\n    for (let i = 0; i < elements.length; i++) {\r\n      new VideoElement(elements[i]);\r\n    }\r\n  }\r\n\r\n  , Fill = (array, value) => {\r\n    if (array.fill) {\r\n      array.fill(value);\r\n    }\r\n    else {\r\n      for (let i = 0; i < array.length; i++) {\r\n        array[i] = value;\r\n      }\r\n    }\r\n  }\r\n;\r\n\r\n\r\n// This sets up the JSMpeg \"Namespace\". The object is empty apart from the Now()\r\n// utility function and the automatic CreateVideoElements() after DOMReady.\r\nexport {\r\n  // The Player sets up the connections between source, demuxer, decoders,\r\n  // renderer and audio output. It ties everything together, is responsible\r\n  // of scheduling decoding and provides some convenience methods for\r\n  // external users.\r\n  Player,\r\n\r\n  // A Video Element wraps the Player, shows HTML controls to start/pause\r\n  // the video and handles Audio unlocking on iOS. VideoElements can be\r\n  // created directly in HTML using the <div class=\"jsmpeg\"/> tag.\r\n  VideoElement,\r\n\r\n  // The BitBuffer wraps a Uint8Array and allows reading an arbitrary number\r\n  // of bits at a time. On writing, the BitBuffer either expands its\r\n  // internal buffer (for static files) or deletes old data (for streaming).\r\n  BitBuffer,\r\n\r\n  // A Source provides raw data from HTTP, a WebSocket connection or any\r\n  // other mean. Sources must support the following API:\r\n  //   .connect(destinationNode)\r\n  //   .write(buffer)\r\n  //   .start() - start reading\r\n  //   .resume(headroom) - continue reading; headroom to play pos in seconds\r\n  //   .established - boolean, true after connection is established\r\n  //   .completed - boolean, true if the source is completely loaded\r\n  //   .progress - float 0-1\r\n  Source,\r\n\r\n  // A Demuxer may sit between a Source and a Decoder. It separates the\r\n  // incoming raw data into Video, Audio and other Streams. API:\r\n  //   .connect(streamId, destinationNode)\r\n  //   .write(buffer)\r\n  //   .currentTime  float, in seconds\r\n  //   .startTime - float, in seconds\r\n  Demuxer,\r\n\r\n  // A Decoder accepts an incoming Stream of raw Audio or Video data, buffers\r\n  // it and upon `.decode()` decodes a single frame of data. Video decoders\r\n  // call `destinationNode.render(Y, Cr, CB)` with the decoded pixel data;\r\n  // Audio decoders call `destinationNode.play(left, right)` with the decoded\r\n  // PCM data. API:\r\n  //   .connect(destinationNode)\r\n  //   .write(pts, buffer)\r\n  //   .decode()\r\n  //   .seek(time)\r\n  //   .currentTime - float, in seconds\r\n  //   .startTime - float, in seconds\r\n  Decoder,\r\n\r\n  // A Renderer accepts raw YCrCb data in 3 separate buffers via the render()\r\n  // method. Renderers typically convert the data into the RGBA color space\r\n  // and draw it on a Canvas, but other output - such as writing PNGs - would\r\n  // be conceivable. API:\r\n  //   .render(y, cr, cb) - pixel data as Uint8Arrays\r\n  //   .enabled - wether the renderer does anything upon receiving data\r\n  Renderer,\r\n\r\n  // Audio Outputs accept raw Stero PCM data in 2 separate buffers via the\r\n  // play() method. Outputs typically play the audio on the user's device.\r\n  // API:\r\n  //   .play(sampleRate, left, right) - rate in herz; PCM data as Uint8Arrays\r\n  //   .stop()\r\n  //   .enqueuedTime - float, in seconds\r\n  //   .enabled - wether the output does anything upon receiving data\r\n  AudioOutput,\r\n\r\n  // functions\r\n  Now,\r\n  CreateVideoElements,\r\n  Fill,\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","let BaseDecoder = function(options) {\r\n\tthis.destination = null;\r\n\tthis.canPlay = false;\r\n\r\n\tthis.collectTimestamps = !options.streaming;\r\n\tthis.timestamps = [];\r\n\tthis.timestampIndex = 0;\r\n\r\n\tthis.startTime = 0;\r\n\tthis.decodedTime = 0;\r\n\r\n\tObject.defineProperty(this, 'currentTime', {get: this.getCurrentTime});\r\n};\r\n\r\nBaseDecoder.prototype.connect = function(destination) {\r\n\tthis.destination = destination;\r\n};\r\n\r\nBaseDecoder.prototype.write = function(pts, buffers) {\r\n\tif (this.collectTimestamps) {\r\n\t\tif (this.timestamps.length === 0) {\r\n\t\t\tthis.startTime = pts;\r\n\t\t\tthis.decodedTime = pts;\r\n\t\t}\r\n\t\tthis.timestamps.push({index: this.bits.byteLength << 3, time: pts});\r\n\t}\r\n\r\n\tthis.bits.write(buffers);\r\n\tthis.canPlay = true;\r\n};\r\n\r\nBaseDecoder.prototype.seek = function(time) {\r\n\tif (!this.collectTimestamps) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tthis.timestampIndex = 0;\r\n\tfor (var i = 0; i < this.timestamps.length; i++) {\r\n\t\tif (this.timestamps[i].time > time) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tthis.timestampIndex = i;\r\n\t}\r\n\r\n\tvar ts = this.timestamps[this.timestampIndex];\r\n\tif (ts) {\r\n\t\tthis.bits.index = ts.index;\r\n\t\tthis.decodedTime = ts.time;\r\n\t}\r\n\telse {\r\n\t\tthis.bits.index = 0;\r\n\t\tthis.decodedTime = this.startTime;\r\n\t}\r\n};\r\n\r\nBaseDecoder.prototype.decode = function() {\r\n\tthis.advanceDecodedTime(0);\r\n};\r\n\r\nBaseDecoder.prototype.advanceDecodedTime = function(seconds) {\r\n\tif (this.collectTimestamps) {\r\n\t\tvar newTimestampIndex = -1;\r\n\t\tfor (var i = this.timestampIndex; i < this.timestamps.length; i++) {\r\n\t\t\tif (this.timestamps[i].index > this.bits.index) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tnewTimestampIndex = i;\r\n\t\t}\r\n\r\n\t\t// Did we find a new PTS, different from the last? If so, we don't have\r\n\t\t// to advance the decoded time manually and can instead sync it exactly\r\n\t\t// to the PTS.\r\n\t\tif (\r\n\t\t\tnewTimestampIndex !== -1 && \r\n\t\t\tnewTimestampIndex !== this.timestampIndex\r\n\t\t) {\r\n\t\t\tthis.timestampIndex = newTimestampIndex;\r\n\t\t\tthis.decodedTime = this.timestamps[this.timestampIndex].time;\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tthis.decodedTime += seconds;\r\n};\r\n\r\nBaseDecoder.prototype.getCurrentTime = function() {\r\n\treturn this.decodedTime;\r\n};\r\n\r\nexport default BaseDecoder;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/decoder.js","import {\r\n  Demuxer,\r\n  Source,\r\n  Decoder,\r\n  Renderer,\r\n  AudioOutput,\r\n  Now,\r\n} from '../index';\r\n\r\n/**\r\n * @param url\r\n * @param options\r\n * @param cbUI {play: function, pause: function, stop: function} UI\r\n * @constructor\r\n */\r\nlet Player = function (url, options, cbUI) {\r\n  this.options = options || {};\r\n  this.cbUI = cbUI || {};\r\n\r\n  if (options.source) {\r\n    this.source = new options.source(url, options);\r\n    options.streaming = !!this.source.streaming;\r\n  }\r\n  else if (url.match(/^wss?:\\/\\//)) {\r\n    this.source = new Source.WebSocket(url, options);\r\n    options.streaming = true;\r\n  }\r\n  else if (options.progressive) {\r\n    this.source = new Source.AjaxProgressive(url, options);\r\n    options.streaming = false;\r\n  }\r\n  else {\r\n    this.source = new Source.Ajax(url, options);\r\n    options.streaming = false;\r\n  }\r\n\r\n  this.maxAudioLag = options.maxAudioLag || 0.25;\r\n  this.loop = options.loop !== false;\r\n  this.autoplay = !!options.autoplay || options.streaming;\r\n\r\n  this.demuxer = new Demuxer.TS(options);\r\n  this.source.connect(this.demuxer);\r\n\r\n  if (options.video !== false) {\r\n    this.video = new Decoder.MPEG1Video(options);\r\n    this.renderer = !options.disableGl && Renderer.WebGL.IsSupported()\r\n      ? new Renderer.WebGL(options)\r\n      : new Renderer.Canvas2D(options);\r\n    this.demuxer.connect(Demuxer.TS.STREAM.VIDEO_1, this.video);\r\n    this.video.connect(this.renderer);\r\n  }\r\n\r\n  if (options.audio !== false && AudioOutput.WebAudio.IsSupported()) {\r\n    this.audio = new Decoder.MP2Audio(options);\r\n    this.audioOut = new AudioOutput.WebAudio(options);\r\n    this.demuxer.connect(Demuxer.TS.STREAM.AUDIO_1, this.audio);\r\n    this.audio.connect(this.audioOut);\r\n  }\r\n\r\n  Object.defineProperty(this, 'currentTime', {\r\n    get: this.getCurrentTime,\r\n    set: this.setCurrentTime\r\n  });\r\n  Object.defineProperty(this, 'volume', {\r\n    get: this.getVolume,\r\n    set: this.setVolume\r\n  });\r\n\r\n  this.unpauseOnShow = false;\r\n  if (options.pauseWhenHidden !== false) {\r\n    document.addEventListener('visibilitychange', this.showHide.bind(this));\r\n  }\r\n\r\n  this.source.start();\r\n\r\n  if (this.autoplay) {\r\n    this.play();\r\n  }\r\n};\r\n\r\nPlayer.prototype.showHide = function (ev) {\r\n  if (document.visibilityState === 'hidden') {\r\n    this.unpauseOnShow = this.wantsToPlay;\r\n    this.pause();\r\n  }\r\n  else if (this.unpauseOnShow) {\r\n    this.play();\r\n  }\r\n};\r\n\r\nPlayer.prototype.play = function (ev) {\r\n  this.animationId = requestAnimationFrame(this.update.bind(this));\r\n  this.wantsToPlay = true;\r\n\r\n  if (this.cbUI.play) {\r\n    this.cbUI.play();\r\n  }\r\n};\r\n\r\nPlayer.prototype.pause = function (ev) {\r\n  cancelAnimationFrame(this.animationId);\r\n  this.wantsToPlay = false;\r\n  this.isPlaying = false;\r\n\r\n  if (this.audio && this.audio.canPlay) {\r\n    // Seek to the currentTime again - audio may already be enqueued a bit\r\n    // further, so we have to rewind it.\r\n    this.audioOut.stop();\r\n    this.seek(this.currentTime);\r\n  }\r\n\r\n  if (this.cbUI.pause) {\r\n    this.cbUI.pause();\r\n  }\r\n};\r\n\r\nPlayer.prototype.getVolume = function () {\r\n  return this.audioOut ? this.audioOut.volume : 0;\r\n};\r\n\r\nPlayer.prototype.setVolume = function (volume) {\r\n  if (this.audioOut) {\r\n    this.audioOut.volume = volume;\r\n  }\r\n};\r\n\r\nPlayer.prototype.stop = function (ev) {\r\n  this.pause();\r\n  this.seek(0);\r\n  if (this.video && this.options.decodeFirstFrame !== false) {\r\n    this.video.decode();\r\n  }\r\n\r\n  if (this.cbUI.stop) {\r\n    this.cbUI.stop();\r\n  }\r\n};\r\n\r\nPlayer.prototype.destroy = function () {\r\n  this.pause();\r\n  this.source.destroy();\r\n  this.renderer.destroy();\r\n  this.audioOut.destroy();\r\n};\r\n\r\nPlayer.prototype.seek = function (time) {\r\n  var startOffset = this.audio && this.audio.canPlay\r\n    ? this.audio.startTime\r\n    : this.video.startTime;\r\n\r\n  if (this.video) {\r\n    this.video.seek(time + startOffset);\r\n  }\r\n  if (this.audio) {\r\n    this.audio.seek(time + startOffset);\r\n  }\r\n\r\n  this.startTime = Now() - time;\r\n};\r\n\r\nPlayer.prototype.getCurrentTime = function () {\r\n  return this.audio && this.audio.canPlay\r\n    ? this.audio.currentTime - this.audio.startTime\r\n    : this.video.currentTime - this.video.startTime;\r\n};\r\n\r\nPlayer.prototype.setCurrentTime = function (time) {\r\n  this.seek(time);\r\n};\r\n\r\nPlayer.prototype.update = function () {\r\n  this.animationId = requestAnimationFrame(this.update.bind(this));\r\n\r\n  if (!this.source.established) {\r\n    if (this.renderer) {\r\n      this.renderer.renderProgress(this.source.progress);\r\n    }\r\n    return;\r\n  }\r\n\r\n  if (!this.isPlaying) {\r\n    this.isPlaying = true;\r\n    this.startTime = Now() - this.currentTime;\r\n  }\r\n\r\n  if (this.options.streaming) {\r\n    this.updateForStreaming();\r\n  }\r\n  else {\r\n    this.updateForStaticFile();\r\n  }\r\n};\r\n\r\nPlayer.prototype.updateForStreaming = function () {\r\n  // When streaming, immediately decode everything we have buffered up until\r\n  // now to minimize playback latency.\r\n\r\n  if (this.video) {\r\n    this.video.decode();\r\n  }\r\n\r\n  if (this.audio) {\r\n    var decoded = false;\r\n    do {\r\n      // If there's a lot of audio enqueued already, disable output and\r\n      // catch up with the encoding.\r\n      if (this.audioOut.enqueuedTime > this.maxAudioLag) {\r\n        this.audioOut.resetEnqueuedTime();\r\n        this.audioOut.enabled = false;\r\n      }\r\n      decoded = this.audio.decode();\r\n    } while (decoded);\r\n    this.audioOut.enabled = true;\r\n  }\r\n};\r\n\r\nPlayer.prototype.updateForStaticFile = function () {\r\n  var notEnoughData = false,\r\n    headroom = 0;\r\n\r\n  // If we have an audio track, we always try to sync the video to the audio.\r\n  // Gaps and discontinuities are far more percetable in audio than in video.\r\n\r\n  if (this.audio && this.audio.canPlay) {\r\n    // Do we have to decode and enqueue some more audio data?\r\n    while (\r\n      !notEnoughData &&\r\n      this.audio.decodedTime - this.audio.currentTime < 0.25\r\n      ) {\r\n      notEnoughData = !this.audio.decode();\r\n    }\r\n\r\n    // Sync video to audio\r\n    if (this.video && this.video.currentTime < this.audio.currentTime) {\r\n      notEnoughData = !this.video.decode();\r\n    }\r\n\r\n    headroom = this.demuxer.currentTime - this.audio.currentTime;\r\n  }\r\n\r\n\r\n  else if (this.video) {\r\n    // Video only - sync it to player's wallclock\r\n    var targetTime = (Now() - this.startTime) + this.video.startTime,\r\n      lateTime = targetTime - this.video.currentTime,\r\n      frameTime = 1 / this.video.frameRate;\r\n\r\n    if (this.video && lateTime > 0) {\r\n      // If the video is too far behind (>2 frames), simply reset the\r\n      // target time to the next frame instead of trying to catch up.\r\n      if (lateTime > frameTime * 2) {\r\n        this.startTime += lateTime;\r\n      }\r\n\r\n      notEnoughData = !this.video.decode();\r\n    }\r\n\r\n    headroom = this.demuxer.currentTime - targetTime;\r\n  }\r\n\r\n  // Notify the source of the playhead headroom, so it can decide whether to\r\n  // continue loading further data.\r\n  this.source.resume(headroom);\r\n\r\n  // If we failed to decode and the source is complete, it means we reached\r\n  // the end of our data. We may want to loop.\r\n  if (notEnoughData && this.source.completed) {\r\n    if (this.loop) {\r\n      this.seek(0);\r\n    }\r\n    else {\r\n      // this.pause();\r\n      this.stop();\r\n    }\r\n  }\r\n};\r\n\r\nexport default Player;\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/player.js","import {\r\n  Player\r\n} from '../index';\r\n\r\n\r\nexport default class VideoElement {\r\n  constructor(wrapper, videoUrl, {\r\n    poster,\r\n    aspectPercent = '56.25%',\r\n    picMode = false,\r\n    autoplay = false,\r\n    loop = false,\r\n    decodeFirstFrame = true,\r\n    progressive = true,\r\n    hookInPlay = () => {\r\n    },\r\n    hookInPause = () => {\r\n    },\r\n    hookInStop = () => {\r\n    },\r\n  }) {\r\n    // Setup the div container, canvas and play button\r\n    this.options = {\r\n      videoUrl: videoUrl,\r\n      poster: poster,\r\n      aspectPercent: aspectPercent,\r\n      picMode: picMode,\r\n      autoplay: autoplay,\r\n      loop: loop,\r\n      decodeFirstFrame: decodeFirstFrame,\r\n      progressive: progressive,\r\n      hookInPlay: hookInPlay,\r\n      hookInPause: hookInPause,\r\n      hookInStop: hookInStop,\r\n    };\r\n    this.wrapper = isString(wrapper)\r\n      ? document.querySelector(wrapper)\r\n      : wrapper;\r\n    this.container = document.createElement('div');\r\n    this.canvas = document.createElement('canvas');\r\n    this.player = null;\r\n    this.playButton = document.createElement('div');\r\n\r\n    this.containerInit();\r\n    this.canvasInit();\r\n    this.playButtonInit();\r\n    this.playerInit();\r\n\r\n    // Assignment height of wrapper. prevent page shake when destroyed.\r\n    this.setWrapperHeight();\r\n    window.addEventListener('resize', () => this.setWrapperHeight());\r\n  };\r\n\r\n  containerInit() {\r\n    addStyles(this.container, {\r\n      position: 'relative',\r\n      width: '100%',\r\n      minWidth: '80px',\r\n      height: '0',\r\n      paddingBottom: this.options.aspectPercent,\r\n    });\r\n    this.wrapper.appendChild(this.container);\r\n  };\r\n\r\n  canvasInit() {\r\n    addStyles(this.canvas, {\r\n      position: 'absolute',\r\n      top: '0',\r\n      left: '0',\r\n      display: 'block',\r\n      width: '100%',\r\n      height: '100%',\r\n    });\r\n    this.container.appendChild(this.canvas);\r\n  };\r\n\r\n  playerInit() {\r\n    // Parse the data-options - we try to decode the values as json. This way\r\n    // we can get proper boolean and number values. If JSON.parse() fails,\r\n    // treat it as a string.\r\n    this.options = Object.assign(this.options, {\r\n      canvas: this.canvas,\r\n    });\r\n\r\n    // Create the player instance\r\n    this.player = new Player(this.options.videoUrl, this.options, {\r\n      play: () => {\r\n        this.playButton.style.display = 'none';\r\n        if (this.poster) {\r\n          this.poster.style.display = 'none';\r\n        }\r\n        this.options.hookInPlay();\r\n      },\r\n      pause: () => {\r\n        this.playButton.style.display = 'block';\r\n        this.options.hookInPause();\r\n      },\r\n      stop: () => {\r\n        if (this.poster) {\r\n          this.poster.style.display = 'block';\r\n        }\r\n        this.options.hookInStop();\r\n      },\r\n    });\r\n    this.wrapper.playerInstance = this.player;\r\n\r\n    // Setup the poster element, if any\r\n    if (this.options.poster && !this.options.autoplay && !this.player.options.streaming) {\r\n      this.options.decodeFirstFrame = false;\r\n      this.poster = new Image();\r\n      this.poster.src = this.options.poster;\r\n      addStyles(this.poster, {\r\n        display: 'block', zIndex: 1, position: 'absolute',\r\n        top: '0', left: '0', width: '100%', height: '100%',\r\n      });\r\n      this.container.appendChild(this.poster);\r\n    }\r\n\r\n    // Add the click handler if this video is pausable\r\n    if (!this.player.options.streaming) {\r\n      this.container.addEventListener('click', this.onClick.bind(this));\r\n    }\r\n\r\n    // Hide the play button if this video immediately begins playing\r\n    if (this.options.autoplay || this.player.options.streaming) {\r\n      this.playButton.style.display = 'none';\r\n    }\r\n\r\n    // Set up the unlock audio buton for iOS devices. iOS only allows us to\r\n    // play audio after a user action has initiated playing. For autoplay or\r\n    // streaming players we set up a muted speaker icon as the button. For all\r\n    // others, we can simply use the play button.\r\n    if (this.player.audioOut && !this.player.audioOut.unlocked) {\r\n      let unlockAudioElement = this.container;\r\n\r\n      if (this.options.autoplay || this.player.options.streaming) {\r\n        this.unmuteButton = document.createElement('div');\r\n        this.unmuteButton.innerHTML = UNMUTE_BUTTON;\r\n        addStyles(this.unmuteButton, {\r\n          zIndex: 2, position: 'absolute',\r\n          top: '0', left: '0',\r\n          width: '100%', height: '100%',\r\n          opacity: '0.7',\r\n          cursor: 'pointer'\r\n        });\r\n        this.container.appendChild(this.unmuteButton);\r\n        unlockAudioElement = this.unmuteButton;\r\n      }\r\n\r\n      this.unlockAudioBound = this.onUnlockAudio.bind(this, unlockAudioElement);\r\n      unlockAudioElement.addEventListener('touchstart', this.unlockAudioBound, false);\r\n      unlockAudioElement.addEventListener('click', this.unlockAudioBound, true);\r\n    }\r\n  };\r\n\r\n  playButtonInit() {\r\n    this.playButton.innerHTML = PLAY_BUTTON;\r\n    addStyles(this.playButton, {\r\n      zIndex: 2, position: 'absolute',\r\n      top: '0', bottom: '0', left: '0', right: '0',\r\n      maxWidth: '60px', maxHeight: '60px',\r\n      margin: 'auto',\r\n      opacity: '0.7',\r\n      cursor: 'pointer'\r\n    });\r\n    if (this.options.picMode) {\r\n      this.playButton.style.visibility = 'hidden';\r\n    }\r\n    this.container.appendChild(this.playButton);\r\n  };\r\n\r\n  onUnlockAudio(element, ev) {\r\n    if (this.unmuteButton) {\r\n      ev.preventDefault();\r\n      ev.stopPropagation();\r\n    }\r\n    this.player.audioOut.unlock(function () {\r\n      if (this.unmuteButton) {\r\n        this.unmuteButton.style.display = 'none';\r\n      }\r\n      element.removeEventListener('touchstart', this.unlockAudioBound);\r\n      element.removeEventListener('click', this.unlockAudioBound);\r\n    }.bind(this));\r\n  };\r\n\r\n  onClick() {\r\n    if (this.player.isPlaying) {\r\n      this.player.pause();\r\n    }\r\n    else {\r\n      this.player.play();\r\n    }\r\n  };\r\n\r\n  setWrapperHeight() {\r\n    this.wrapper.style.height = this.container.offsetHeight + 'px';\r\n  };\r\n\r\n  destroy() {\r\n    this.player.destroy();\r\n    this.wrapper.innerHTML = '';\r\n    window.removeEventListener('resize', this.setWrapperHeight);\r\n  };\r\n};\r\n\r\nconst\r\n  PLAY_BUTTON = `\r\n<svg style=\"max-width: 60px; max-height: 60px; fill: #fff;\" viewBox=\"0 0 64 64\">\r\n\t<path d=\"M26,45.5L44,32L26,18.6v27V45.5L26,45.5z M32,2C15.4,2,2,15.5,2,32c0,16.6,13.4,30,30,30c16.6,0,30-13.4,30-30\r\n\tC62,15.4,48.5,2,32,2L32,2z M32,56c-9.7,0-18.5-5.9-22.2-14.8C6.1,32.2,8.1,21.9,15,15c6.9-6.9,17.2-8.9,26.2-5.2\r\n\tC50.1,13.5,56,22.3,56,32C56,45.3,45.2,56,32,56L32,56z\"/>\r\n</svg>\r\n`\r\n  , UNMUTE_BUTTON = `\r\n<svg style=\"position: absolute; bottom: 15px; right: 15px; width: 40px; height: 40px; fill: #fff;\" viewBox=\"0 0 64 64\">\r\n\t<path d=\"M58.3,45.5l-4.8-4.3c1.4-2.9,2.2-6.2,2.2-9.6c0-11.1-8.2-20.3-18.9-21.9V3.3C50.9,4.9,62,16.9,62,31.6\r\n\tC62,36.6,60.6,41.4,58.3,45.5L58.3,45.5z M30.4,5.6v15.2l-8.3-7.3L30.4,5.6L30.4,5.6z M36.7,19.9c4.6,1.9,7.9,6.4,7.9,11.7\r\n\tc0,0.6-0.1,1.1-0.1,1.7l-7.8-6.9V19.9L36.7,19.9z M57.5,60.7l-7.1-6.3c-3.9,2.9-8.6,4.8-13.7,5.4v-6.4c3.2-0.5,6.2-1.7,8.8-3.4\r\n\tl-8.1-7.2c-0.2,0.1-0.5,0.3-0.7,0.4v-1l-6.3-5.6v20.2L15.4,42.6H2V20.5h10.2l-9.7-8.6l4.2-4.7L61.7,56L57.5,60.7L57.5,60.7z\"/>\r\n</svg>\r\n`\r\n;\r\n\r\nlet\r\n  addStyles = (element, styles) => {\r\n    for (let name in styles) {\r\n      element.style[name] = styles[name];\r\n    }\r\n  }\r\n\r\n  , isString = (str) => {\r\n    return (typeof str === 'string') && str.constructor === String;\r\n  }\r\n;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/video-element.js","let BitBuffer = function(bufferOrLength, mode) {\r\n\tif (typeof(bufferOrLength) === 'object') {\r\n\t\tthis.bytes = (bufferOrLength instanceof Uint8Array)\r\n\t\t\t? bufferOrLength \r\n\t\t\t: new Uint8Array(bufferOrLength);\r\n\r\n\t\tthis.byteLength = this.bytes.length;\r\n\t}\r\n\telse {\r\n\t\tthis.bytes = new Uint8Array(bufferOrLength || 1024*1024);\t\r\n\t\tthis.byteLength = 0;\r\n\t}\r\n\r\n\tthis.mode = mode || BitBuffer.MODE.EXPAND;\r\n\tthis.index = 0;\r\n};\r\n\r\nBitBuffer.prototype.resize = function(size) {\r\n\tvar newBytes = new Uint8Array(size);\r\n\tif (this.byteLength !== 0) {\r\n\t\tthis.byteLength = Math.min(this.byteLength, size);\r\n\t\tnewBytes.set(this.bytes, 0, this.byteLength);\r\n\t}\r\n\tthis.bytes = newBytes;\r\n\tthis.index = Math.min(this.index, this.byteLength << 3);\r\n};\r\n\r\nBitBuffer.prototype.evict = function(sizeNeeded) {\r\n\tvar bytePos = this.index >> 3,\r\n\t\tavailable = this.bytes.length - this.byteLength;\r\n\t\r\n\t// If the current index is the write position, we can simply reset both\r\n\t// to 0. Also reset (and throw away yet unread data) if we won't be able\r\n\t// to fit the new data in even after a normal eviction.\r\n\tif (\r\n\t\tthis.index === this.byteLength << 3 ||\r\n\t\tsizeNeeded > available + bytePos // emergency evac\r\n\t) {\r\n\t\tthis.byteLength = 0;\r\n\t\tthis.index = 0;\r\n\t\treturn;\r\n\t}\r\n\telse if (bytePos === 0) {\r\n\t\t// Nothing read yet - we can't evict anything\r\n\t\treturn;\r\n\t}\r\n\t\r\n\t// Some browsers don't support copyWithin() yet - we may have to do \r\n\t// it manually using set and a subarray\r\n\tif (this.bytes.copyWithin) {\r\n\t\tthis.bytes.copyWithin(0, bytePos, this.byteLength);\r\n\t}\r\n\telse {\r\n\t\tthis.bytes.set(this.bytes.subarray(bytePos, this.byteLength));\r\n\t}\r\n\r\n\tthis.byteLength = this.byteLength - bytePos;\r\n\tthis.index -= bytePos << 3;\r\n\treturn;\r\n};\r\n\r\nBitBuffer.prototype.write = function(buffers) {\r\n\tvar isArrayOfBuffers = (typeof(buffers[0]) === 'object'),\r\n\t\ttotalLength = 0,\r\n\t\tavailable = this.bytes.length - this.byteLength;\r\n\r\n\t// Calculate total byte length\r\n\tif (isArrayOfBuffers) {\r\n\t\tvar totalLength = 0;\r\n\t\tfor (var i = 0; i < buffers.length; i++) {\r\n\t\t\ttotalLength += buffers[i].byteLength;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\ttotalLength = buffers.byteLength;\r\n\t}\r\n\r\n\t// Do we need to resize or evict?\r\n\tif (totalLength > available) {\r\n\t\tif (this.mode === BitBuffer.MODE.EXPAND) {\r\n\t\t\tvar newSize = Math.max(\r\n\t\t\t\tthis.bytes.length * 2,\r\n\t\t\t\ttotalLength - available\r\n\t\t\t);\r\n\t\t\tthis.resize(newSize)\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.evict(totalLength);\r\n\t\t}\r\n\t}\r\n\r\n\tif (isArrayOfBuffers) {\r\n\t\tfor (var i = 0; i < buffers.length; i++) {\r\n\t\t\tthis.appendSingleBuffer(buffers[i]);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.appendSingleBuffer(buffers);\r\n\t}\r\n};\r\n\r\nBitBuffer.prototype.appendSingleBuffer = function(buffer) {\r\n\tbuffer = buffer instanceof Uint8Array\r\n\t\t? buffer \r\n\t\t: new Uint8Array(buffer);\r\n\t\r\n\tthis.bytes.set(buffer, this.byteLength);\r\n\tthis.byteLength += buffer.length;\r\n};\r\n\r\nBitBuffer.prototype.findNextStartCode = function() {\t\r\n\tfor (var i = (this.index+7 >> 3); i < this.byteLength; i++) {\r\n\t\tif(\r\n\t\t\tthis.bytes[i] == 0x00 &&\r\n\t\t\tthis.bytes[i+1] == 0x00 &&\r\n\t\t\tthis.bytes[i+2] == 0x01\r\n\t\t) {\r\n\t\t\tthis.index = (i+4) << 3;\r\n\t\t\treturn this.bytes[i+3];\r\n\t\t}\r\n\t}\r\n\tthis.index = (this.byteLength << 3);\r\n\treturn -1;\r\n};\r\n\r\nBitBuffer.prototype.findStartCode = function(code) {\r\n\tvar current = 0;\r\n\twhile (true) {\r\n\t\tcurrent = this.findNextStartCode();\r\n\t\tif (current === code || current === -1) {\r\n\t\t\treturn current;\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n};\r\n\r\nBitBuffer.prototype.nextBytesAreStartCode = function() {\r\n\tvar i = (this.index+7 >> 3);\r\n\treturn (\r\n\t\ti >= this.byteLength || (\r\n\t\t\tthis.bytes[i] == 0x00 && \r\n\t\t\tthis.bytes[i+1] == 0x00 &&\r\n\t\t\tthis.bytes[i+2] == 0x01\r\n\t\t)\r\n\t);\r\n};\r\n\r\nBitBuffer.prototype.peek = function(count) {\r\n\tvar offset = this.index;\r\n\tvar value = 0;\r\n\twhile (count) {\r\n\t\tvar currentByte = this.bytes[offset >> 3],\r\n\t\t\tremaining = 8 - (offset & 7), // remaining bits in byte\r\n\t\t\tread = remaining < count ? remaining : count, // bits in this run\r\n\t\t\tshift = remaining - read,\r\n\t\t\tmask = (0xff >> (8-read));\r\n\r\n\t\tvalue = (value << read) | ((currentByte & (mask << shift)) >> shift);\r\n\r\n\t\toffset += read;\r\n\t\tcount -= read;\r\n\t}\r\n\r\n\treturn value;\r\n}\r\n\r\nBitBuffer.prototype.read = function(count) {\r\n\tvar value = this.peek(count);\r\n\tthis.index += count;\r\n\treturn value;\r\n};\r\n\r\nBitBuffer.prototype.skip = function(count) {\r\n\treturn (this.index += count);\r\n};\r\n\r\nBitBuffer.prototype.rewind = function(count) {\r\n\tthis.index = Math.max(this.index - count, 0);\r\n};\r\n\r\nBitBuffer.prototype.has = function(count) {\r\n\treturn ((this.byteLength << 3) - this.index) >= count;\r\n};\r\n\r\nBitBuffer.MODE = {\r\n\tEVICT: 1,\r\n\tEXPAND: 2\r\n};\r\n\r\nexport default BitBuffer;\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/buffer.js","let AjaxSource = function(url, options) {\n\tthis.url = url;\n\tthis.destination = null;\n\tthis.request = null;\n\n\tthis.completed = false;\n\tthis.established = false;\n\tthis.progress = 0;\n};\n\nAjaxSource.prototype.connect = function(destination) {\n\tthis.destination = destination;\n};\n\nAjaxSource.prototype.start = function() {\n\tthis.request = new XMLHttpRequest();\n\n\tthis.request.onreadystatechange = function() {\n\t\tif (\n\t\t\tthis.request.readyState === this.request.DONE && \n\t\t\tthis.request.status === 200\n\t\t) {\n\t\t\tthis.onLoad(this.request.response);\n\t\t}\n\t}.bind(this);\n\n\tthis.request.onprogress = this.onProgress.bind(this);\n\tthis.request.open('GET', this.url);\n\tthis.request.responseType = \"arraybuffer\";\n\tthis.request.send();\n};\n\nAjaxSource.prototype.resume = function(secondsHeadroom) {\n\t// Nothing to do here\n};\n\nAjaxSource.prototype.destroy = function() {\n\tthis.request.abort();\n};\n\nAjaxSource.prototype.onProgress = function(ev) {\n\tthis.progress = (ev.loaded / ev.total);\n};\n\nAjaxSource.prototype.onLoad = function(data) {\n\tthis.established = true;\n\tthis.completed = true;\n\tthis.progress = 1;\n\n\tif (this.destination) {\n\t\tthis.destination.write(data);\n\t}\n};\n\nexport default AjaxSource;\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/ajax.js","import {\r\n\tNow\r\n} from '../index';\r\n\r\nlet AjaxProgressiveSource = function(url, options) {\r\n\tthis.url = url;\r\n\tthis.destination = null;\r\n\tthis.request = null;\r\n\r\n\tthis.completed = false;\r\n\tthis.established = false;\r\n\tthis.progress = 0;\r\n\r\n\tthis.fileSize = 0;\r\n\tthis.loadedSize = 0;\r\n\tthis.chunkSize = options.chunkSize || 1024*1024;\r\n\r\n\tthis.isLoading = false;\r\n\tthis.loadStartTime = 0;\r\n\tthis.throttled = options.throttled !== false;\r\n\tthis.aborted = false;\r\n};\r\n\r\nAjaxProgressiveSource.prototype.connect = function(destination) {\r\n  this.destination = destination;\r\n};\r\n\r\nAjaxProgressiveSource.prototype.start = function() {\r\n  this.request = new XMLHttpRequest();\r\n\r\n  this.request.onreadystatechange = function() {\r\n    if (this.request.readyState === this.request.DONE) {\r\n      this.fileSize = parseInt(\r\n        this.request.getResponseHeader(\"Content-Length\")\r\n      );\r\n      this.loadNextChunk();\r\n    }\r\n  }.bind(this);\r\n\r\n  this.request.onprogress = this.onProgress.bind(this);\r\n  this.request.open('HEAD', this.url);\r\n  this.request.send();\r\n};\r\n\r\nAjaxProgressiveSource.prototype.resume = function(secondsHeadroom) {\r\n  if (this.isLoading || !this.throttled) {\r\n    return;\r\n  }\r\n\r\n  // Guess the worst case loading time with lots of safety margin. This is\r\n  // somewhat arbitrary...\r\n  var worstCaseLoadingTime = this.loadTime * 8 + 2;\r\n  if (worstCaseLoadingTime > secondsHeadroom) {\r\n    this.loadNextChunk();\r\n  }\r\n};\r\n\r\nAjaxProgressiveSource.prototype.destroy = function() {\r\n  this.request.abort();\r\n  this.aborted = true;\r\n};\r\n\r\nAjaxProgressiveSource.prototype.loadNextChunk = function() {\r\n  var start = this.loadedSize,\r\n    end = Math.min(this.loadedSize + this.chunkSize-1, this.fileSize-1);\r\n\r\n  if (start >= this.fileSize || this.aborted) {\r\n    this.completed = true;\r\n    return;\r\n  }\r\n\r\n  this.isLoading = true;\r\n  this.loadStartTime = JSMpeg.Now();\r\n  this.request = new XMLHttpRequest();\r\n\r\n  this.request.onreadystatechange = function() {\r\n    if (\r\n      this.request.readyState === this.request.DONE &&\r\n      this.request.status >= 200 && this.request.status < 300\r\n    ) {\r\n      this.onChunkLoad(this.request.response);\r\n    }\r\n    else if (this.request.readyState === this.request.DONE) {\r\n      // Retry?\r\n      if (this.loadFails++ < 3) {\r\n        this.loadNextChunk();\r\n      }\r\n    }\r\n  }.bind(this);\r\n\r\n  if (start === 0) {\r\n    this.request.onprogress = this.onProgress.bind(this);\r\n  }\r\n\r\n  this.request.open('GET', this.url+'?'+start+\"-\"+end);\r\n  this.request.setRequestHeader(\"Range\", \"bytes=\"+start+\"-\"+end);\r\n  this.request.responseType = \"arraybuffer\";\r\n  this.request.send();\r\n};\r\n\r\nAjaxProgressiveSource.prototype.onProgress = function(ev) {\r\n  this.progress = (ev.loaded / ev.total);\r\n};\r\n\r\nAjaxProgressiveSource.prototype.onChunkLoad = function(data) {\r\n  this.established = true;\r\n  this.progress = 1;\r\n  this.loadedSize += data.byteLength;\r\n  this.loadFails = 0;\r\n  this.isLoading = false;\r\n\r\n  if (this.destination) {\r\n    this.destination.write(data);\r\n  }\r\n\r\n  this.loadTime = JSMpeg.Now() - this.loadStartTime;\r\n  if (!this.throttled) {\r\n    this.loadNextChunk();\r\n  }\r\n};\r\n\r\nexport default AjaxProgressiveSource;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/ajax-progressive.js","let WSSource = function(url, options) {\n\tthis.url = url;\n\tthis.options = options;\n\tthis.socket = null;\t\n\n\tthis.callbacks = {connect: [], data: []};\n\tthis.destination = null;\n\n\tthis.reconnectInterval = options.reconnectInterval !== undefined\n\t\t? options.reconnectInterval\n\t\t: 5;\n\tthis.shouldAttemptReconnect = !!this.reconnectInterval;\n\n\tthis.completed = false;\n\tthis.established = false;\n\tthis.progress = 0;\n\n\tthis.reconnectTimeoutId = 0;\n};\n\nWSSource.prototype.connect = function(destination) {\n\tthis.destination = destination;\n};\n\nWSSource.prototype.destroy = function() {\n\tclearTimeout(this.reconnectTimeoutId);\n\tthis.shouldAttemptReconnect = false;\n\tthis.socket.close();\n};\n\nWSSource.prototype.start = function() {\n\tthis.shouldAttemptReconnect = !!this.reconnectInterval;\n\tthis.progress = 0;\n\tthis.established = false;\n\t\n\tthis.socket = new WebSocket(this.url, this.options.protocols || null);\n\tthis.socket.binaryType = 'arraybuffer';\n\tthis.socket.onmessage = this.onMessage.bind(this);\n\tthis.socket.onopen = this.onOpen.bind(this);\n\tthis.socket.onerror = this.onClose.bind(this);\n\tthis.socket.onclose = this.onClose.bind(this);\n};\n\nWSSource.prototype.resume = function(secondsHeadroom) {\n\t// Nothing to do here\n};\n\nWSSource.prototype.onOpen = function() {\n\tthis.progress = 1;\n\tthis.established = true;\n};\n\nWSSource.prototype.onClose = function() {\n\tif (this.shouldAttemptReconnect) {\n\t\tclearTimeout(this.reconnectTimeoutId);\n\t\tthis.reconnectTimeoutId = setTimeout(function(){\n\t\t\tthis.start();\t\n\t\t}.bind(this), this.reconnectInterval*1000);\n\t}\n};\n\nWSSource.prototype.onMessage = function(ev) {\n\tif (this.destination) {\n\t\tthis.destination.write(ev.data);\n\t}\n};\n\nexport default WSSource;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/websocket.js","import {\r\n  BitBuffer,\r\n} from '../index';\r\n\r\nlet TS = function (options) {\r\n  this.bits = null;\r\n  this.leftoverBytes = null;\r\n\r\n  this.guessVideoFrameEnd = true;\r\n  this.pidsToStreamIds = {};\r\n\r\n  this.pesPacketInfo = {};\r\n  this.startTime = 0;\r\n  this.currentTime = 0;\r\n};\r\n\r\nTS.prototype.connect = function (streamId, destination) {\r\n  this.pesPacketInfo[streamId] = {\r\n    destination: destination,\r\n    currentLength: 0,\r\n    totalLength: 0,\r\n    pts: 0,\r\n    buffers: []\r\n  };\r\n};\r\n\r\nTS.prototype.write = function (buffer) {\r\n  if (this.leftoverBytes) {\r\n    var totalLength = buffer.byteLength + this.leftoverBytes.byteLength;\r\n    this.bits = new BitBuffer(totalLength);\r\n    this.bits.write([this.leftoverBytes, buffer]);\r\n  }\r\n  else {\r\n    this.bits = new BitBuffer(buffer);\r\n  }\r\n\r\n  while (this.bits.has(188 << 3) && this.parsePacket()) {\r\n  }\r\n\r\n  var leftoverCount = this.bits.byteLength - (this.bits.index >> 3);\r\n  this.leftoverBytes = leftoverCount > 0\r\n    ? this.bits.bytes.subarray(this.bits.index >> 3)\r\n    : null;\r\n};\r\n\r\nTS.prototype.parsePacket = function () {\r\n  // Check if we're in sync with packet boundaries; attempt to resync if not.\r\n  if (this.bits.read(8) !== 0x47) {\r\n    if (!this.resync()) {\r\n      // Couldn't resync; maybe next time...\r\n      return false;\r\n    }\r\n  }\r\n\r\n  var end = (this.bits.index >> 3) + 187;\r\n  var transportError = this.bits.read(1),\r\n    payloadStart = this.bits.read(1),\r\n    transportPriority = this.bits.read(1),\r\n    pid = this.bits.read(13),\r\n    transportScrambling = this.bits.read(2),\r\n    adaptationField = this.bits.read(2),\r\n    continuityCounter = this.bits.read(4);\r\n\r\n\r\n  // If this is the start of a new payload; signal the end of the previous\r\n  // frame, if we didn't do so already.\r\n  var streamId = this.pidsToStreamIds[pid];\r\n  if (payloadStart && streamId) {\r\n    var pi = this.pesPacketInfo[streamId];\r\n    if (pi && pi.currentLength) {\r\n      this.packetComplete(pi);\r\n    }\r\n  }\r\n\r\n  // Extract current payload\r\n  if (adaptationField & 0x1) {\r\n    if ((adaptationField & 0x2)) {\r\n      var adaptationFieldLength = this.bits.read(8);\r\n      this.bits.skip(adaptationFieldLength << 3);\r\n    }\r\n\r\n    if (payloadStart && this.bits.nextBytesAreStartCode()) {\r\n      this.bits.skip(24);\r\n      streamId = this.bits.read(8);\r\n      this.pidsToStreamIds[pid] = streamId;\r\n\r\n      var packetLength = this.bits.read(16)\r\n      this.bits.skip(8);\r\n      var ptsDtsFlag = this.bits.read(2);\r\n      this.bits.skip(6);\r\n      var headerLength = this.bits.read(8);\r\n      var payloadBeginIndex = this.bits.index + (headerLength << 3);\r\n\r\n      var pi = this.pesPacketInfo[streamId];\r\n      if (pi) {\r\n        var pts = 0;\r\n        if (ptsDtsFlag & 0x2) {\r\n          // The Presentation Timestamp is encoded as 33(!) bit\r\n          // integer, but has a \"marker bit\" inserted at weird places\r\n          // in between, making the whole thing 5 bytes in size.\r\n          // You can't make this shit up...\r\n          this.bits.skip(4);\r\n          var p32_30 = this.bits.read(3);\r\n          this.bits.skip(1);\r\n          var p29_15 = this.bits.read(15);\r\n          this.bits.skip(1);\r\n          var p14_0 = this.bits.read(15);\r\n          this.bits.skip(1);\r\n\r\n          // Can't use bit shifts here; we need 33 bits of precision,\r\n          // so we're using JavaScript's double number type. Also\r\n          // divide by the 90khz clock to get the pts in seconds.\r\n          pts = (p32_30 * 1073741824 + p29_15 * 32768 + p14_0) / 90000;\r\n\r\n          this.currentTime = pts;\r\n          if (this.startTime === -1) {\r\n            this.startTime = pts;\r\n          }\r\n        }\r\n\r\n        var payloadLength = packetLength\r\n          ? packetLength - headerLength - 3\r\n          : 0;\r\n        this.packetStart(pi, pts, payloadLength);\r\n      }\r\n\r\n      // Skip the rest of the header without parsing it\r\n      this.bits.index = payloadBeginIndex;\r\n    }\r\n\r\n    if (streamId) {\r\n      // Attempt to detect if the PES packet is complete. For Audio (and\r\n      // other) packets, we received a total packet length with the PES\r\n      // header, so we can check the current length.\r\n\r\n      // For Video packets, we have to guess the end by detecting if this\r\n      // TS packet was padded - there's no good reason to pad a TS packet\r\n      // in between, but it might just fit exactly. If this fails, we can\r\n      // only wait for the next PES header for that stream.\r\n\r\n      var pi = this.pesPacketInfo[streamId];\r\n      if (pi) {\r\n        var start = this.bits.index >> 3;\r\n        var complete = this.packetAddData(pi, start, end);\r\n\r\n        var hasPadding = !payloadStart && (adaptationField & 0x2);\r\n        if (complete || (this.guessVideoFrameEnd && hasPadding)) {\r\n          this.packetComplete(pi);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  this.bits.index = end << 3;\r\n  return true;\r\n};\r\n\r\nTS.prototype.resync = function () {\r\n  // Check if we have enough data to attempt a resync. We need 5 full packets.\r\n  if (!this.bits.has((188 * 6) << 3)) {\r\n    return false;\r\n  }\r\n\r\n  var byteIndex = this.bits.index >> 3;\r\n\r\n  // Look for the first sync token in the first 187 bytes\r\n  for (var i = 0; i < 187; i++) {\r\n    if (this.bits.bytes[byteIndex + i] === 0x47) {\r\n\r\n      // Look for 4 more sync tokens, each 188 bytes appart\r\n      var foundSync = true;\r\n      for (var j = 1; j < 5; j++) {\r\n        if (this.bits.bytes[byteIndex + i + 188 * j] !== 0x47) {\r\n          foundSync = false;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (foundSync) {\r\n        this.bits.index = (byteIndex + i + 1) << 3;\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n\r\n  // In theory, we shouldn't arrive here. If we do, we had enough data but\r\n  // still didn't find sync - this can only happen if we were fed garbage\r\n  // data. Check your source!\r\n  console.warn('JSMpeg: Possible garbage data. Skipping.');\r\n  this.bits.skip(187 << 3);\r\n  return false;\r\n};\r\n\r\nTS.prototype.packetStart = function (pi, pts, payloadLength) {\r\n  pi.totalLength = payloadLength;\r\n  pi.currentLength = 0;\r\n  pi.pts = pts;\r\n};\r\n\r\nTS.prototype.packetAddData = function (pi, start, end) {\r\n  pi.buffers.push(this.bits.bytes.subarray(start, end));\r\n  pi.currentLength += end - start;\r\n\r\n  var complete = (pi.totalLength !== 0 && pi.currentLength >= pi.totalLength);\r\n  return complete;\r\n};\r\n\r\nTS.prototype.packetComplete = function (pi) {\r\n  pi.destination.write(pi.pts, pi.buffers);\r\n  pi.totalLength = 0;\r\n  pi.currentLength = 0;\r\n  pi.buffers = [];\r\n};\r\n\r\nTS.STREAM = {\r\n  PACK_HEADER: 0xBA,\r\n  SYSTEM_HEADER: 0xBB,\r\n  PROGRAM_MAP: 0xBC,\r\n  PRIVATE_1: 0xBD,\r\n  PADDING: 0xBE,\r\n  PRIVATE_2: 0xBF,\r\n  AUDIO_1: 0xC0,\r\n  VIDEO_1: 0xE0,\r\n  DIRECTORY: 0xFF\r\n};\r\n\r\nexport default TS;\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/ts.js","// Inspired by Java MPEG-1 Video Decoder and Player by Zoltan Korandi\r\n// https://sourceforge.net/projects/javampeg1video/\r\n\r\nimport {\r\n  Decoder,\r\n  BitBuffer,\r\n\tFill,\r\n} from '../index';\r\n\r\nimport BaseDecoder from './decoder';\r\n\r\nlet MPEG1 = function(options) {\r\n\tDecoder.Base.call(this, options);\r\n\r\n\tvar bufferSize = options.videoBufferSize || 512*1024;\r\n\tvar bufferMode = options.streaming\r\n\t\t? BitBuffer.MODE.EVICT\r\n\t\t: BitBuffer.MODE.EXPAND;\r\n\r\n\tthis.bits = new BitBuffer(bufferSize, bufferMode);\r\n\r\n\tthis.customIntraQuantMatrix = new Uint8Array(64);\r\n\tthis.customNonIntraQuantMatrix = new Uint8Array(64);\r\n\tthis.blockData = new Int32Array(64);\r\n\r\n\tthis.currentFrame = 0;\r\n\tthis.decodeFirstFrame = options.decodeFirstFrame !== false;\r\n};\r\n\r\n\r\nMPEG1.prototype = Object.create(BaseDecoder.prototype);\r\nMPEG1.prototype.constructor = MPEG1;\r\n\r\nMPEG1.prototype.write = function(pts, buffers) {\r\n\tDecoder.Base.prototype.write.call(this, pts, buffers);\r\n\r\n\tif (!this.hasSequenceHeader) {\r\n\t\tif (this.bits.findStartCode(MPEG1.START.SEQUENCE) === -1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tthis.decodeSequenceHeader();\r\n\r\n\t\tif (this.decodeFirstFrame) {\r\n\t\t\tthis.decode();\r\n\t\t}\r\n\t}\r\n};\r\n\r\nMPEG1.prototype.decode = function() {\r\n\tif (!this.hasSequenceHeader) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif (this.bits.findStartCode(MPEG1.START.PICTURE) === -1) {\r\n\t\tvar bufferedBytes = this.bits.byteLength - (this.bits.index >> 3);\r\n\t\treturn false;\r\n\t}\r\n\r\n\tthis.decodePicture();\r\n\tthis.advanceDecodedTime(1/this.frameRate);\r\n\treturn true;\r\n};\r\n\r\nMPEG1.prototype.readHuffman = function(codeTable) {\r\n\tvar state = 0;\r\n\tdo {\r\n\t\tstate = codeTable[state + this.bits.read(1)];\r\n\t} while (state >= 0 && codeTable[state] !== 0);\r\n\treturn codeTable[state+2];\r\n};\r\n\r\n\r\n// Sequence Layer\r\n\r\nMPEG1.prototype.frameRate = 30;\r\nMPEG1.prototype.decodeSequenceHeader = function() {\r\n\tvar newWidth = this.bits.read(12),\r\n\t\tnewHeight = this.bits.read(12);\r\n\r\n\t// skip pixel aspect ratio\r\n\tthis.bits.skip(4);\r\n\r\n\tthis.frameRate = MPEG1.PICTURE_RATE[this.bits.read(4)];\r\n\r\n\t// skip bitRate, marker, bufferSize and constrained bit\r\n\tthis.bits.skip(18 + 1 + 10 + 1);\r\n\r\n\tif (newWidth !== this.width || newHeight !== this.height) {\r\n\t\tthis.width = newWidth;\r\n\t\tthis.height = newHeight;\r\n\r\n\t\tthis.initBuffers();\r\n\r\n\t\tif (this.destination) {\r\n\t\t\tthis.destination.resize(newWidth, newHeight);\r\n\t\t}\r\n\t}\r\n\r\n\tif (this.bits.read(1)) { // load custom intra quant matrix?\r\n\t\tfor (var i = 0; i < 64; i++) {\r\n\t\t\tthis.customIntraQuantMatrix[MPEG1.ZIG_ZAG[i]] = this.bits.read(8);\r\n\t\t}\r\n\t\tthis.intraQuantMatrix = this.customIntraQuantMatrix;\r\n\t}\r\n\r\n\tif (this.bits.read(1)) { // load custom non intra quant matrix?\r\n\t\tfor (var i = 0; i < 64; i++) {\r\n\t\t\tvar idx = MPEG1.ZIG_ZAG[i];\r\n\t\t\tthis.customNonIntraQuantMatrix[idx] = this.bits.read(8);\r\n\t\t}\r\n\t\tthis.nonIntraQuantMatrix = this.customNonIntraQuantMatrix;\r\n\t}\r\n\r\n\tthis.hasSequenceHeader = true;\r\n};\r\n\r\nMPEG1.prototype.initBuffers = function() {\r\n\tthis.intraQuantMatrix = MPEG1.DEFAULT_INTRA_QUANT_MATRIX;\r\n\tthis.nonIntraQuantMatrix = MPEG1.DEFAULT_NON_INTRA_QUANT_MATRIX;\r\n\r\n\tthis.mbWidth = (this.width + 15) >> 4;\r\n\tthis.mbHeight = (this.height + 15) >> 4;\r\n\tthis.mbSize = this.mbWidth * this.mbHeight;\r\n\r\n\tthis.codedWidth = this.mbWidth << 4;\r\n\tthis.codedHeight = this.mbHeight << 4;\r\n\tthis.codedSize = this.codedWidth * this.codedHeight;\r\n\r\n\tthis.halfWidth = this.mbWidth << 3;\r\n\tthis.halfHeight = this.mbHeight << 3;\r\n\r\n\t// Allocated buffers and resize the canvas\r\n\tthis.currentY = new Uint8ClampedArray(this.codedSize);\r\n\tthis.currentY32 = new Uint32Array(this.currentY.buffer);\r\n\r\n\tthis.currentCr = new Uint8ClampedArray(this.codedSize >> 2);\r\n\tthis.currentCr32 = new Uint32Array(this.currentCr.buffer);\r\n\r\n\tthis.currentCb = new Uint8ClampedArray(this.codedSize >> 2);\r\n\tthis.currentCb32 = new Uint32Array(this.currentCb.buffer);\r\n\r\n\r\n\tthis.forwardY = new Uint8ClampedArray(this.codedSize);\r\n\tthis.forwardY32 = new Uint32Array(this.forwardY.buffer);\r\n\r\n\tthis.forwardCr = new Uint8ClampedArray(this.codedSize >> 2);\r\n\tthis.forwardCr32 = new Uint32Array(this.forwardCr.buffer);\r\n\r\n\tthis.forwardCb = new Uint8ClampedArray(this.codedSize >> 2);\r\n\tthis.forwardCb32 = new Uint32Array(this.forwardCb.buffer);\r\n};\r\n\r\n\r\n// Picture Layer\r\n\r\nMPEG1.prototype.currentY = null;\r\nMPEG1.prototype.currentCr = null;\r\nMPEG1.prototype.currentCb = null;\r\n\r\nMPEG1.prototype.pictureType = 0;\r\n\r\n// Buffers for motion compensation\r\nMPEG1.prototype.forwardY = null;\r\nMPEG1.prototype.forwardCr = null;\r\nMPEG1.prototype.forwardCb = null;\r\n\r\nMPEG1.prototype.fullPelForward = false;\r\nMPEG1.prototype.forwardFCode = 0;\r\nMPEG1.prototype.forwardRSize = 0;\r\nMPEG1.prototype.forwardF = 0;\r\n\r\nMPEG1.prototype.decodePicture = function(skipOutput) {\r\n\tthis.currentFrame++;\r\n\r\n\tthis.bits.skip(10); // skip temporalReference\r\n\tthis.pictureType = this.bits.read(3);\r\n\tthis.bits.skip(16); // skip vbv_delay\r\n\r\n\t// Skip B and D frames or unknown coding type\r\n\tif (this.pictureType <= 0 || this.pictureType >= MPEG1.PICTURE_TYPE.B) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// full_pel_forward, forward_f_code\r\n\tif (this.pictureType === MPEG1.PICTURE_TYPE.PREDICTIVE) {\r\n\t\tthis.fullPelForward = this.bits.read(1);\r\n\t\tthis.forwardFCode = this.bits.read(3);\r\n\t\tif (this.forwardFCode === 0) {\r\n\t\t\t// Ignore picture with zero forward_f_code\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.forwardRSize = this.forwardFCode - 1;\r\n\t\tthis.forwardF = 1 << this.forwardRSize;\r\n\t}\r\n\r\n\tvar code = 0;\r\n\tdo {\r\n\t\tcode = this.bits.findNextStartCode();\r\n\t} while (code === MPEG1.START.EXTENSION || code === MPEG1.START.USER_DATA );\r\n\r\n\r\n\twhile (code >= MPEG1.START.SLICE_FIRST && code <= MPEG1.START.SLICE_LAST) {\r\n\t\tthis.decodeSlice(code & 0x000000FF);\r\n\t\tcode = this.bits.findNextStartCode();\r\n\t}\r\n\r\n\tif (code !== -1) {\r\n\t\t// We found the next start code; rewind 32bits and let the main loop\r\n\t\t// handle it.\r\n\t\tthis.bits.rewind(32);\r\n\t}\r\n\r\n\t// Invoke decode callbacks\r\n\tif (this.destination) {\r\n\t\tthis.destination.render(this.currentY, this.currentCr, this.currentCb);\r\n\t}\r\n\r\n\t// If this is a reference picutre then rotate the prediction pointers\r\n\tif (\r\n\t\tthis.pictureType === MPEG1.PICTURE_TYPE.INTRA ||\r\n\t\tthis.pictureType === MPEG1.PICTURE_TYPE.PREDICTIVE\r\n\t) {\r\n\t\tvar\r\n\t\t\ttmpY = this.forwardY,\r\n\t\t\ttmpY32 = this.forwardY32,\r\n\t\t\ttmpCr = this.forwardCr,\r\n\t\t\ttmpCr32 = this.forwardCr32,\r\n\t\t\ttmpCb = this.forwardCb,\r\n\t\t\ttmpCb32 = this.forwardCb32;\r\n\r\n\t\tthis.forwardY = this.currentY;\r\n\t\tthis.forwardY32 = this.currentY32;\r\n\t\tthis.forwardCr = this.currentCr;\r\n\t\tthis.forwardCr32 = this.currentCr32;\r\n\t\tthis.forwardCb = this.currentCb;\r\n\t\tthis.forwardCb32 = this.currentCb32;\r\n\r\n\t\tthis.currentY = tmpY;\r\n\t\tthis.currentY32 = tmpY32;\r\n\t\tthis.currentCr = tmpCr;\r\n\t\tthis.currentCr32 = tmpCr32;\r\n\t\tthis.currentCb = tmpCb;\r\n\t\tthis.currentCb32 = tmpCb32;\r\n\t}\r\n};\r\n\r\n\r\n// Slice Layer\r\n\r\nMPEG1.prototype.quantizerScale = 0;\r\nMPEG1.prototype.sliceBegin = false;\r\n\r\nMPEG1.prototype.decodeSlice = function(slice) {\r\n\tthis.sliceBegin = true;\r\n\tthis.macroblockAddress = (slice - 1) * this.mbWidth - 1;\r\n\r\n\t// Reset motion vectors and DC predictors\r\n\tthis.motionFwH = this.motionFwHPrev = 0;\r\n\tthis.motionFwV = this.motionFwVPrev = 0;\r\n\tthis.dcPredictorY  = 128;\r\n\tthis.dcPredictorCr = 128;\r\n\tthis.dcPredictorCb = 128;\r\n\r\n\tthis.quantizerScale = this.bits.read(5);\r\n\r\n\t// skip extra bits\r\n\twhile (this.bits.read(1)) {\r\n\t\tthis.bits.skip(8);\r\n\t}\r\n\r\n\tdo {\r\n\t\tthis.decodeMacroblock();\r\n\t} while (!this.bits.nextBytesAreStartCode());\r\n};\r\n\r\n\r\n// Macroblock Layer\r\n\r\nMPEG1.prototype.macroblockAddress = 0;\r\nMPEG1.prototype.mbRow = 0;\r\nMPEG1.prototype.mbCol = 0;\r\n\r\nMPEG1.prototype.macroblockType = 0;\r\nMPEG1.prototype.macroblockIntra = false;\r\nMPEG1.prototype.macroblockMotFw = false;\r\n\r\nMPEG1.prototype.motionFwH = 0;\r\nMPEG1.prototype.motionFwV = 0;\r\nMPEG1.prototype.motionFwHPrev = 0;\r\nMPEG1.prototype.motionFwVPrev = 0;\r\n\r\nMPEG1.prototype.decodeMacroblock = function() {\r\n\t// Decode macroblock_address_increment\r\n\tvar\r\n\t\tincrement = 0,\r\n\t\tt = this.readHuffman(MPEG1.MACROBLOCK_ADDRESS_INCREMENT);\r\n\r\n\twhile (t === 34) {\r\n\t\t// macroblock_stuffing\r\n\t\tt = this.readHuffman(MPEG1.MACROBLOCK_ADDRESS_INCREMENT);\r\n\t}\r\n\twhile (t === 35) {\r\n\t\t// macroblock_escape\r\n\t\tincrement += 33;\r\n\t\tt = this.readHuffman(MPEG1.MACROBLOCK_ADDRESS_INCREMENT);\r\n\t}\r\n\tincrement += t;\r\n\r\n\t// Process any skipped macroblocks\r\n\tif (this.sliceBegin) {\r\n\t\t// The first macroblock_address_increment of each slice is relative\r\n\t\t// to beginning of the preverious row, not the preverious macroblock\r\n\t\tthis.sliceBegin = false;\r\n\t\tthis.macroblockAddress += increment;\r\n\t}\r\n\telse {\r\n\t\tif (this.macroblockAddress + increment >= this.mbSize) {\r\n\t\t\t// Illegal (too large) macroblock_address_increment\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (increment > 1) {\r\n\t\t\t// Skipped macroblocks reset DC predictors\r\n\t\t\tthis.dcPredictorY  = 128;\r\n\t\t\tthis.dcPredictorCr = 128;\r\n\t\t\tthis.dcPredictorCb = 128;\r\n\r\n\t\t\t// Skipped macroblocks in P-pictures reset motion vectors\r\n\t\t\tif (this.pictureType === MPEG1.PICTURE_TYPE.PREDICTIVE) {\r\n\t\t\t\tthis.motionFwH = this.motionFwHPrev = 0;\r\n\t\t\t\tthis.motionFwV = this.motionFwVPrev = 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Predict skipped macroblocks\r\n\t\twhile (increment > 1) {\r\n\t\t\tthis.macroblockAddress++;\r\n\t\t\tthis.mbRow = (this.macroblockAddress / this.mbWidth)|0;\r\n\t\t\tthis.mbCol = this.macroblockAddress % this.mbWidth;\r\n\t\t\tthis.copyMacroblock(\r\n\t\t\t\tthis.motionFwH, this.motionFwV,\r\n\t\t\t\tthis.forwardY, this.forwardCr, this.forwardCb\r\n\t\t\t);\r\n\t\t\tincrement--;\r\n\t\t}\r\n\t\tthis.macroblockAddress++;\r\n\t}\r\n\tthis.mbRow = (this.macroblockAddress / this.mbWidth)|0;\r\n\tthis.mbCol = this.macroblockAddress % this.mbWidth;\r\n\r\n\t// Process the current macroblock\r\n\tvar mbTable = MPEG1.MACROBLOCK_TYPE[this.pictureType];\r\n\tthis.macroblockType = this.readHuffman(mbTable);\r\n\tthis.macroblockIntra = (this.macroblockType & 0x01);\r\n\tthis.macroblockMotFw = (this.macroblockType & 0x08);\r\n\r\n\t// Quantizer scale\r\n\tif ((this.macroblockType & 0x10) !== 0) {\r\n\t\tthis.quantizerScale = this.bits.read(5);\r\n\t}\r\n\r\n\tif (this.macroblockIntra) {\r\n\t\t// Intra-coded macroblocks reset motion vectors\r\n\t\tthis.motionFwH = this.motionFwHPrev = 0;\r\n\t\tthis.motionFwV = this.motionFwVPrev = 0;\r\n\t}\r\n\telse {\r\n\t\t// Non-intra macroblocks reset DC predictors\r\n\t\tthis.dcPredictorY = 128;\r\n\t\tthis.dcPredictorCr = 128;\r\n\t\tthis.dcPredictorCb = 128;\r\n\r\n\t\tthis.decodeMotionVectors();\r\n\t\tthis.copyMacroblock(\r\n\t\t\tthis.motionFwH, this.motionFwV,\r\n\t\t\tthis.forwardY, this.forwardCr, this.forwardCb\r\n\t\t);\r\n\t}\r\n\r\n\t// Decode blocks\r\n\tvar cbp = ((this.macroblockType & 0x02) !== 0)\r\n\t\t? this.readHuffman(MPEG1.CODE_BLOCK_PATTERN)\r\n\t\t: (this.macroblockIntra ? 0x3f : 0);\r\n\r\n\tfor (var block = 0, mask = 0x20; block < 6; block++) {\r\n\t\tif ((cbp & mask) !== 0) {\r\n\t\t\tthis.decodeBlock(block);\r\n\t\t}\r\n\t\tmask >>= 1;\r\n\t}\r\n};\r\n\r\n\r\nMPEG1.prototype.decodeMotionVectors = function() {\r\n\tvar code, d, r = 0;\r\n\r\n\t// Forward\r\n\tif (this.macroblockMotFw) {\r\n\t\t// Horizontal forward\r\n\t\tcode = this.readHuffman(MPEG1.MOTION);\r\n\t\tif ((code !== 0) && (this.forwardF !== 1)) {\r\n\t\t\tr = this.bits.read(this.forwardRSize);\r\n\t\t\td = ((Math.abs(code) - 1) << this.forwardRSize) + r + 1;\r\n\t\t\tif (code < 0) {\r\n\t\t\t\td = -d;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\td = code;\r\n\t\t}\r\n\r\n\t\tthis.motionFwHPrev += d;\r\n\t\tif (this.motionFwHPrev > (this.forwardF << 4) - 1) {\r\n\t\t\tthis.motionFwHPrev -= this.forwardF << 5;\r\n\t\t}\r\n\t\telse if (this.motionFwHPrev < ((-this.forwardF) << 4)) {\r\n\t\t\tthis.motionFwHPrev += this.forwardF << 5;\r\n\t\t}\r\n\r\n\t\tthis.motionFwH = this.motionFwHPrev;\r\n\t\tif (this.fullPelForward) {\r\n\t\t\tthis.motionFwH <<= 1;\r\n\t\t}\r\n\r\n\t\t// Vertical forward\r\n\t\tcode = this.readHuffman(MPEG1.MOTION);\r\n\t\tif ((code !== 0) && (this.forwardF !== 1)) {\r\n\t\t\tr = this.bits.read(this.forwardRSize);\r\n\t\t\td = ((Math.abs(code) - 1) << this.forwardRSize) + r + 1;\r\n\t\t\tif (code < 0) {\r\n\t\t\t\td = -d;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\td = code;\r\n\t\t}\r\n\r\n\t\tthis.motionFwVPrev += d;\r\n\t\tif (this.motionFwVPrev > (this.forwardF << 4) - 1) {\r\n\t\t\tthis.motionFwVPrev -= this.forwardF << 5;\r\n\t\t}\r\n\t\telse if (this.motionFwVPrev < ((-this.forwardF) << 4)) {\r\n\t\t\tthis.motionFwVPrev += this.forwardF << 5;\r\n\t\t}\r\n\r\n\t\tthis.motionFwV = this.motionFwVPrev;\r\n\t\tif (this.fullPelForward) {\r\n\t\t\tthis.motionFwV <<= 1;\r\n\t\t}\r\n\t}\r\n\telse if (this.pictureType === MPEG1.PICTURE_TYPE.PREDICTIVE) {\r\n\t\t// No motion information in P-picture, reset vectors\r\n\t\tthis.motionFwH = this.motionFwHPrev = 0;\r\n\t\tthis.motionFwV = this.motionFwVPrev = 0;\r\n\t}\r\n};\r\n\r\nMPEG1.prototype.copyMacroblock = function(motionH, motionV, sY, sCr, sCb) {\r\n\tvar\r\n\t\twidth, scan,\r\n\t\tH, V, oddH, oddV,\r\n\t\tsrc, dest, last;\r\n\r\n\t// We use 32bit writes here\r\n\tvar dY = this.currentY32,\r\n\t\tdCb = this.currentCb32,\r\n\t\tdCr = this.currentCr32;\r\n\r\n\t// Luminance\r\n\twidth = this.codedWidth;\r\n\tscan = width - 16;\r\n\r\n\tH = motionH >> 1;\r\n\tV = motionV >> 1;\r\n\toddH = (motionH & 1) === 1;\r\n\toddV = (motionV & 1) === 1;\r\n\r\n\tsrc = ((this.mbRow << 4) + V) * width + (this.mbCol << 4) + H;\r\n\tdest = (this.mbRow * width + this.mbCol) << 2;\r\n\tlast = dest + (width << 2);\r\n\r\n\tvar x, y1, y2, y;\r\n\tif (oddH) {\r\n\t\tif (oddV) {\r\n\t\t\twhile (dest < last) {\r\n\t\t\t\ty1 = sY[src] + sY[src+width]; src++;\r\n\t\t\t\tfor (x = 0; x < 4; x++) {\r\n\t\t\t\t\ty2 = sY[src] + sY[src+width]; src++;\r\n\t\t\t\t\ty = (((y1 + y2 + 2) >> 2) & 0xff);\r\n\r\n\t\t\t\t\ty1 = sY[src] + sY[src+width]; src++;\r\n\t\t\t\t\ty |= (((y1 + y2 + 2) << 6) & 0xff00);\r\n\r\n\t\t\t\t\ty2 = sY[src] + sY[src+width]; src++;\r\n\t\t\t\t\ty |= (((y1 + y2 + 2) << 14) & 0xff0000);\r\n\r\n\t\t\t\t\ty1 = sY[src] + sY[src+width]; src++;\r\n\t\t\t\t\ty |= (((y1 + y2 + 2) << 22) & 0xff000000);\r\n\r\n\t\t\t\t\tdY[dest++] = y;\r\n\t\t\t\t}\r\n\t\t\t\tdest += scan >> 2; src += scan-1;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\twhile (dest < last) {\r\n\t\t\t\ty1 = sY[src++];\r\n\t\t\t\tfor (x = 0; x < 4; x++) {\r\n\t\t\t\t\ty2 = sY[src++];\r\n\t\t\t\t\ty = (((y1 + y2 + 1) >> 1) & 0xff);\r\n\r\n\t\t\t\t\ty1 = sY[src++];\r\n\t\t\t\t\ty |= (((y1 + y2 + 1) << 7) & 0xff00);\r\n\r\n\t\t\t\t\ty2 = sY[src++];\r\n\t\t\t\t\ty |= (((y1 + y2 + 1) << 15) & 0xff0000);\r\n\r\n\t\t\t\t\ty1 = sY[src++];\r\n\t\t\t\t\ty |= (((y1 + y2 + 1) << 23) & 0xff000000);\r\n\r\n\t\t\t\t\tdY[dest++] = y;\r\n\t\t\t\t}\r\n\t\t\t\tdest += scan >> 2; src += scan-1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tif (oddV) {\r\n\t\t\twhile (dest < last) {\r\n\t\t\t\tfor (x = 0; x < 4; x++) {\r\n\t\t\t\t\ty = (((sY[src] + sY[src+width] + 1) >> 1) & 0xff); src++;\r\n\t\t\t\t\ty |= (((sY[src] + sY[src+width] + 1) << 7) & 0xff00); src++;\r\n\t\t\t\t\ty |= (((sY[src] + sY[src+width] + 1) << 15) & 0xff0000); src++;\r\n\t\t\t\t\ty |= (((sY[src] + sY[src+width] + 1) << 23) & 0xff000000); src++;\r\n\r\n\t\t\t\t\tdY[dest++] = y;\r\n\t\t\t\t}\r\n\t\t\t\tdest += scan >> 2; src += scan;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\twhile (dest < last) {\r\n\t\t\t\tfor (x = 0; x < 4; x++) {\r\n\t\t\t\t\ty = sY[src]; src++;\r\n\t\t\t\t\ty |= sY[src] << 8; src++;\r\n\t\t\t\t\ty |= sY[src] << 16; src++;\r\n\t\t\t\t\ty |= sY[src] << 24; src++;\r\n\r\n\t\t\t\t\tdY[dest++] = y;\r\n\t\t\t\t}\r\n\t\t\t\tdest += scan >> 2; src += scan;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Chrominance\r\n\r\n\twidth = this.halfWidth;\r\n\tscan = width - 8;\r\n\r\n\tH = (motionH/2) >> 1;\r\n\tV = (motionV/2) >> 1;\r\n\toddH = ((motionH/2) & 1) === 1;\r\n\toddV = ((motionV/2) & 1) === 1;\r\n\r\n\tsrc = ((this.mbRow << 3) + V) * width + (this.mbCol << 3) + H;\r\n\tdest = (this.mbRow * width + this.mbCol) << 1;\r\n\tlast = dest + (width << 1);\r\n\r\n\tvar cr1, cr2, cr,\r\n\t\tcb1, cb2, cb;\r\n\tif (oddH) {\r\n\t\tif (oddV) {\r\n\t\t\twhile (dest < last) {\r\n\t\t\t\tcr1 = sCr[src] + sCr[src+width];\r\n\t\t\t\tcb1 = sCb[src] + sCb[src+width];\r\n\t\t\t\tsrc++;\r\n\t\t\t\tfor (x = 0; x < 2; x++) {\r\n\t\t\t\t\tcr2 = sCr[src] + sCr[src+width];\r\n\t\t\t\t\tcb2 = sCb[src] + sCb[src+width]; src++;\r\n\t\t\t\t\tcr = (((cr1 + cr2 + 2) >> 2) & 0xff);\r\n\t\t\t\t\tcb = (((cb1 + cb2 + 2) >> 2) & 0xff);\r\n\r\n\t\t\t\t\tcr1 = sCr[src] + sCr[src+width];\r\n\t\t\t\t\tcb1 = sCb[src] + sCb[src+width]; src++;\r\n\t\t\t\t\tcr |= (((cr1 + cr2 + 2) << 6) & 0xff00);\r\n\t\t\t\t\tcb |= (((cb1 + cb2 + 2) << 6) & 0xff00);\r\n\r\n\t\t\t\t\tcr2 = sCr[src] + sCr[src+width];\r\n\t\t\t\t\tcb2 = sCb[src] + sCb[src+width]; src++;\r\n\t\t\t\t\tcr |= (((cr1 + cr2 + 2) << 14) & 0xff0000);\r\n\t\t\t\t\tcb |= (((cb1 + cb2 + 2) << 14) & 0xff0000);\r\n\r\n\t\t\t\t\tcr1 = sCr[src] + sCr[src+width];\r\n\t\t\t\t\tcb1 = sCb[src] + sCb[src+width]; src++;\r\n\t\t\t\t\tcr |= (((cr1 + cr2 + 2) << 22) & 0xff000000);\r\n\t\t\t\t\tcb |= (((cb1 + cb2 + 2) << 22) & 0xff000000);\r\n\r\n\t\t\t\t\tdCr[dest] = cr;\r\n\t\t\t\t\tdCb[dest] = cb;\r\n\t\t\t\t\tdest++;\r\n\t\t\t\t}\r\n\t\t\t\tdest += scan >> 2; src += scan-1;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\twhile (dest < last) {\r\n\t\t\t\tcr1 = sCr[src];\r\n\t\t\t\tcb1 = sCb[src];\r\n\t\t\t\tsrc++;\r\n\t\t\t\tfor (x = 0; x < 2; x++) {\r\n\t\t\t\t\tcr2 = sCr[src];\r\n\t\t\t\t\tcb2 = sCb[src++];\r\n\t\t\t\t\tcr = (((cr1 + cr2 + 1) >> 1) & 0xff);\r\n\t\t\t\t\tcb = (((cb1 + cb2 + 1) >> 1) & 0xff);\r\n\r\n\t\t\t\t\tcr1 = sCr[src];\r\n\t\t\t\t\tcb1 = sCb[src++];\r\n\t\t\t\t\tcr |= (((cr1 + cr2 + 1) << 7) & 0xff00);\r\n\t\t\t\t\tcb |= (((cb1 + cb2 + 1) << 7) & 0xff00);\r\n\r\n\t\t\t\t\tcr2 = sCr[src];\r\n\t\t\t\t\tcb2 = sCb[src++];\r\n\t\t\t\t\tcr |= (((cr1 + cr2 + 1) << 15) & 0xff0000);\r\n\t\t\t\t\tcb |= (((cb1 + cb2 + 1) << 15) & 0xff0000);\r\n\r\n\t\t\t\t\tcr1 = sCr[src];\r\n\t\t\t\t\tcb1 = sCb[src++];\r\n\t\t\t\t\tcr |= (((cr1 + cr2 + 1) << 23) & 0xff000000);\r\n\t\t\t\t\tcb |= (((cb1 + cb2 + 1) << 23) & 0xff000000);\r\n\r\n\t\t\t\t\tdCr[dest] = cr;\r\n\t\t\t\t\tdCb[dest] = cb;\r\n\t\t\t\t\tdest++;\r\n\t\t\t\t}\r\n\t\t\t\tdest += scan >> 2; src += scan-1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tif (oddV) {\r\n\t\t\twhile (dest < last) {\r\n\t\t\t\tfor (x = 0; x < 2; x++) {\r\n\t\t\t\t\tcr = (((sCr[src] + sCr[src+width] + 1) >> 1) & 0xff);\r\n\t\t\t\t\tcb = (((sCb[src] + sCb[src+width] + 1) >> 1) & 0xff); src++;\r\n\r\n\t\t\t\t\tcr |= (((sCr[src] + sCr[src+width] + 1) << 7) & 0xff00);\r\n\t\t\t\t\tcb |= (((sCb[src] + sCb[src+width] + 1) << 7) & 0xff00); src++;\r\n\r\n\t\t\t\t\tcr |= (((sCr[src] + sCr[src+width] + 1) << 15) & 0xff0000);\r\n\t\t\t\t\tcb |= (((sCb[src] + sCb[src+width] + 1) << 15) & 0xff0000); src++;\r\n\r\n\t\t\t\t\tcr |= (((sCr[src] + sCr[src+width] + 1) << 23) & 0xff000000);\r\n\t\t\t\t\tcb |= (((sCb[src] + sCb[src+width] + 1) << 23) & 0xff000000); src++;\r\n\r\n\t\t\t\t\tdCr[dest] = cr;\r\n\t\t\t\t\tdCb[dest] = cb;\r\n\t\t\t\t\tdest++;\r\n\t\t\t\t}\r\n\t\t\t\tdest += scan >> 2; src += scan;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\twhile (dest < last) {\r\n\t\t\t\tfor (x = 0; x < 2; x++) {\r\n\t\t\t\t\tcr = sCr[src];\r\n\t\t\t\t\tcb = sCb[src]; src++;\r\n\r\n\t\t\t\t\tcr |= sCr[src] << 8;\r\n\t\t\t\t\tcb |= sCb[src] << 8; src++;\r\n\r\n\t\t\t\t\tcr |= sCr[src] << 16;\r\n\t\t\t\t\tcb |= sCb[src] << 16; src++;\r\n\r\n\t\t\t\t\tcr |= sCr[src] << 24;\r\n\t\t\t\t\tcb |= sCb[src] << 24; src++;\r\n\r\n\t\t\t\t\tdCr[dest] = cr;\r\n\t\t\t\t\tdCb[dest] = cb;\r\n\t\t\t\t\tdest++;\r\n\t\t\t\t}\r\n\t\t\t\tdest += scan >> 2; src += scan;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\n\r\n// Block layer\r\n\r\nMPEG1.prototype.dcPredictorY = 0;\r\nMPEG1.prototype.dcPredictorCr = 0;\r\nMPEG1.prototype.dcPredictorCb = 0;\r\n\r\nMPEG1.prototype.blockData = null;\r\n\r\nMPEG1.prototype.decodeBlock = function(block) {\r\n\r\n\tvar\r\n\t\tn = 0,\r\n\t\tquantMatrix;\r\n\r\n\t// Decode DC coefficient of intra-coded blocks\r\n\tif (this.macroblockIntra) {\r\n\t\tvar\r\n\t\t\tpredictor,\r\n\t\t\tdctSize;\r\n\r\n\t\t// DC prediction\r\n\r\n\t\tif (block < 4) {\r\n\t\t\tpredictor = this.dcPredictorY;\r\n\t\t\tdctSize = this.readHuffman(MPEG1.DCT_DC_SIZE_LUMINANCE);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpredictor = (block === 4 ? this.dcPredictorCr : this.dcPredictorCb);\r\n\t\t\tdctSize = this.readHuffman(MPEG1.DCT_DC_SIZE_CHROMINANCE);\r\n\t\t}\r\n\r\n\t\t// Read DC coeff\r\n\t\tif (dctSize > 0) {\r\n\t\t\tvar differential = this.bits.read(dctSize);\r\n\t\t\tif ((differential & (1 << (dctSize - 1))) !== 0) {\r\n\t\t\t\tthis.blockData[0] = predictor + differential;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.blockData[0] = predictor + ((-1 << dctSize)|(differential+1));\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.blockData[0] = predictor;\r\n\t\t}\r\n\r\n\t\t// Save predictor value\r\n\t\tif (block < 4) {\r\n\t\t\tthis.dcPredictorY = this.blockData[0];\r\n\t\t}\r\n\t\telse if (block === 4) {\r\n\t\t\tthis.dcPredictorCr = this.blockData[0];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.dcPredictorCb = this.blockData[0];\r\n\t\t}\r\n\r\n\t\t// Dequantize + premultiply\r\n\t\tthis.blockData[0] <<= (3 + 5);\r\n\r\n\t\tquantMatrix = this.intraQuantMatrix;\r\n\t\tn = 1;\r\n\t}\r\n\telse {\r\n\t\tquantMatrix = this.nonIntraQuantMatrix;\r\n\t}\r\n\r\n\t// Decode AC coefficients (+DC for non-intra)\r\n\tvar level = 0;\r\n\twhile (true) {\r\n\t\tvar\r\n\t\t\trun = 0,\r\n\t\t\tcoeff = this.readHuffman(MPEG1.DCT_COEFF);\r\n\r\n\t\tif ((coeff === 0x0001) && (n > 0) && (this.bits.read(1) === 0)) {\r\n\t\t\t// end_of_block\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tif (coeff === 0xffff) {\r\n\t\t\t// escape\r\n\t\t\trun = this.bits.read(6);\r\n\t\t\tlevel = this.bits.read(8);\r\n\t\t\tif (level === 0) {\r\n\t\t\t\tlevel = this.bits.read(8);\r\n\t\t\t}\r\n\t\t\telse if (level === 128) {\r\n\t\t\t\tlevel = this.bits.read(8) - 256;\r\n\t\t\t}\r\n\t\t\telse if (level > 128) {\r\n\t\t\t\tlevel = level - 256;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\trun = coeff >> 8;\r\n\t\t\tlevel = coeff & 0xff;\r\n\t\t\tif (this.bits.read(1)) {\r\n\t\t\t\tlevel = -level;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tn += run;\r\n\t\tvar dezigZagged = MPEG1.ZIG_ZAG[n];\r\n\t\tn++;\r\n\r\n\t\t// Dequantize, oddify, clip\r\n\t\tlevel <<= 1;\r\n\t\tif (!this.macroblockIntra) {\r\n\t\t\tlevel += (level < 0 ? -1 : 1);\r\n\t\t}\r\n\t\tlevel = (level * this.quantizerScale * quantMatrix[dezigZagged]) >> 4;\r\n\t\tif ((level & 1) === 0) {\r\n\t\t\tlevel -= level > 0 ? 1 : -1;\r\n\t\t}\r\n\t\tif (level > 2047) {\r\n\t\t\tlevel = 2047;\r\n\t\t}\r\n\t\telse if (level < -2048) {\r\n\t\t\tlevel = -2048;\r\n\t\t}\r\n\r\n\t\t// Save premultiplied coefficient\r\n\t\tthis.blockData[dezigZagged] = level * MPEG1.PREMULTIPLIER_MATRIX[dezigZagged];\r\n\t}\r\n\r\n\t// Move block to its place\r\n\tvar\r\n\t\tdestArray,\r\n\t\tdestIndex,\r\n\t\tscan;\r\n\r\n\tif (block < 4) {\r\n\t\tdestArray = this.currentY;\r\n\t\tscan = this.codedWidth - 8;\r\n\t\tdestIndex = (this.mbRow * this.codedWidth + this.mbCol) << 4;\r\n\t\tif ((block & 1) !== 0) {\r\n\t\t\tdestIndex += 8;\r\n\t\t}\r\n\t\tif ((block & 2) !== 0) {\r\n\t\t\tdestIndex += this.codedWidth << 3;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tdestArray = (block === 4) ? this.currentCb : this.currentCr;\r\n\t\tscan = (this.codedWidth >> 1) - 8;\r\n\t\tdestIndex = ((this.mbRow * this.codedWidth) << 2) + (this.mbCol << 3);\r\n\t}\r\n\r\n\tif (this.macroblockIntra) {\r\n\t\t// Overwrite (no prediction)\r\n\t\tif (n === 1) {\r\n\t\t\tMPEG1.CopyValueToDestination((this.blockData[0] + 128) >> 8, destArray, destIndex, scan);\r\n\t\t\tthis.blockData[0] = 0;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tMPEG1.IDCT(this.blockData);\r\n\t\t\tMPEG1.CopyBlockToDestination(this.blockData, destArray, destIndex, scan);\r\n\t\t\tFill(this.blockData, 0);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\t// Add data to the predicted macroblock\r\n\t\tif (n === 1) {\r\n\t\t\tMPEG1.AddValueToDestination((this.blockData[0] + 128) >> 8, destArray, destIndex, scan);\r\n\t\t\tthis.blockData[0] = 0;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tMPEG1.IDCT(this.blockData);\r\n\t\t\tMPEG1.AddBlockToDestination(this.blockData, destArray, destIndex, scan);\r\n\t\t\tFill(this.blockData, 0);\r\n\t\t}\r\n\t}\r\n\r\n\tn = 0;\r\n};\r\n\r\nMPEG1.CopyBlockToDestination = function(block, dest, index, scan) {\r\n\tfor (var n = 0; n < 64; n += 8, index += scan+8) {\r\n\t\tdest[index+0] = block[n+0];\r\n\t\tdest[index+1] = block[n+1];\r\n\t\tdest[index+2] = block[n+2];\r\n\t\tdest[index+3] = block[n+3];\r\n\t\tdest[index+4] = block[n+4];\r\n\t\tdest[index+5] = block[n+5];\r\n\t\tdest[index+6] = block[n+6];\r\n\t\tdest[index+7] = block[n+7];\r\n\t}\r\n};\r\n\r\nMPEG1.AddBlockToDestination = function(block, dest, index, scan) {\r\n\tfor (var n = 0; n < 64; n += 8, index += scan+8) {\r\n\t\tdest[index+0] += block[n+0];\r\n\t\tdest[index+1] += block[n+1];\r\n\t\tdest[index+2] += block[n+2];\r\n\t\tdest[index+3] += block[n+3];\r\n\t\tdest[index+4] += block[n+4];\r\n\t\tdest[index+5] += block[n+5];\r\n\t\tdest[index+6] += block[n+6];\r\n\t\tdest[index+7] += block[n+7];\r\n\t}\r\n};\r\n\r\nMPEG1.CopyValueToDestination = function(value, dest, index, scan) {\r\n\tfor (var n = 0; n < 64; n += 8, index += scan+8) {\r\n\t\tdest[index+0] = value;\r\n\t\tdest[index+1] = value;\r\n\t\tdest[index+2] = value;\r\n\t\tdest[index+3] = value;\r\n\t\tdest[index+4] = value;\r\n\t\tdest[index+5] = value;\r\n\t\tdest[index+6] = value;\r\n\t\tdest[index+7] = value;\r\n\t}\r\n};\r\n\r\nMPEG1.AddValueToDestination = function(value, dest, index, scan) {\r\n\tfor (var n = 0; n < 64; n += 8, index += scan+8) {\r\n\t\tdest[index+0] += value;\r\n\t\tdest[index+1] += value;\r\n\t\tdest[index+2] += value;\r\n\t\tdest[index+3] += value;\r\n\t\tdest[index+4] += value;\r\n\t\tdest[index+5] += value;\r\n\t\tdest[index+6] += value;\r\n\t\tdest[index+7] += value;\r\n\t}\r\n};\r\n\r\nMPEG1.IDCT = function(block) {\r\n\t// See http://vsr.informatik.tu-chemnitz.de/~jan/MPEG/HTML/IDCT.html\r\n\t// for more info.\r\n\r\n\tvar\r\n\t\tb1, b3, b4, b6, b7, tmp1, tmp2, m0,\r\n\t\tx0, x1, x2, x3, x4, y3, y4, y5, y6, y7;\r\n\r\n\t// Transform columns\r\n\tfor (var i = 0; i < 8; ++i) {\r\n\t\tb1 = block[4*8+i];\r\n\t\tb3 = block[2*8+i] + block[6*8+i];\r\n\t\tb4 = block[5*8+i] - block[3*8+i];\r\n\t\ttmp1 = block[1*8+i] + block[7*8+i];\r\n\t\ttmp2 = block[3*8+i] + block[5*8+i];\r\n\t\tb6 = block[1*8+i] - block[7*8+i];\r\n\t\tb7 = tmp1 + tmp2;\r\n\t\tm0 = block[0*8+i];\r\n\t\tx4 = ((b6*473 - b4*196 + 128) >> 8) - b7;\r\n\t\tx0 = x4 - (((tmp1 - tmp2)*362 + 128) >> 8);\r\n\t\tx1 = m0 - b1;\r\n\t\tx2 = (((block[2*8+i] - block[6*8+i])*362 + 128) >> 8) - b3;\r\n\t\tx3 = m0 + b1;\r\n\t\ty3 = x1 + x2;\r\n\t\ty4 = x3 + b3;\r\n\t\ty5 = x1 - x2;\r\n\t\ty6 = x3 - b3;\r\n\t\ty7 = -x0 - ((b4*473 + b6*196 + 128) >> 8);\r\n\t\tblock[0*8+i] = b7 + y4;\r\n\t\tblock[1*8+i] = x4 + y3;\r\n\t\tblock[2*8+i] = y5 - x0;\r\n\t\tblock[3*8+i] = y6 - y7;\r\n\t\tblock[4*8+i] = y6 + y7;\r\n\t\tblock[5*8+i] = x0 + y5;\r\n\t\tblock[6*8+i] = y3 - x4;\r\n\t\tblock[7*8+i] = y4 - b7;\r\n\t}\r\n\r\n\t// Transform rows\r\n\tfor (var i = 0; i < 64; i += 8) {\r\n\t\tb1 = block[4+i];\r\n\t\tb3 = block[2+i] + block[6+i];\r\n\t\tb4 = block[5+i] - block[3+i];\r\n\t\ttmp1 = block[1+i] + block[7+i];\r\n\t\ttmp2 = block[3+i] + block[5+i];\r\n\t\tb6 = block[1+i] - block[7+i];\r\n\t\tb7 = tmp1 + tmp2;\r\n\t\tm0 = block[0+i];\r\n\t\tx4 = ((b6*473 - b4*196 + 128) >> 8) - b7;\r\n\t\tx0 = x4 - (((tmp1 - tmp2)*362 + 128) >> 8);\r\n\t\tx1 = m0 - b1;\r\n\t\tx2 = (((block[2+i] - block[6+i])*362 + 128) >> 8) - b3;\r\n\t\tx3 = m0 + b1;\r\n\t\ty3 = x1 + x2;\r\n\t\ty4 = x3 + b3;\r\n\t\ty5 = x1 - x2;\r\n\t\ty6 = x3 - b3;\r\n\t\ty7 = -x0 - ((b4*473 + b6*196 + 128) >> 8);\r\n\t\tblock[0+i] = (b7 + y4 + 128) >> 8;\r\n\t\tblock[1+i] = (x4 + y3 + 128) >> 8;\r\n\t\tblock[2+i] = (y5 - x0 + 128) >> 8;\r\n\t\tblock[3+i] = (y6 - y7 + 128) >> 8;\r\n\t\tblock[4+i] = (y6 + y7 + 128) >> 8;\r\n\t\tblock[5+i] = (x0 + y5 + 128) >> 8;\r\n\t\tblock[6+i] = (y3 - x4 + 128) >> 8;\r\n\t\tblock[7+i] = (y4 - b7 + 128) >> 8;\r\n\t}\r\n};\r\n\r\n\r\n// VLC Tables and Constants\r\n\r\nMPEG1.PICTURE_RATE = [\r\n\t0.000, 23.976, 24.000, 25.000, 29.970, 30.000, 50.000, 59.940,\r\n\t60.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000\r\n];\r\n\r\nMPEG1.ZIG_ZAG = new Uint8Array([\r\n\t 0,  1,  8, 16,  9,  2,  3, 10,\r\n\t17, 24, 32, 25, 18, 11,  4,  5,\r\n\t12, 19, 26, 33, 40, 48, 41, 34,\r\n\t27, 20, 13,  6,  7, 14, 21, 28,\r\n\t35, 42, 49, 56, 57, 50, 43, 36,\r\n\t29, 22, 15, 23, 30, 37, 44, 51,\r\n\t58, 59, 52, 45, 38, 31, 39, 46,\r\n\t53, 60, 61, 54, 47, 55, 62, 63\r\n]);\r\n\r\nMPEG1.DEFAULT_INTRA_QUANT_MATRIX = new Uint8Array([\r\n\t 8, 16, 19, 22, 26, 27, 29, 34,\r\n\t16, 16, 22, 24, 27, 29, 34, 37,\r\n\t19, 22, 26, 27, 29, 34, 34, 38,\r\n\t22, 22, 26, 27, 29, 34, 37, 40,\r\n\t22, 26, 27, 29, 32, 35, 40, 48,\r\n\t26, 27, 29, 32, 35, 40, 48, 58,\r\n\t26, 27, 29, 34, 38, 46, 56, 69,\r\n\t27, 29, 35, 38, 46, 56, 69, 83\r\n]);\r\n\r\nMPEG1.DEFAULT_NON_INTRA_QUANT_MATRIX = new Uint8Array([\r\n\t16, 16, 16, 16, 16, 16, 16, 16,\r\n\t16, 16, 16, 16, 16, 16, 16, 16,\r\n\t16, 16, 16, 16, 16, 16, 16, 16,\r\n\t16, 16, 16, 16, 16, 16, 16, 16,\r\n\t16, 16, 16, 16, 16, 16, 16, 16,\r\n\t16, 16, 16, 16, 16, 16, 16, 16,\r\n\t16, 16, 16, 16, 16, 16, 16, 16,\r\n\t16, 16, 16, 16, 16, 16, 16, 16\r\n]);\r\n\r\nMPEG1.PREMULTIPLIER_MATRIX = new Uint8Array([\r\n\t32, 44, 42, 38, 32, 25, 17,  9,\r\n\t44, 62, 58, 52, 44, 35, 24, 12,\r\n\t42, 58, 55, 49, 42, 33, 23, 12,\r\n\t38, 52, 49, 44, 38, 30, 20, 10,\r\n\t32, 44, 42, 38, 32, 25, 17,  9,\r\n\t25, 35, 33, 30, 25, 20, 14,  7,\r\n\t17, 24, 23, 20, 17, 14,  9,  5,\r\n\t 9, 12, 12, 10,  9,  7,  5,  2\r\n]);\r\n\r\n// MPEG-1 VLC\r\n\r\n//  macroblock_stuffing decodes as 34.\r\n//  macroblock_escape decodes as 35.\r\n\r\nMPEG1.MACROBLOCK_ADDRESS_INCREMENT = new Int16Array([\r\n\t 1*3,  2*3,  0, //   0\r\n\t 3*3,  4*3,  0, //   1  0\r\n\t   0,    0,  1, //   2  1.\r\n\t 5*3,  6*3,  0, //   3  00\r\n\t 7*3,  8*3,  0, //   4  01\r\n\t 9*3, 10*3,  0, //   5  000\r\n\t11*3, 12*3,  0, //   6  001\r\n\t   0,    0,  3, //   7  010.\r\n\t   0,    0,  2, //   8  011.\r\n\t13*3, 14*3,  0, //   9  0000\r\n\t15*3, 16*3,  0, //  10  0001\r\n\t   0,    0,  5, //  11  0010.\r\n\t   0,    0,  4, //  12  0011.\r\n\t17*3, 18*3,  0, //  13  0000 0\r\n\t19*3, 20*3,  0, //  14  0000 1\r\n\t   0,    0,  7, //  15  0001 0.\r\n\t   0,    0,  6, //  16  0001 1.\r\n\t21*3, 22*3,  0, //  17  0000 00\r\n\t23*3, 24*3,  0, //  18  0000 01\r\n\t25*3, 26*3,  0, //  19  0000 10\r\n\t27*3, 28*3,  0, //  20  0000 11\r\n\t  -1, 29*3,  0, //  21  0000 000\r\n\t  -1, 30*3,  0, //  22  0000 001\r\n\t31*3, 32*3,  0, //  23  0000 010\r\n\t33*3, 34*3,  0, //  24  0000 011\r\n\t35*3, 36*3,  0, //  25  0000 100\r\n\t37*3, 38*3,  0, //  26  0000 101\r\n\t   0,    0,  9, //  27  0000 110.\r\n\t   0,    0,  8, //  28  0000 111.\r\n\t39*3, 40*3,  0, //  29  0000 0001\r\n\t41*3, 42*3,  0, //  30  0000 0011\r\n\t43*3, 44*3,  0, //  31  0000 0100\r\n\t45*3, 46*3,  0, //  32  0000 0101\r\n\t   0,    0, 15, //  33  0000 0110.\r\n\t   0,    0, 14, //  34  0000 0111.\r\n\t   0,    0, 13, //  35  0000 1000.\r\n\t   0,    0, 12, //  36  0000 1001.\r\n\t   0,    0, 11, //  37  0000 1010.\r\n\t   0,    0, 10, //  38  0000 1011.\r\n\t47*3,   -1,  0, //  39  0000 0001 0\r\n\t  -1, 48*3,  0, //  40  0000 0001 1\r\n\t49*3, 50*3,  0, //  41  0000 0011 0\r\n\t51*3, 52*3,  0, //  42  0000 0011 1\r\n\t53*3, 54*3,  0, //  43  0000 0100 0\r\n\t55*3, 56*3,  0, //  44  0000 0100 1\r\n\t57*3, 58*3,  0, //  45  0000 0101 0\r\n\t59*3, 60*3,  0, //  46  0000 0101 1\r\n\t61*3,   -1,  0, //  47  0000 0001 00\r\n\t  -1, 62*3,  0, //  48  0000 0001 11\r\n\t63*3, 64*3,  0, //  49  0000 0011 00\r\n\t65*3, 66*3,  0, //  50  0000 0011 01\r\n\t67*3, 68*3,  0, //  51  0000 0011 10\r\n\t69*3, 70*3,  0, //  52  0000 0011 11\r\n\t71*3, 72*3,  0, //  53  0000 0100 00\r\n\t73*3, 74*3,  0, //  54  0000 0100 01\r\n\t   0,    0, 21, //  55  0000 0100 10.\r\n\t   0,    0, 20, //  56  0000 0100 11.\r\n\t   0,    0, 19, //  57  0000 0101 00.\r\n\t   0,    0, 18, //  58  0000 0101 01.\r\n\t   0,    0, 17, //  59  0000 0101 10.\r\n\t   0,    0, 16, //  60  0000 0101 11.\r\n\t   0,    0, 35, //  61  0000 0001 000. -- macroblock_escape\r\n\t   0,    0, 34, //  62  0000 0001 111. -- macroblock_stuffing\r\n\t   0,    0, 33, //  63  0000 0011 000.\r\n\t   0,    0, 32, //  64  0000 0011 001.\r\n\t   0,    0, 31, //  65  0000 0011 010.\r\n\t   0,    0, 30, //  66  0000 0011 011.\r\n\t   0,    0, 29, //  67  0000 0011 100.\r\n\t   0,    0, 28, //  68  0000 0011 101.\r\n\t   0,    0, 27, //  69  0000 0011 110.\r\n\t   0,    0, 26, //  70  0000 0011 111.\r\n\t   0,    0, 25, //  71  0000 0100 000.\r\n\t   0,    0, 24, //  72  0000 0100 001.\r\n\t   0,    0, 23, //  73  0000 0100 010.\r\n\t   0,    0, 22  //  74  0000 0100 011.\r\n]);\r\n\r\n//  macroblock_type bitmap:\r\n//    0x10  macroblock_quant\r\n//    0x08  macroblock_motion_forward\r\n//    0x04  macroblock_motion_backward\r\n//    0x02  macrobkock_pattern\r\n//    0x01  macroblock_intra\r\n//\r\n\r\nMPEG1.MACROBLOCK_TYPE_INTRA = new Int8Array([\r\n\t 1*3,  2*3,     0, //   0\r\n\t  -1,  3*3,     0, //   1  0\r\n\t   0,    0,  0x01, //   2  1.\r\n\t   0,    0,  0x11  //   3  01.\r\n]);\r\n\r\nMPEG1.MACROBLOCK_TYPE_PREDICTIVE = new Int8Array([\r\n\t 1*3,  2*3,     0, //  0\r\n\t 3*3,  4*3,     0, //  1  0\r\n\t   0,    0,  0x0a, //  2  1.\r\n\t 5*3,  6*3,     0, //  3  00\r\n\t   0,    0,  0x02, //  4  01.\r\n\t 7*3,  8*3,     0, //  5  000\r\n\t   0,    0,  0x08, //  6  001.\r\n\t 9*3, 10*3,     0, //  7  0000\r\n\t11*3, 12*3,     0, //  8  0001\r\n\t  -1, 13*3,     0, //  9  00000\r\n\t   0,    0,  0x12, // 10  00001.\r\n\t   0,    0,  0x1a, // 11  00010.\r\n\t   0,    0,  0x01, // 12  00011.\r\n\t   0,    0,  0x11  // 13  000001.\r\n]);\r\n\r\nMPEG1.MACROBLOCK_TYPE_B = new Int8Array([\r\n\t 1*3,  2*3,     0,  //  0\r\n\t 3*3,  5*3,     0,  //  1  0\r\n\t 4*3,  6*3,     0,  //  2  1\r\n\t 8*3,  7*3,     0,  //  3  00\r\n\t   0,    0,  0x0c,  //  4  10.\r\n\t 9*3, 10*3,     0,  //  5  01\r\n\t   0,    0,  0x0e,  //  6  11.\r\n\t13*3, 14*3,     0,  //  7  001\r\n\t12*3, 11*3,     0,  //  8  000\r\n\t   0,    0,  0x04,  //  9  010.\r\n\t   0,    0,  0x06,  // 10  011.\r\n\t18*3, 16*3,     0,  // 11  0001\r\n\t15*3, 17*3,     0,  // 12  0000\r\n\t   0,    0,  0x08,  // 13  0010.\r\n\t   0,    0,  0x0a,  // 14  0011.\r\n\t  -1, 19*3,     0,  // 15  00000\r\n\t   0,    0,  0x01,  // 16  00011.\r\n\t20*3, 21*3,     0,  // 17  00001\r\n\t   0,    0,  0x1e,  // 18  00010.\r\n\t   0,    0,  0x11,  // 19  000001.\r\n\t   0,    0,  0x16,  // 20  000010.\r\n\t   0,    0,  0x1a   // 21  000011.\r\n]);\r\n\r\nMPEG1.MACROBLOCK_TYPE = [\r\n\tnull,\r\n\tMPEG1.MACROBLOCK_TYPE_INTRA,\r\n\tMPEG1.MACROBLOCK_TYPE_PREDICTIVE,\r\n\tMPEG1.MACROBLOCK_TYPE_B\r\n];\r\n\r\nMPEG1.CODE_BLOCK_PATTERN = new Int16Array([\r\n\t  2*3,   1*3,   0,  //   0\r\n\t  3*3,   6*3,   0,  //   1  1\r\n\t  4*3,   5*3,   0,  //   2  0\r\n\t  8*3,  11*3,   0,  //   3  10\r\n\t 12*3,  13*3,   0,  //   4  00\r\n\t  9*3,   7*3,   0,  //   5  01\r\n\t 10*3,  14*3,   0,  //   6  11\r\n\t 20*3,  19*3,   0,  //   7  011\r\n\t 18*3,  16*3,   0,  //   8  100\r\n\t 23*3,  17*3,   0,  //   9  010\r\n\t 27*3,  25*3,   0,  //  10  110\r\n\t 21*3,  28*3,   0,  //  11  101\r\n\t 15*3,  22*3,   0,  //  12  000\r\n\t 24*3,  26*3,   0,  //  13  001\r\n\t    0,     0,  60,  //  14  111.\r\n\t 35*3,  40*3,   0,  //  15  0000\r\n\t 44*3,  48*3,   0,  //  16  1001\r\n\t 38*3,  36*3,   0,  //  17  0101\r\n\t 42*3,  47*3,   0,  //  18  1000\r\n\t 29*3,  31*3,   0,  //  19  0111\r\n\t 39*3,  32*3,   0,  //  20  0110\r\n\t    0,     0,  32,  //  21  1010.\r\n\t 45*3,  46*3,   0,  //  22  0001\r\n\t 33*3,  41*3,   0,  //  23  0100\r\n\t 43*3,  34*3,   0,  //  24  0010\r\n\t    0,     0,   4,  //  25  1101.\r\n\t 30*3,  37*3,   0,  //  26  0011\r\n\t    0,     0,   8,  //  27  1100.\r\n\t    0,     0,  16,  //  28  1011.\r\n\t    0,     0,  44,  //  29  0111 0.\r\n\t 50*3,  56*3,   0,  //  30  0011 0\r\n\t    0,     0,  28,  //  31  0111 1.\r\n\t    0,     0,  52,  //  32  0110 1.\r\n\t    0,     0,  62,  //  33  0100 0.\r\n\t 61*3,  59*3,   0,  //  34  0010 1\r\n\t 52*3,  60*3,   0,  //  35  0000 0\r\n\t    0,     0,   1,  //  36  0101 1.\r\n\t 55*3,  54*3,   0,  //  37  0011 1\r\n\t    0,     0,  61,  //  38  0101 0.\r\n\t    0,     0,  56,  //  39  0110 0.\r\n\t 57*3,  58*3,   0,  //  40  0000 1\r\n\t    0,     0,   2,  //  41  0100 1.\r\n\t    0,     0,  40,  //  42  1000 0.\r\n\t 51*3,  62*3,   0,  //  43  0010 0\r\n\t    0,     0,  48,  //  44  1001 0.\r\n\t 64*3,  63*3,   0,  //  45  0001 0\r\n\t 49*3,  53*3,   0,  //  46  0001 1\r\n\t    0,     0,  20,  //  47  1000 1.\r\n\t    0,     0,  12,  //  48  1001 1.\r\n\t 80*3,  83*3,   0,  //  49  0001 10\r\n\t    0,     0,  63,  //  50  0011 00.\r\n\t 77*3,  75*3,   0,  //  51  0010 00\r\n\t 65*3,  73*3,   0,  //  52  0000 00\r\n\t 84*3,  66*3,   0,  //  53  0001 11\r\n\t    0,     0,  24,  //  54  0011 11.\r\n\t    0,     0,  36,  //  55  0011 10.\r\n\t    0,     0,   3,  //  56  0011 01.\r\n\t 69*3,  87*3,   0,  //  57  0000 10\r\n\t 81*3,  79*3,   0,  //  58  0000 11\r\n\t 68*3,  71*3,   0,  //  59  0010 11\r\n\t 70*3,  78*3,   0,  //  60  0000 01\r\n\t 67*3,  76*3,   0,  //  61  0010 10\r\n\t 72*3,  74*3,   0,  //  62  0010 01\r\n\t 86*3,  85*3,   0,  //  63  0001 01\r\n\t 88*3,  82*3,   0,  //  64  0001 00\r\n\t   -1,  94*3,   0,  //  65  0000 000\r\n\t 95*3,  97*3,   0,  //  66  0001 111\r\n\t    0,     0,  33,  //  67  0010 100.\r\n\t    0,     0,   9,  //  68  0010 110.\r\n\t106*3, 110*3,   0,  //  69  0000 100\r\n\t102*3, 116*3,   0,  //  70  0000 010\r\n\t    0,     0,   5,  //  71  0010 111.\r\n\t    0,     0,  10,  //  72  0010 010.\r\n\t 93*3,  89*3,   0,  //  73  0000 001\r\n\t    0,     0,   6,  //  74  0010 011.\r\n\t    0,     0,  18,  //  75  0010 001.\r\n\t    0,     0,  17,  //  76  0010 101.\r\n\t    0,     0,  34,  //  77  0010 000.\r\n\t113*3, 119*3,   0,  //  78  0000 011\r\n\t103*3, 104*3,   0,  //  79  0000 111\r\n\t 90*3,  92*3,   0,  //  80  0001 100\r\n\t109*3, 107*3,   0,  //  81  0000 110\r\n\t117*3, 118*3,   0,  //  82  0001 001\r\n\t101*3,  99*3,   0,  //  83  0001 101\r\n\t 98*3,  96*3,   0,  //  84  0001 110\r\n\t100*3,  91*3,   0,  //  85  0001 011\r\n\t114*3, 115*3,   0,  //  86  0001 010\r\n\t105*3, 108*3,   0,  //  87  0000 101\r\n\t112*3, 111*3,   0,  //  88  0001 000\r\n\t121*3, 125*3,   0,  //  89  0000 0011\r\n\t    0,     0,  41,  //  90  0001 1000.\r\n\t    0,     0,  14,  //  91  0001 0111.\r\n\t    0,     0,  21,  //  92  0001 1001.\r\n\t124*3, 122*3,   0,  //  93  0000 0010\r\n\t120*3, 123*3,   0,  //  94  0000 0001\r\n\t    0,     0,  11,  //  95  0001 1110.\r\n\t    0,     0,  19,  //  96  0001 1101.\r\n\t    0,     0,   7,  //  97  0001 1111.\r\n\t    0,     0,  35,  //  98  0001 1100.\r\n\t    0,     0,  13,  //  99  0001 1011.\r\n\t    0,     0,  50,  // 100  0001 0110.\r\n\t    0,     0,  49,  // 101  0001 1010.\r\n\t    0,     0,  58,  // 102  0000 0100.\r\n\t    0,     0,  37,  // 103  0000 1110.\r\n\t    0,     0,  25,  // 104  0000 1111.\r\n\t    0,     0,  45,  // 105  0000 1010.\r\n\t    0,     0,  57,  // 106  0000 1000.\r\n\t    0,     0,  26,  // 107  0000 1101.\r\n\t    0,     0,  29,  // 108  0000 1011.\r\n\t    0,     0,  38,  // 109  0000 1100.\r\n\t    0,     0,  53,  // 110  0000 1001.\r\n\t    0,     0,  23,  // 111  0001 0001.\r\n\t    0,     0,  43,  // 112  0001 0000.\r\n\t    0,     0,  46,  // 113  0000 0110.\r\n\t    0,     0,  42,  // 114  0001 0100.\r\n\t    0,     0,  22,  // 115  0001 0101.\r\n\t    0,     0,  54,  // 116  0000 0101.\r\n\t    0,     0,  51,  // 117  0001 0010.\r\n\t    0,     0,  15,  // 118  0001 0011.\r\n\t    0,     0,  30,  // 119  0000 0111.\r\n\t    0,     0,  39,  // 120  0000 0001 0.\r\n\t    0,     0,  47,  // 121  0000 0011 0.\r\n\t    0,     0,  55,  // 122  0000 0010 1.\r\n\t    0,     0,  27,  // 123  0000 0001 1.\r\n\t    0,     0,  59,  // 124  0000 0010 0.\r\n\t    0,     0,  31   // 125  0000 0011 1.\r\n]);\r\n\r\nMPEG1.MOTION = new Int16Array([\r\n\t  1*3,   2*3,   0,  //   0\r\n\t  4*3,   3*3,   0,  //   1  0\r\n\t    0,     0,   0,  //   2  1.\r\n\t  6*3,   5*3,   0,  //   3  01\r\n\t  8*3,   7*3,   0,  //   4  00\r\n\t    0,     0,  -1,  //   5  011.\r\n\t    0,     0,   1,  //   6  010.\r\n\t  9*3,  10*3,   0,  //   7  001\r\n\t 12*3,  11*3,   0,  //   8  000\r\n\t    0,     0,   2,  //   9  0010.\r\n\t    0,     0,  -2,  //  10  0011.\r\n\t 14*3,  15*3,   0,  //  11  0001\r\n\t 16*3,  13*3,   0,  //  12  0000\r\n\t 20*3,  18*3,   0,  //  13  0000 1\r\n\t    0,     0,   3,  //  14  0001 0.\r\n\t    0,     0,  -3,  //  15  0001 1.\r\n\t 17*3,  19*3,   0,  //  16  0000 0\r\n\t   -1,  23*3,   0,  //  17  0000 00\r\n\t 27*3,  25*3,   0,  //  18  0000 11\r\n\t 26*3,  21*3,   0,  //  19  0000 01\r\n\t 24*3,  22*3,   0,  //  20  0000 10\r\n\t 32*3,  28*3,   0,  //  21  0000 011\r\n\t 29*3,  31*3,   0,  //  22  0000 101\r\n\t   -1,  33*3,   0,  //  23  0000 001\r\n\t 36*3,  35*3,   0,  //  24  0000 100\r\n\t    0,     0,  -4,  //  25  0000 111.\r\n\t 30*3,  34*3,   0,  //  26  0000 010\r\n\t    0,     0,   4,  //  27  0000 110.\r\n\t    0,     0,  -7,  //  28  0000 0111.\r\n\t    0,     0,   5,  //  29  0000 1010.\r\n\t 37*3,  41*3,   0,  //  30  0000 0100\r\n\t    0,     0,  -5,  //  31  0000 1011.\r\n\t    0,     0,   7,  //  32  0000 0110.\r\n\t 38*3,  40*3,   0,  //  33  0000 0011\r\n\t 42*3,  39*3,   0,  //  34  0000 0101\r\n\t    0,     0,  -6,  //  35  0000 1001.\r\n\t    0,     0,   6,  //  36  0000 1000.\r\n\t 51*3,  54*3,   0,  //  37  0000 0100 0\r\n\t 50*3,  49*3,   0,  //  38  0000 0011 0\r\n\t 45*3,  46*3,   0,  //  39  0000 0101 1\r\n\t 52*3,  47*3,   0,  //  40  0000 0011 1\r\n\t 43*3,  53*3,   0,  //  41  0000 0100 1\r\n\t 44*3,  48*3,   0,  //  42  0000 0101 0\r\n\t    0,     0,  10,  //  43  0000 0100 10.\r\n\t    0,     0,   9,  //  44  0000 0101 00.\r\n\t    0,     0,   8,  //  45  0000 0101 10.\r\n\t    0,     0,  -8,  //  46  0000 0101 11.\r\n\t 57*3,  66*3,   0,  //  47  0000 0011 11\r\n\t    0,     0,  -9,  //  48  0000 0101 01.\r\n\t 60*3,  64*3,   0,  //  49  0000 0011 01\r\n\t 56*3,  61*3,   0,  //  50  0000 0011 00\r\n\t 55*3,  62*3,   0,  //  51  0000 0100 00\r\n\t 58*3,  63*3,   0,  //  52  0000 0011 10\r\n\t    0,     0, -10,  //  53  0000 0100 11.\r\n\t 59*3,  65*3,   0,  //  54  0000 0100 01\r\n\t    0,     0,  12,  //  55  0000 0100 000.\r\n\t    0,     0,  16,  //  56  0000 0011 000.\r\n\t    0,     0,  13,  //  57  0000 0011 110.\r\n\t    0,     0,  14,  //  58  0000 0011 100.\r\n\t    0,     0,  11,  //  59  0000 0100 010.\r\n\t    0,     0,  15,  //  60  0000 0011 010.\r\n\t    0,     0, -16,  //  61  0000 0011 001.\r\n\t    0,     0, -12,  //  62  0000 0100 001.\r\n\t    0,     0, -14,  //  63  0000 0011 101.\r\n\t    0,     0, -15,  //  64  0000 0011 011.\r\n\t    0,     0, -11,  //  65  0000 0100 011.\r\n\t    0,     0, -13   //  66  0000 0011 111.\r\n]);\r\n\r\nMPEG1.DCT_DC_SIZE_LUMINANCE = new Int8Array([\r\n\t  2*3,   1*3, 0,  //   0\r\n\t  6*3,   5*3, 0,  //   1  1\r\n\t  3*3,   4*3, 0,  //   2  0\r\n\t    0,     0, 1,  //   3  00.\r\n\t    0,     0, 2,  //   4  01.\r\n\t  9*3,   8*3, 0,  //   5  11\r\n\t  7*3,  10*3, 0,  //   6  10\r\n\t    0,     0, 0,  //   7  100.\r\n\t 12*3,  11*3, 0,  //   8  111\r\n\t    0,     0, 4,  //   9  110.\r\n\t    0,     0, 3,  //  10  101.\r\n\t 13*3,  14*3, 0,  //  11  1111\r\n\t    0,     0, 5,  //  12  1110.\r\n\t    0,     0, 6,  //  13  1111 0.\r\n\t 16*3,  15*3, 0,  //  14  1111 1\r\n\t 17*3,    -1, 0,  //  15  1111 11\r\n\t    0,     0, 7,  //  16  1111 10.\r\n\t    0,     0, 8   //  17  1111 110.\r\n]);\r\n\r\nMPEG1.DCT_DC_SIZE_CHROMINANCE = new Int8Array([\r\n\t  2*3,   1*3, 0,  //   0\r\n\t  4*3,   3*3, 0,  //   1  1\r\n\t  6*3,   5*3, 0,  //   2  0\r\n\t  8*3,   7*3, 0,  //   3  11\r\n\t    0,     0, 2,  //   4  10.\r\n\t    0,     0, 1,  //   5  01.\r\n\t    0,     0, 0,  //   6  00.\r\n\t 10*3,   9*3, 0,  //   7  111\r\n\t    0,     0, 3,  //   8  110.\r\n\t 12*3,  11*3, 0,  //   9  1111\r\n\t    0,     0, 4,  //  10  1110.\r\n\t 14*3,  13*3, 0,  //  11  1111 1\r\n\t    0,     0, 5,  //  12  1111 0.\r\n\t 16*3,  15*3, 0,  //  13  1111 11\r\n\t    0,     0, 6,  //  14  1111 10.\r\n\t 17*3,    -1, 0,  //  15  1111 111\r\n\t    0,     0, 7,  //  16  1111 110.\r\n\t    0,     0, 8   //  17  1111 1110.\r\n]);\r\n\r\n//  dct_coeff bitmap:\r\n//    0xff00  run\r\n//    0x00ff  level\r\n\r\n//  Decoded values are unsigned. Sign bit follows in the stream.\r\n\r\n//  Interpretation of the value 0x0001\r\n//    for dc_coeff_first:  run=0, level=1\r\n//    for dc_coeff_next:   If the next bit is 1: run=0, level=1\r\n//                         If the next bit is 0: end_of_block\r\n\r\n//  escape decodes as 0xffff.\r\n\r\nMPEG1.DCT_COEFF = new Int32Array([\r\n\t  1*3,   2*3,      0,  //   0\r\n\t  4*3,   3*3,      0,  //   1  0\r\n\t    0,     0, 0x0001,  //   2  1.\r\n\t  7*3,   8*3,      0,  //   3  01\r\n\t  6*3,   5*3,      0,  //   4  00\r\n\t 13*3,   9*3,      0,  //   5  001\r\n\t 11*3,  10*3,      0,  //   6  000\r\n\t 14*3,  12*3,      0,  //   7  010\r\n\t    0,     0, 0x0101,  //   8  011.\r\n\t 20*3,  22*3,      0,  //   9  0011\r\n\t 18*3,  21*3,      0,  //  10  0001\r\n\t 16*3,  19*3,      0,  //  11  0000\r\n\t    0,     0, 0x0201,  //  12  0101.\r\n\t 17*3,  15*3,      0,  //  13  0010\r\n\t    0,     0, 0x0002,  //  14  0100.\r\n\t    0,     0, 0x0003,  //  15  0010 1.\r\n\t 27*3,  25*3,      0,  //  16  0000 0\r\n\t 29*3,  31*3,      0,  //  17  0010 0\r\n\t 24*3,  26*3,      0,  //  18  0001 0\r\n\t 32*3,  30*3,      0,  //  19  0000 1\r\n\t    0,     0, 0x0401,  //  20  0011 0.\r\n\t 23*3,  28*3,      0,  //  21  0001 1\r\n\t    0,     0, 0x0301,  //  22  0011 1.\r\n\t    0,     0, 0x0102,  //  23  0001 10.\r\n\t    0,     0, 0x0701,  //  24  0001 00.\r\n\t    0,     0, 0xffff,  //  25  0000 01. -- escape\r\n\t    0,     0, 0x0601,  //  26  0001 01.\r\n\t 37*3,  36*3,      0,  //  27  0000 00\r\n\t    0,     0, 0x0501,  //  28  0001 11.\r\n\t 35*3,  34*3,      0,  //  29  0010 00\r\n\t 39*3,  38*3,      0,  //  30  0000 11\r\n\t 33*3,  42*3,      0,  //  31  0010 01\r\n\t 40*3,  41*3,      0,  //  32  0000 10\r\n\t 52*3,  50*3,      0,  //  33  0010 010\r\n\t 54*3,  53*3,      0,  //  34  0010 001\r\n\t 48*3,  49*3,      0,  //  35  0010 000\r\n\t 43*3,  45*3,      0,  //  36  0000 001\r\n\t 46*3,  44*3,      0,  //  37  0000 000\r\n\t    0,     0, 0x0801,  //  38  0000 111.\r\n\t    0,     0, 0x0004,  //  39  0000 110.\r\n\t    0,     0, 0x0202,  //  40  0000 100.\r\n\t    0,     0, 0x0901,  //  41  0000 101.\r\n\t 51*3,  47*3,      0,  //  42  0010 011\r\n\t 55*3,  57*3,      0,  //  43  0000 0010\r\n\t 60*3,  56*3,      0,  //  44  0000 0001\r\n\t 59*3,  58*3,      0,  //  45  0000 0011\r\n\t 61*3,  62*3,      0,  //  46  0000 0000\r\n\t    0,     0, 0x0a01,  //  47  0010 0111.\r\n\t    0,     0, 0x0d01,  //  48  0010 0000.\r\n\t    0,     0, 0x0006,  //  49  0010 0001.\r\n\t    0,     0, 0x0103,  //  50  0010 0101.\r\n\t    0,     0, 0x0005,  //  51  0010 0110.\r\n\t    0,     0, 0x0302,  //  52  0010 0100.\r\n\t    0,     0, 0x0b01,  //  53  0010 0011.\r\n\t    0,     0, 0x0c01,  //  54  0010 0010.\r\n\t 76*3,  75*3,      0,  //  55  0000 0010 0\r\n\t 67*3,  70*3,      0,  //  56  0000 0001 1\r\n\t 73*3,  71*3,      0,  //  57  0000 0010 1\r\n\t 78*3,  74*3,      0,  //  58  0000 0011 1\r\n\t 72*3,  77*3,      0,  //  59  0000 0011 0\r\n\t 69*3,  64*3,      0,  //  60  0000 0001 0\r\n\t 68*3,  63*3,      0,  //  61  0000 0000 0\r\n\t 66*3,  65*3,      0,  //  62  0000 0000 1\r\n\t 81*3,  87*3,      0,  //  63  0000 0000 01\r\n\t 91*3,  80*3,      0,  //  64  0000 0001 01\r\n\t 82*3,  79*3,      0,  //  65  0000 0000 11\r\n\t 83*3,  86*3,      0,  //  66  0000 0000 10\r\n\t 93*3,  92*3,      0,  //  67  0000 0001 10\r\n\t 84*3,  85*3,      0,  //  68  0000 0000 00\r\n\t 90*3,  94*3,      0,  //  69  0000 0001 00\r\n\t 88*3,  89*3,      0,  //  70  0000 0001 11\r\n\t    0,     0, 0x0203,  //  71  0000 0010 11.\r\n\t    0,     0, 0x0104,  //  72  0000 0011 00.\r\n\t    0,     0, 0x0007,  //  73  0000 0010 10.\r\n\t    0,     0, 0x0402,  //  74  0000 0011 11.\r\n\t    0,     0, 0x0502,  //  75  0000 0010 01.\r\n\t    0,     0, 0x1001,  //  76  0000 0010 00.\r\n\t    0,     0, 0x0f01,  //  77  0000 0011 01.\r\n\t    0,     0, 0x0e01,  //  78  0000 0011 10.\r\n\t105*3, 107*3,      0,  //  79  0000 0000 111\r\n\t111*3, 114*3,      0,  //  80  0000 0001 011\r\n\t104*3,  97*3,      0,  //  81  0000 0000 010\r\n\t125*3, 119*3,      0,  //  82  0000 0000 110\r\n\t 96*3,  98*3,      0,  //  83  0000 0000 100\r\n\t   -1, 123*3,      0,  //  84  0000 0000 000\r\n\t 95*3, 101*3,      0,  //  85  0000 0000 001\r\n\t106*3, 121*3,      0,  //  86  0000 0000 101\r\n\t 99*3, 102*3,      0,  //  87  0000 0000 011\r\n\t113*3, 103*3,      0,  //  88  0000 0001 110\r\n\t112*3, 116*3,      0,  //  89  0000 0001 111\r\n\t110*3, 100*3,      0,  //  90  0000 0001 000\r\n\t124*3, 115*3,      0,  //  91  0000 0001 010\r\n\t117*3, 122*3,      0,  //  92  0000 0001 101\r\n\t109*3, 118*3,      0,  //  93  0000 0001 100\r\n\t120*3, 108*3,      0,  //  94  0000 0001 001\r\n\t127*3, 136*3,      0,  //  95  0000 0000 0010\r\n\t139*3, 140*3,      0,  //  96  0000 0000 1000\r\n\t130*3, 126*3,      0,  //  97  0000 0000 0101\r\n\t145*3, 146*3,      0,  //  98  0000 0000 1001\r\n\t128*3, 129*3,      0,  //  99  0000 0000 0110\r\n\t    0,     0, 0x0802,  // 100  0000 0001 0001.\r\n\t132*3, 134*3,      0,  // 101  0000 0000 0011\r\n\t155*3, 154*3,      0,  // 102  0000 0000 0111\r\n\t    0,     0, 0x0008,  // 103  0000 0001 1101.\r\n\t137*3, 133*3,      0,  // 104  0000 0000 0100\r\n\t143*3, 144*3,      0,  // 105  0000 0000 1110\r\n\t151*3, 138*3,      0,  // 106  0000 0000 1010\r\n\t142*3, 141*3,      0,  // 107  0000 0000 1111\r\n\t    0,     0, 0x000a,  // 108  0000 0001 0011.\r\n\t    0,     0, 0x0009,  // 109  0000 0001 1000.\r\n\t    0,     0, 0x000b,  // 110  0000 0001 0000.\r\n\t    0,     0, 0x1501,  // 111  0000 0001 0110.\r\n\t    0,     0, 0x0602,  // 112  0000 0001 1110.\r\n\t    0,     0, 0x0303,  // 113  0000 0001 1100.\r\n\t    0,     0, 0x1401,  // 114  0000 0001 0111.\r\n\t    0,     0, 0x0702,  // 115  0000 0001 0101.\r\n\t    0,     0, 0x1101,  // 116  0000 0001 1111.\r\n\t    0,     0, 0x1201,  // 117  0000 0001 1010.\r\n\t    0,     0, 0x1301,  // 118  0000 0001 1001.\r\n\t148*3, 152*3,      0,  // 119  0000 0000 1101\r\n\t    0,     0, 0x0403,  // 120  0000 0001 0010.\r\n\t153*3, 150*3,      0,  // 121  0000 0000 1011\r\n\t    0,     0, 0x0105,  // 122  0000 0001 1011.\r\n\t131*3, 135*3,      0,  // 123  0000 0000 0001\r\n\t    0,     0, 0x0204,  // 124  0000 0001 0100.\r\n\t149*3, 147*3,      0,  // 125  0000 0000 1100\r\n\t172*3, 173*3,      0,  // 126  0000 0000 0101 1\r\n\t162*3, 158*3,      0,  // 127  0000 0000 0010 0\r\n\t170*3, 161*3,      0,  // 128  0000 0000 0110 0\r\n\t168*3, 166*3,      0,  // 129  0000 0000 0110 1\r\n\t157*3, 179*3,      0,  // 130  0000 0000 0101 0\r\n\t169*3, 167*3,      0,  // 131  0000 0000 0001 0\r\n\t174*3, 171*3,      0,  // 132  0000 0000 0011 0\r\n\t178*3, 177*3,      0,  // 133  0000 0000 0100 1\r\n\t156*3, 159*3,      0,  // 134  0000 0000 0011 1\r\n\t164*3, 165*3,      0,  // 135  0000 0000 0001 1\r\n\t183*3, 182*3,      0,  // 136  0000 0000 0010 1\r\n\t175*3, 176*3,      0,  // 137  0000 0000 0100 0\r\n\t    0,     0, 0x0107,  // 138  0000 0000 1010 1.\r\n\t    0,     0, 0x0a02,  // 139  0000 0000 1000 0.\r\n\t    0,     0, 0x0902,  // 140  0000 0000 1000 1.\r\n\t    0,     0, 0x1601,  // 141  0000 0000 1111 1.\r\n\t    0,     0, 0x1701,  // 142  0000 0000 1111 0.\r\n\t    0,     0, 0x1901,  // 143  0000 0000 1110 0.\r\n\t    0,     0, 0x1801,  // 144  0000 0000 1110 1.\r\n\t    0,     0, 0x0503,  // 145  0000 0000 1001 0.\r\n\t    0,     0, 0x0304,  // 146  0000 0000 1001 1.\r\n\t    0,     0, 0x000d,  // 147  0000 0000 1100 1.\r\n\t    0,     0, 0x000c,  // 148  0000 0000 1101 0.\r\n\t    0,     0, 0x000e,  // 149  0000 0000 1100 0.\r\n\t    0,     0, 0x000f,  // 150  0000 0000 1011 1.\r\n\t    0,     0, 0x0205,  // 151  0000 0000 1010 0.\r\n\t    0,     0, 0x1a01,  // 152  0000 0000 1101 1.\r\n\t    0,     0, 0x0106,  // 153  0000 0000 1011 0.\r\n\t180*3, 181*3,      0,  // 154  0000 0000 0111 1\r\n\t160*3, 163*3,      0,  // 155  0000 0000 0111 0\r\n\t196*3, 199*3,      0,  // 156  0000 0000 0011 10\r\n\t    0,     0, 0x001b,  // 157  0000 0000 0101 00.\r\n\t203*3, 185*3,      0,  // 158  0000 0000 0010 01\r\n\t202*3, 201*3,      0,  // 159  0000 0000 0011 11\r\n\t    0,     0, 0x0013,  // 160  0000 0000 0111 00.\r\n\t    0,     0, 0x0016,  // 161  0000 0000 0110 01.\r\n\t197*3, 207*3,      0,  // 162  0000 0000 0010 00\r\n\t    0,     0, 0x0012,  // 163  0000 0000 0111 01.\r\n\t191*3, 192*3,      0,  // 164  0000 0000 0001 10\r\n\t188*3, 190*3,      0,  // 165  0000 0000 0001 11\r\n\t    0,     0, 0x0014,  // 166  0000 0000 0110 11.\r\n\t184*3, 194*3,      0,  // 167  0000 0000 0001 01\r\n\t    0,     0, 0x0015,  // 168  0000 0000 0110 10.\r\n\t186*3, 193*3,      0,  // 169  0000 0000 0001 00\r\n\t    0,     0, 0x0017,  // 170  0000 0000 0110 00.\r\n\t204*3, 198*3,      0,  // 171  0000 0000 0011 01\r\n\t    0,     0, 0x0019,  // 172  0000 0000 0101 10.\r\n\t    0,     0, 0x0018,  // 173  0000 0000 0101 11.\r\n\t200*3, 205*3,      0,  // 174  0000 0000 0011 00\r\n\t    0,     0, 0x001f,  // 175  0000 0000 0100 00.\r\n\t    0,     0, 0x001e,  // 176  0000 0000 0100 01.\r\n\t    0,     0, 0x001c,  // 177  0000 0000 0100 11.\r\n\t    0,     0, 0x001d,  // 178  0000 0000 0100 10.\r\n\t    0,     0, 0x001a,  // 179  0000 0000 0101 01.\r\n\t    0,     0, 0x0011,  // 180  0000 0000 0111 10.\r\n\t    0,     0, 0x0010,  // 181  0000 0000 0111 11.\r\n\t189*3, 206*3,      0,  // 182  0000 0000 0010 11\r\n\t187*3, 195*3,      0,  // 183  0000 0000 0010 10\r\n\t218*3, 211*3,      0,  // 184  0000 0000 0001 010\r\n\t    0,     0, 0x0025,  // 185  0000 0000 0010 011.\r\n\t215*3, 216*3,      0,  // 186  0000 0000 0001 000\r\n\t    0,     0, 0x0024,  // 187  0000 0000 0010 100.\r\n\t210*3, 212*3,      0,  // 188  0000 0000 0001 110\r\n\t    0,     0, 0x0022,  // 189  0000 0000 0010 110.\r\n\t213*3, 209*3,      0,  // 190  0000 0000 0001 111\r\n\t221*3, 222*3,      0,  // 191  0000 0000 0001 100\r\n\t219*3, 208*3,      0,  // 192  0000 0000 0001 101\r\n\t217*3, 214*3,      0,  // 193  0000 0000 0001 001\r\n\t223*3, 220*3,      0,  // 194  0000 0000 0001 011\r\n\t    0,     0, 0x0023,  // 195  0000 0000 0010 101.\r\n\t    0,     0, 0x010b,  // 196  0000 0000 0011 100.\r\n\t    0,     0, 0x0028,  // 197  0000 0000 0010 000.\r\n\t    0,     0, 0x010c,  // 198  0000 0000 0011 011.\r\n\t    0,     0, 0x010a,  // 199  0000 0000 0011 101.\r\n\t    0,     0, 0x0020,  // 200  0000 0000 0011 000.\r\n\t    0,     0, 0x0108,  // 201  0000 0000 0011 111.\r\n\t    0,     0, 0x0109,  // 202  0000 0000 0011 110.\r\n\t    0,     0, 0x0026,  // 203  0000 0000 0010 010.\r\n\t    0,     0, 0x010d,  // 204  0000 0000 0011 010.\r\n\t    0,     0, 0x010e,  // 205  0000 0000 0011 001.\r\n\t    0,     0, 0x0021,  // 206  0000 0000 0010 111.\r\n\t    0,     0, 0x0027,  // 207  0000 0000 0010 001.\r\n\t    0,     0, 0x1f01,  // 208  0000 0000 0001 1011.\r\n\t    0,     0, 0x1b01,  // 209  0000 0000 0001 1111.\r\n\t    0,     0, 0x1e01,  // 210  0000 0000 0001 1100.\r\n\t    0,     0, 0x1002,  // 211  0000 0000 0001 0101.\r\n\t    0,     0, 0x1d01,  // 212  0000 0000 0001 1101.\r\n\t    0,     0, 0x1c01,  // 213  0000 0000 0001 1110.\r\n\t    0,     0, 0x010f,  // 214  0000 0000 0001 0011.\r\n\t    0,     0, 0x0112,  // 215  0000 0000 0001 0000.\r\n\t    0,     0, 0x0111,  // 216  0000 0000 0001 0001.\r\n\t    0,     0, 0x0110,  // 217  0000 0000 0001 0010.\r\n\t    0,     0, 0x0603,  // 218  0000 0000 0001 0100.\r\n\t    0,     0, 0x0b02,  // 219  0000 0000 0001 1010.\r\n\t    0,     0, 0x0e02,  // 220  0000 0000 0001 0111.\r\n\t    0,     0, 0x0d02,  // 221  0000 0000 0001 1000.\r\n\t    0,     0, 0x0c02,  // 222  0000 0000 0001 1001.\r\n\t    0,     0, 0x0f02   // 223  0000 0000 0001 0110.\r\n]);\r\n\r\nMPEG1.PICTURE_TYPE = {\r\n\tINTRA: 1,\r\n\tPREDICTIVE: 2,\r\n\tB: 3\r\n};\r\n\r\nMPEG1.START = {\r\n\tSEQUENCE: 0xB3,\r\n\tSLICE_FIRST: 0x01,\r\n\tSLICE_LAST: 0xAF,\r\n\tPICTURE: 0x00,\r\n\tEXTENSION: 0xB5,\r\n\tUSER_DATA: 0xB2\r\n};\r\n\r\nexport default MPEG1;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/mpeg1.js","// Based on kjmp2 by Martin J. Fiedler\r\n// http://keyj.emphy.de/kjmp2/\r\n\r\nimport {\r\n  BitBuffer,\r\n  Decoder,\r\n\tFill,\r\n} from '../index';\r\n\r\nimport BaseDecoder from './decoder';\r\n\r\nlet MP2 = function(options) {\r\n  Decoder.Base.call(this, options);\r\n\r\n\tvar bufferSize = options.audioBufferSize || 128*1024;\r\n\tvar bufferMode = options.streaming\r\n\t\t? BitBuffer.MODE.EVICT\r\n\t\t: BitBuffer.MODE.EXPAND;\r\n\r\n\tthis.bits = new BitBuffer(bufferSize, bufferMode);\r\n\r\n\tthis.left = new Float32Array(1152);\r\n\tthis.right = new Float32Array(1152);\r\n\tthis.sampleRate = 44100;\r\n\t\r\n\tthis.D = new Float32Array(1024);\r\n\tthis.D.set(MP2.SYNTHESIS_WINDOW, 0);\r\n\tthis.D.set(MP2.SYNTHESIS_WINDOW, 512);\r\n\tthis.V = new Float32Array(1024);\r\n\tthis.U = new Int32Array(32);\r\n\tthis.VPos = 0;\r\n\r\n\tthis.allocation = [new Array(32), new Array(32)];\r\n\tthis.scaleFactorInfo = [new Uint8Array(32), new Uint8Array(32)];\r\n\tthis.scaleFactor = [new Array(32), new Array(32)];\r\n\tthis.sample = [new Array(32), new Array(32)];\r\n\t\r\n\tfor (var j = 0; j < 2; j++) {\r\n\t\tfor (var i = 0; i < 32; i++) {\r\n\t\t\tthis.scaleFactor[j][i] = [0, 0, 0];\r\n\t\t\tthis.sample[j][i] = [0, 0, 0];\r\n\t\t}\r\n\t}\r\n};\r\n\r\nMP2.prototype = Object.create(BaseDecoder.prototype);\r\nMP2.prototype.constructor = MP2;\r\n\r\nMP2.prototype.decode = function() {\r\n\tvar pos = this.bits.index >> 3;\r\n\tif (pos >= this.bits.byteLength) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tvar decoded = this.decodeFrame(this.left, this.right);\r\n\tthis.bits.index = (pos + decoded) << 3;\r\n\r\n\tif (!decoded) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif (this.destination) {\r\n\t\tthis.destination.play(this.sampleRate, this.left, this.right);\r\n\t}\r\n\r\n\tthis.advanceDecodedTime(this.left.length / this.sampleRate);\r\n\treturn true;\r\n};\r\n\r\nMP2.prototype.getCurrentTime = function() {\r\n\tvar enqueuedTime = this.destination ? this.destination.enqueuedTime : 0;\r\n\treturn this.decodedTime - enqueuedTime;\r\n};\r\n\r\nMP2.prototype.decodeFrame = function(left, right) {\r\n\t// Check for valid header: syncword OK, MPEG-Audio Layer 2\r\n\tvar sync = this.bits.read(11),\r\n\t\tversion = this.bits.read(2),\r\n\t\tlayer = this.bits.read(2),\r\n\t\thasCRC = !this.bits.read(1);\r\n\r\n\tif (\r\n\t\tsync !== MP2.FRAME_SYNC ||\r\n\t\tversion !== MP2.VERSION.MPEG_1 ||\r\n\t\tlayer !== MP2.LAYER.II\r\n\t) {\r\n\t\treturn 0; // Invalid header or unsupported version\r\n\t}\r\n\r\n\tvar bitrateIndex = this.bits.read(4) - 1;\r\n\tif (bitrateIndex > 13) {\r\n\t\treturn 0;  // Invalid bit rate or 'free format'\r\n\t}\r\n\r\n\tvar sampleRateIndex = this.bits.read(2);\r\n\tvar sampleRate = MP2.SAMPLE_RATE[sampleRateIndex];\r\n\tif (sampleRateIndex === 3) {\r\n\t\treturn 0; // Invalid sample rate\r\n\t}\r\n\tif (version === MP2.VERSION.MPEG_2) {\r\n\t\tsampleRateIndex += 4;\r\n\t\tbitrateIndex += 14;\r\n\t}\r\n\tvar padding = this.bits.read(1),\r\n\t\tprivat = this.bits.read(1),\r\n\t\tmode = this.bits.read(2);\r\n\r\n\t// Parse the mode_extension, set up the stereo bound\r\n\tvar bound = 0;\r\n\tif (mode === MP2.MODE.JOINT_STEREO) {\r\n\t\tbound = (this.bits.read(2) + 1) << 2;\r\n\t}\r\n\telse {\r\n\t\tthis.bits.skip(2);\r\n\t\tbound = (mode === MP2.MODE.MONO) ? 0 : 32;\r\n\t}\r\n\r\n\t// Discard the last 4 bits of the header and the CRC value, if present\r\n\tthis.bits.skip(4);\r\n\tif (hasCRC) {\r\n\t\tthis.bits.skip(16);\r\n\t}\r\n\r\n\t// Compute the frame size\r\n\tvar bitrate = MP2.BIT_RATE[bitrateIndex],\r\n\t\tsampleRate = MP2.SAMPLE_RATE[sampleRateIndex],\r\n\t\tframeSize = ((144000 * bitrate / sampleRate) + padding)|0;\r\n\t\r\n\r\n\t// Prepare the quantizer table lookups\r\n\tvar tab3 = 0;\r\n\tvar sblimit = 0;\r\n\tif (version === MP2.VERSION.MPEG_2) {\r\n\t\t// MPEG-2 (LSR)\r\n\t\ttab3 = 2;\r\n\t\tsblimit = 30;\r\n\t}\r\n\telse {\r\n\t\t// MPEG-1\r\n\t\tvar tab1 = (mode === MP2.MODE.MONO) ? 0 : 1;\r\n\t\tvar tab2 = MP2.QUANT_LUT_STEP_1[tab1][bitrateIndex];\r\n\t\ttab3 = MP2.QUANT_LUT_STEP_2[tab2][sampleRateIndex];\r\n\t\tsblimit = tab3 & 63;\r\n\t\ttab3 >>= 6;\r\n\t}\r\n\r\n\tif (bound > sblimit) {\r\n\t\tbound = sblimit;\r\n\t}\r\n\r\n\t// Read the allocation information\r\n\tfor (var sb = 0; sb < bound; sb++) {\r\n\t\tthis.allocation[0][sb] = this.readAllocation(sb, tab3);\r\n\t\tthis.allocation[1][sb] = this.readAllocation(sb, tab3);\r\n\t}\r\n\r\n\tfor (var sb = bound; sb < sblimit; sb++) {\r\n\t\tthis.allocation[0][sb] = \r\n\t\t\tthis.allocation[1][sb] =\r\n\t\t\tthis.readAllocation(sb, tab3);\r\n\t}\r\n\r\n\t// Read scale factor selector information\r\n\tvar channels = (mode === MP2.MODE.MONO) ? 1 : 2;\r\n\tfor (var sb = 0;  sb < sblimit; sb++) {\r\n\t\tfor (ch = 0;  ch < channels; ch++) {\r\n\t\t\tif (this.allocation[ch][sb]) {\r\n\t\t\t\tthis.scaleFactorInfo[ch][sb] = this.bits.read(2);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (mode === MP2.MODE.MONO) {\r\n\t\t\tthis.scaleFactorInfo[1][sb] = this.scaleFactorInfo[0][sb];\r\n\t\t}\r\n\t}\r\n\r\n\t// Read scale factors\r\n\tfor (var sb = 0;  sb < sblimit; sb++) {\r\n\t\tfor (var ch = 0;  ch < channels; ch++) {\r\n\t\t\tif (this.allocation[ch][sb]) {\r\n\t\t\t\tvar sf = this.scaleFactor[ch][sb];\r\n\t\t\t\tswitch (this.scaleFactorInfo[ch][sb]) {\r\n\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\tsf[0] = this.bits.read(6);\r\n\t\t\t\t\t\tsf[1] = this.bits.read(6);\r\n\t\t\t\t\t\tsf[2] = this.bits.read(6);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tsf[0] =\r\n\t\t\t\t\t\tsf[1] = this.bits.read(6);\r\n\t\t\t\t\t\tsf[2] = this.bits.read(6);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\tsf[0] =\r\n\t\t\t\t\t\tsf[1] =\r\n\t\t\t\t\t\tsf[2] = this.bits.read(6);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\tsf[0] = this.bits.read(6);\r\n\t\t\t\t\t\tsf[1] =\r\n\t\t\t\t\t\tsf[2] = this.bits.read(6);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (mode === MP2.MODE.MONO) {\r\n\t\t\tthis.scaleFactor[1][sb][0] = this.scaleFactor[0][sb][0];\r\n\t\t\tthis.scaleFactor[1][sb][1] = this.scaleFactor[0][sb][1];\r\n\t\t\tthis.scaleFactor[1][sb][2] = this.scaleFactor[0][sb][2];\r\n\t\t}\r\n\t}\r\n\r\n\t// Coefficient input and reconstruction\r\n\tvar outPos = 0;\r\n\tfor (var part = 0; part < 3; part++) {\r\n\t\tfor (var granule = 0; granule < 4; granule++) {\r\n\r\n\t\t\t// Read the samples\r\n\t\t\tfor (var sb = 0; sb < bound; sb++) {\r\n\t\t\t\tthis.readSamples(0, sb, part);\r\n\t\t\t\tthis.readSamples(1, sb, part);\r\n\t\t\t}\r\n\t\t\tfor (var sb = bound; sb < sblimit; sb++) {\r\n\t\t\t\tthis.readSamples(0, sb, part);\r\n\t\t\t\tthis.sample[1][sb][0] = this.sample[0][sb][0];\r\n\t\t\t\tthis.sample[1][sb][1] = this.sample[0][sb][1];\r\n\t\t\t\tthis.sample[1][sb][2] = this.sample[0][sb][2];\r\n\t\t\t}\r\n\t\t\tfor (var sb = sblimit; sb < 32; sb++) {\r\n\t\t\t\tthis.sample[0][sb][0] = 0;\r\n\t\t\t\tthis.sample[0][sb][1] = 0;\r\n\t\t\t\tthis.sample[0][sb][2] = 0;\r\n\t\t\t\tthis.sample[1][sb][0] = 0;\r\n\t\t\t\tthis.sample[1][sb][1] = 0;\r\n\t\t\t\tthis.sample[1][sb][2] = 0;\r\n\t\t\t}\r\n\r\n\t\t\t// Synthesis loop\r\n\t\t\tfor (var p = 0; p < 3; p++) {\r\n\t\t\t\t// Shifting step\r\n\t\t\t\tthis.VPos = (this.VPos - 64) & 1023;\r\n\r\n\t\t\t\tfor (var ch = 0;  ch < 2; ch++) {\r\n\t\t\t\t\tMP2.MatrixTransform(this.sample[ch], p, this.V, this.VPos);\r\n\r\n\t\t\t\t\t// Build U, windowing, calculate output\r\n\t\t\t\t\tFill(this.U, 0);\r\n\r\n\t\t\t\t\tvar dIndex = 512 - (this.VPos >> 1);\r\n\t\t\t\t\tvar vIndex = (this.VPos % 128) >> 1;\r\n\t\t\t\t\twhile (vIndex < 1024) {\r\n\t\t\t\t\t\tfor (var i = 0; i < 32; ++i) {\r\n\t\t\t\t\t\t\tthis.U[i] += this.D[dIndex++] * this.V[vIndex++];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvIndex += 128-32;\r\n\t\t\t\t\t\tdIndex += 64-32;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvIndex = (128-32 + 1024) - vIndex;\r\n\t\t\t\t\tdIndex -= (512 - 32);\r\n\t\t\t\t\twhile (vIndex < 1024) {\r\n\t\t\t\t\t\tfor (var i = 0; i < 32; ++i) {\r\n\t\t\t\t\t\t\tthis.U[i] += this.D[dIndex++] * this.V[vIndex++];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvIndex += 128-32;\r\n\t\t\t\t\t\tdIndex += 64-32;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Output samples\r\n\t\t\t\t\tvar outChannel = ch === 0 ? left : right;\r\n\t\t\t\t\tfor (var j = 0; j < 32; j++) {\r\n\t\t\t\t\t\toutChannel[outPos + j] = this.U[j] / 2147418112;\r\n\t\t\t\t\t}\r\n\t\t\t\t} // End of synthesis channel loop\r\n\t\t\t\toutPos += 32;\r\n\t\t\t} // End of synthesis sub-block loop\r\n\r\n\t\t} // Decoding of the granule finished\r\n\t}\r\n\r\n\tthis.sampleRate = sampleRate;\r\n\treturn frameSize;\r\n};\r\n\r\nMP2.prototype.readAllocation = function(sb, tab3) {\r\n\tvar tab4 = MP2.QUANT_LUT_STEP_3[tab3][sb];\r\n\tvar qtab = MP2.QUANT_LUT_STEP4[tab4 & 15][this.bits.read(tab4 >> 4)];\r\n\treturn qtab ? (MP2.QUANT_TAB[qtab - 1]) : 0;\r\n};\r\n\r\nMP2.prototype.readSamples = function(ch, sb, part) {\r\n\tvar q = this.allocation[ch][sb],\r\n\t\tsf = this.scaleFactor[ch][sb][part],\r\n\t\tsample = this.sample[ch][sb],\r\n\t\tval = 0;\r\n\r\n\tif (!q) {\r\n\t\t// No bits allocated for this subband\r\n\t\tsample[0] = sample[1] = sample[2] = 0;\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Resolve scalefactor\r\n\tif (sf === 63) {\r\n\t\tsf = 0;\r\n\t}\r\n\telse {\r\n\t\tvar shift = (sf / 3)|0;\r\n\t\tsf = (MP2.SCALEFACTOR_BASE[sf % 3] + ((1 << shift) >> 1)) >> shift;\r\n\t}\r\n\r\n\t// Decode samples\r\n\tvar adj = q.levels;\r\n\tif (q.group) {\r\n\t\t// Decode grouped samples\r\n\t\tval = this.bits.read(q.bits);\r\n\t\tsample[0] = val % adj;\r\n\t\tval = (val / adj)|0;\r\n\t\tsample[1] = val % adj;\r\n\t\tsample[2] = (val / adj)|0;\r\n\t}\r\n\telse {\r\n\t\t// Decode direct samples\r\n\t\tsample[0] = this.bits.read(q.bits);\r\n\t\tsample[1] = this.bits.read(q.bits);\r\n\t\tsample[2] = this.bits.read(q.bits);\r\n\t}\r\n\r\n\t// Postmultiply samples\r\n\tvar scale = (65536 / (adj + 1))|0;\r\n\tadj = ((adj + 1) >> 1) - 1;\r\n\r\n\tval = (adj - sample[0]) * scale;\r\n\tsample[0] = (val * (sf >> 12) + ((val * (sf & 4095) + 2048) >> 12)) >> 12;\r\n\r\n\tval = (adj - sample[1]) * scale;\r\n\tsample[1] = (val * (sf >> 12) + ((val * (sf & 4095) + 2048) >> 12)) >> 12;\r\n\r\n\tval = (adj - sample[2]) * scale;\r\n\tsample[2] = (val * (sf >> 12) + ((val * (sf & 4095) + 2048) >> 12)) >> 12;\r\n};\r\n\r\nMP2.MatrixTransform = function(s, ss, d, dp) {\r\n\tvar t01, t02, t03, t04, t05, t06, t07, t08, t09, t10, t11, t12,\r\n\t\tt13, t14, t15, t16, t17, t18, t19, t20, t21, t22, t23, t24,\r\n\t\tt25, t26, t27, t28, t29, t30, t31, t32, t33;\r\n\r\n\tt01 = s[ 0][ss] + s[31][ss]; t02 = (s[ 0][ss] - s[31][ss]) * 0.500602998235;\r\n\tt03 = s[ 1][ss] + s[30][ss]; t04 = (s[ 1][ss] - s[30][ss]) * 0.505470959898;\r\n\tt05 = s[ 2][ss] + s[29][ss]; t06 = (s[ 2][ss] - s[29][ss]) * 0.515447309923;\r\n\tt07 = s[ 3][ss] + s[28][ss]; t08 = (s[ 3][ss] - s[28][ss]) * 0.53104259109;\r\n\tt09 = s[ 4][ss] + s[27][ss]; t10 = (s[ 4][ss] - s[27][ss]) * 0.553103896034;\r\n\tt11 = s[ 5][ss] + s[26][ss]; t12 = (s[ 5][ss] - s[26][ss]) * 0.582934968206;\r\n\tt13 = s[ 6][ss] + s[25][ss]; t14 = (s[ 6][ss] - s[25][ss]) * 0.622504123036;\r\n\tt15 = s[ 7][ss] + s[24][ss]; t16 = (s[ 7][ss] - s[24][ss]) * 0.674808341455;\r\n\tt17 = s[ 8][ss] + s[23][ss]; t18 = (s[ 8][ss] - s[23][ss]) * 0.744536271002;\r\n\tt19 = s[ 9][ss] + s[22][ss]; t20 = (s[ 9][ss] - s[22][ss]) * 0.839349645416;\r\n\tt21 = s[10][ss] + s[21][ss]; t22 = (s[10][ss] - s[21][ss]) * 0.972568237862;\r\n\tt23 = s[11][ss] + s[20][ss]; t24 = (s[11][ss] - s[20][ss]) * 1.16943993343;\r\n\tt25 = s[12][ss] + s[19][ss]; t26 = (s[12][ss] - s[19][ss]) * 1.48416461631;\r\n\tt27 = s[13][ss] + s[18][ss]; t28 = (s[13][ss] - s[18][ss]) * 2.05778100995;\r\n\tt29 = s[14][ss] + s[17][ss]; t30 = (s[14][ss] - s[17][ss]) * 3.40760841847;\r\n\tt31 = s[15][ss] + s[16][ss]; t32 = (s[15][ss] - s[16][ss]) * 10.1900081235;\r\n\r\n\tt33 = t01 + t31; t31 = (t01 - t31) * 0.502419286188;\r\n\tt01 = t03 + t29; t29 = (t03 - t29) * 0.52249861494;\r\n\tt03 = t05 + t27; t27 = (t05 - t27) * 0.566944034816;\r\n\tt05 = t07 + t25; t25 = (t07 - t25) * 0.64682178336;\r\n\tt07 = t09 + t23; t23 = (t09 - t23) * 0.788154623451;\r\n\tt09 = t11 + t21; t21 = (t11 - t21) * 1.06067768599;\r\n\tt11 = t13 + t19; t19 = (t13 - t19) * 1.72244709824;\r\n\tt13 = t15 + t17; t17 = (t15 - t17) * 5.10114861869;\r\n\tt15 = t33 + t13; t13 = (t33 - t13) * 0.509795579104;\r\n\tt33 = t01 + t11; t01 = (t01 - t11) * 0.601344886935;\r\n\tt11 = t03 + t09; t09 = (t03 - t09) * 0.899976223136;\r\n\tt03 = t05 + t07; t07 = (t05 - t07) * 2.56291544774;\r\n\tt05 = t15 + t03; t15 = (t15 - t03) * 0.541196100146;\r\n\tt03 = t33 + t11; t11 = (t33 - t11) * 1.30656296488;\r\n\tt33 = t05 + t03; t05 = (t05 - t03) * 0.707106781187;\r\n\tt03 = t15 + t11; t15 = (t15 - t11) * 0.707106781187;\r\n\tt03 += t15;\r\n\tt11 = t13 + t07; t13 = (t13 - t07) * 0.541196100146;\r\n\tt07 = t01 + t09; t09 = (t01 - t09) * 1.30656296488;\r\n\tt01 = t11 + t07; t07 = (t11 - t07) * 0.707106781187;\r\n\tt11 = t13 + t09; t13 = (t13 - t09) * 0.707106781187;\r\n\tt11 += t13; t01 += t11; \r\n\tt11 += t07; t07 += t13;\r\n\tt09 = t31 + t17; t31 = (t31 - t17) * 0.509795579104;\r\n\tt17 = t29 + t19; t29 = (t29 - t19) * 0.601344886935;\r\n\tt19 = t27 + t21; t21 = (t27 - t21) * 0.899976223136;\r\n\tt27 = t25 + t23; t23 = (t25 - t23) * 2.56291544774;\r\n\tt25 = t09 + t27; t09 = (t09 - t27) * 0.541196100146;\r\n\tt27 = t17 + t19; t19 = (t17 - t19) * 1.30656296488;\r\n\tt17 = t25 + t27; t27 = (t25 - t27) * 0.707106781187;\r\n\tt25 = t09 + t19; t19 = (t09 - t19) * 0.707106781187;\r\n\tt25 += t19;\r\n\tt09 = t31 + t23; t31 = (t31 - t23) * 0.541196100146;\r\n\tt23 = t29 + t21; t21 = (t29 - t21) * 1.30656296488;\r\n\tt29 = t09 + t23; t23 = (t09 - t23) * 0.707106781187;\r\n\tt09 = t31 + t21; t31 = (t31 - t21) * 0.707106781187;\r\n\tt09 += t31;\tt29 += t09;\tt09 += t23;\tt23 += t31;\r\n\tt17 += t29;\tt29 += t25;\tt25 += t09;\tt09 += t27;\r\n\tt27 += t23;\tt23 += t19; t19 += t31;\t\r\n\tt21 = t02 + t32; t02 = (t02 - t32) * 0.502419286188;\r\n\tt32 = t04 + t30; t04 = (t04 - t30) * 0.52249861494;\r\n\tt30 = t06 + t28; t28 = (t06 - t28) * 0.566944034816;\r\n\tt06 = t08 + t26; t08 = (t08 - t26) * 0.64682178336;\r\n\tt26 = t10 + t24; t10 = (t10 - t24) * 0.788154623451;\r\n\tt24 = t12 + t22; t22 = (t12 - t22) * 1.06067768599;\r\n\tt12 = t14 + t20; t20 = (t14 - t20) * 1.72244709824;\r\n\tt14 = t16 + t18; t16 = (t16 - t18) * 5.10114861869;\r\n\tt18 = t21 + t14; t14 = (t21 - t14) * 0.509795579104;\r\n\tt21 = t32 + t12; t32 = (t32 - t12) * 0.601344886935;\r\n\tt12 = t30 + t24; t24 = (t30 - t24) * 0.899976223136;\r\n\tt30 = t06 + t26; t26 = (t06 - t26) * 2.56291544774;\r\n\tt06 = t18 + t30; t18 = (t18 - t30) * 0.541196100146;\r\n\tt30 = t21 + t12; t12 = (t21 - t12) * 1.30656296488;\r\n\tt21 = t06 + t30; t30 = (t06 - t30) * 0.707106781187;\r\n\tt06 = t18 + t12; t12 = (t18 - t12) * 0.707106781187;\r\n\tt06 += t12;\r\n\tt18 = t14 + t26; t26 = (t14 - t26) * 0.541196100146;\r\n\tt14 = t32 + t24; t24 = (t32 - t24) * 1.30656296488;\r\n\tt32 = t18 + t14; t14 = (t18 - t14) * 0.707106781187;\r\n\tt18 = t26 + t24; t24 = (t26 - t24) * 0.707106781187;\r\n\tt18 += t24; t32 += t18; \r\n\tt18 += t14; t26 = t14 + t24;\r\n\tt14 = t02 + t16; t02 = (t02 - t16) * 0.509795579104;\r\n\tt16 = t04 + t20; t04 = (t04 - t20) * 0.601344886935;\r\n\tt20 = t28 + t22; t22 = (t28 - t22) * 0.899976223136;\r\n\tt28 = t08 + t10; t10 = (t08 - t10) * 2.56291544774;\r\n\tt08 = t14 + t28; t14 = (t14 - t28) * 0.541196100146;\r\n\tt28 = t16 + t20; t20 = (t16 - t20) * 1.30656296488;\r\n\tt16 = t08 + t28; t28 = (t08 - t28) * 0.707106781187;\r\n\tt08 = t14 + t20; t20 = (t14 - t20) * 0.707106781187;\r\n\tt08 += t20;\r\n\tt14 = t02 + t10; t02 = (t02 - t10) * 0.541196100146;\r\n\tt10 = t04 + t22; t22 = (t04 - t22) * 1.30656296488;\r\n\tt04 = t14 + t10; t10 = (t14 - t10) * 0.707106781187;\r\n\tt14 = t02 + t22; t02 = (t02 - t22) * 0.707106781187;\r\n\tt14 += t02;\tt04 += t14;\tt14 += t10;\tt10 += t02;\r\n\tt16 += t04;\tt04 += t08;\tt08 += t14;\tt14 += t28;\r\n\tt28 += t10;\tt10 += t20;\tt20 += t02;\tt21 += t16;\r\n\tt16 += t32;\tt32 += t04;\tt04 += t06;\tt06 += t08;\r\n\tt08 += t18;\tt18 += t14;\tt14 += t30;\tt30 += t28;\r\n\tt28 += t26;\tt26 += t10;\tt10 += t12;\tt12 += t20;\r\n\tt20 += t24;\tt24 += t02;\r\n\r\n\td[dp + 48] = -t33;\r\n\td[dp + 49] = d[dp + 47] = -t21;\r\n\td[dp + 50] = d[dp + 46] = -t17;\r\n\td[dp + 51] = d[dp + 45] = -t16;\r\n\td[dp + 52] = d[dp + 44] = -t01;\r\n\td[dp + 53] = d[dp + 43] = -t32;\r\n\td[dp + 54] = d[dp + 42] = -t29;\r\n\td[dp + 55] = d[dp + 41] = -t04;\r\n\td[dp + 56] = d[dp + 40] = -t03;\r\n\td[dp + 57] = d[dp + 39] = -t06;\r\n\td[dp + 58] = d[dp + 38] = -t25;\r\n\td[dp + 59] = d[dp + 37] = -t08;\r\n\td[dp + 60] = d[dp + 36] = -t11;\r\n\td[dp + 61] = d[dp + 35] = -t18;\r\n\td[dp + 62] = d[dp + 34] = -t09;\r\n\td[dp + 63] = d[dp + 33] = -t14;\r\n\td[dp + 32] = -t05;\r\n\td[dp +  0] = t05; d[dp + 31] = -t30;\r\n\td[dp +  1] = t30; d[dp + 30] = -t27;\r\n\td[dp +  2] = t27; d[dp + 29] = -t28;\r\n\td[dp +  3] = t28; d[dp + 28] = -t07;\r\n\td[dp +  4] = t07; d[dp + 27] = -t26;\r\n\td[dp +  5] = t26; d[dp + 26] = -t23;\r\n\td[dp +  6] = t23; d[dp + 25] = -t10;\r\n\td[dp +  7] = t10; d[dp + 24] = -t15;\r\n\td[dp +  8] = t15; d[dp + 23] = -t12;\r\n\td[dp +  9] = t12; d[dp + 22] = -t19;\r\n\td[dp + 10] = t19; d[dp + 21] = -t20;\r\n\td[dp + 11] = t20; d[dp + 20] = -t13;\r\n\td[dp + 12] = t13; d[dp + 19] = -t24;\r\n\td[dp + 13] = t24; d[dp + 18] = -t31;\r\n\td[dp + 14] = t31; d[dp + 17] = -t02;\r\n\td[dp + 15] = t02; d[dp + 16] =  0.0;\r\n};\r\n\r\nMP2.FRAME_SYNC = 0x7ff;\r\n\r\nMP2.VERSION = {\r\n\tMPEG_2_5: 0x0,\r\n\tMPEG_2: 0x2,\r\n\tMPEG_1: 0x3\r\n};\r\n\r\nMP2.LAYER = {\r\n\tIII: 0x1,\r\n\tII: 0x2,\r\n\tI: 0x3\r\n};\r\n\r\nMP2.MODE = {\r\n\tSTEREO: 0x0,\r\n\tJOINT_STEREO: 0x1,\r\n\tDUAL_CHANNEL: 0x2,\r\n\tMONO: 0x3\r\n};\r\n\r\nMP2.SAMPLE_RATE = new Uint16Array([\r\n\t44100, 48000, 32000, 0, // MPEG-1\r\n\t22050, 24000, 16000, 0  // MPEG-2\r\n]);\r\n\r\nMP2.BIT_RATE = new Uint16Array([\r\n\t32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, // MPEG-1\r\n\t 8, 16, 24, 32, 40, 48,  56,  64,  80,  96, 112, 128, 144, 160  // MPEG-2\r\n]);\r\n\r\nMP2.SCALEFACTOR_BASE = new Uint32Array([\r\n\t0x02000000, 0x01965FEA, 0x01428A30\r\n]);\r\n\r\nMP2.SYNTHESIS_WINDOW = new Float32Array([\r\n\t     0.0,     -0.5,     -0.5,     -0.5,     -0.5,     -0.5,\r\n\t    -0.5,     -1.0,     -1.0,     -1.0,     -1.0,     -1.5,\r\n\t    -1.5,     -2.0,     -2.0,     -2.5,     -2.5,     -3.0,\r\n\t    -3.5,     -3.5,     -4.0,     -4.5,     -5.0,     -5.5,\r\n\t    -6.5,     -7.0,     -8.0,     -8.5,     -9.5,    -10.5,\r\n\t   -12.0,    -13.0,    -14.5,    -15.5,    -17.5,    -19.0,\r\n\t   -20.5,    -22.5,    -24.5,    -26.5,    -29.0,    -31.5,\r\n\t   -34.0,    -36.5,    -39.5,    -42.5,    -45.5,    -48.5,\r\n\t   -52.0,    -55.5,    -58.5,    -62.5,    -66.0,    -69.5,\r\n\t   -73.5,    -77.0,    -80.5,    -84.5,    -88.0,    -91.5,\r\n\t   -95.0,    -98.0,   -101.0,   -104.0,    106.5,    109.0,\r\n\t   111.0,    112.5,    113.5,    114.0,    114.0,    113.5,\r\n\t   112.0,    110.5,    107.5,    104.0,    100.0,     94.5,\r\n\t    88.5,     81.5,     73.0,     63.5,     53.0,     41.5,\r\n\t    28.5,     14.5,     -1.0,    -18.0,    -36.0,    -55.5,\r\n\t   -76.5,    -98.5,   -122.0,   -147.0,   -173.5,   -200.5,\r\n\t  -229.5,   -259.5,   -290.5,   -322.5,   -355.5,   -389.5,\r\n\t  -424.0,   -459.5,   -495.5,   -532.0,   -568.5,   -605.0,\r\n\t  -641.5,   -678.0,   -714.0,   -749.0,   -783.5,   -817.0,\r\n\t  -849.0,   -879.5,   -908.5,   -935.0,   -959.5,   -981.0,\r\n\t -1000.5,  -1016.0,  -1028.5,  -1037.5,  -1042.5,  -1043.5,\r\n\t -1040.0,  -1031.5,   1018.5,   1000.0,    976.0,    946.5,\r\n\t   911.0,    869.5,    822.0,    767.5,    707.0,    640.0,\r\n\t   565.5,    485.0,    397.0,    302.5,    201.0,     92.5,\r\n\t   -22.5,   -144.0,   -272.5,   -407.0,   -547.5,   -694.0,\r\n\t  -846.0,  -1003.0,  -1165.0,  -1331.5,  -1502.0,  -1675.5,\r\n\t -1852.5,  -2031.5,  -2212.5,  -2394.0,  -2576.5,  -2758.5,\r\n\t -2939.5,  -3118.5,  -3294.5,  -3467.5,  -3635.5,  -3798.5,\r\n\t -3955.0,  -4104.5,  -4245.5,  -4377.5,  -4499.0,  -4609.5,\r\n\t -4708.0,  -4792.5,  -4863.5,  -4919.0,  -4958.0,  -4979.5,\r\n\t -4983.0,  -4967.5,  -4931.5,  -4875.0,  -4796.0,  -4694.5,\r\n\t -4569.5,  -4420.0,  -4246.0,  -4046.0,  -3820.0,  -3567.0,\r\n\t  3287.0,   2979.5,   2644.0,   2280.5,   1888.0,   1467.5,\r\n\t  1018.5,    541.0,     35.0,   -499.0,  -1061.0,  -1650.0,\r\n\t -2266.5,  -2909.0,  -3577.0,  -4270.0,  -4987.5,  -5727.5,\r\n\t -6490.0,  -7274.0,  -8077.5,  -8899.5,  -9739.0, -10594.5,\r\n\t-11464.5, -12347.0, -13241.0, -14144.5, -15056.0, -15973.5,\r\n\t-16895.5, -17820.0, -18744.5, -19668.0, -20588.0, -21503.0,\r\n\t-22410.5, -23308.5, -24195.0, -25068.5, -25926.5, -26767.0,\r\n\t-27589.0, -28389.0, -29166.5, -29919.0, -30644.5, -31342.0,\r\n\t-32009.5, -32645.0, -33247.0, -33814.5, -34346.0, -34839.5,\r\n\t-35295.0, -35710.0, -36084.5, -36417.5, -36707.5, -36954.0,\r\n\t-37156.5, -37315.0, -37428.0, -37496.0,  37519.0,  37496.0,\r\n\t 37428.0,  37315.0,  37156.5,  36954.0,  36707.5,  36417.5,\r\n\t 36084.5,  35710.0,  35295.0,  34839.5,  34346.0,  33814.5,\r\n\t 33247.0,  32645.0,  32009.5,  31342.0,  30644.5,  29919.0,\r\n\t 29166.5,  28389.0,  27589.0,  26767.0,  25926.5,  25068.5,\r\n\t 24195.0,  23308.5,  22410.5,  21503.0,  20588.0,  19668.0,\r\n\t 18744.5,  17820.0,  16895.5,  15973.5,  15056.0,  14144.5,\r\n\t 13241.0,  12347.0,  11464.5,  10594.5,   9739.0,   8899.5,\r\n\t  8077.5,   7274.0,   6490.0,   5727.5,   4987.5,   4270.0,\r\n\t  3577.0,   2909.0,   2266.5,   1650.0,   1061.0,    499.0,\r\n\t   -35.0,   -541.0,  -1018.5,  -1467.5,  -1888.0,  -2280.5,\r\n\t -2644.0,  -2979.5,   3287.0,   3567.0,   3820.0,   4046.0,\r\n\t  4246.0,   4420.0,   4569.5,   4694.5,   4796.0,   4875.0,\r\n\t  4931.5,   4967.5,   4983.0,   4979.5,   4958.0,   4919.0,\r\n\t  4863.5,   4792.5,   4708.0,   4609.5,   4499.0,   4377.5,\r\n\t  4245.5,   4104.5,   3955.0,   3798.5,   3635.5,   3467.5,\r\n\t  3294.5,   3118.5,   2939.5,   2758.5,   2576.5,   2394.0,\r\n\t  2212.5,   2031.5,   1852.5,   1675.5,   1502.0,   1331.5,\r\n\t  1165.0,   1003.0,    846.0,    694.0,    547.5,    407.0,\r\n\t   272.5,    144.0,     22.5,    -92.5,   -201.0,   -302.5,\r\n\t  -397.0,   -485.0,   -565.5,   -640.0,   -707.0,   -767.5,\r\n\t  -822.0,   -869.5,   -911.0,   -946.5,   -976.0,  -1000.0,\r\n\t  1018.5,   1031.5,   1040.0,   1043.5,   1042.5,   1037.5,\r\n\t  1028.5,   1016.0,   1000.5,    981.0,    959.5,    935.0,\r\n\t   908.5,    879.5,    849.0,    817.0,    783.5,    749.0,\r\n\t   714.0,    678.0,    641.5,    605.0,    568.5,    532.0,\r\n\t   495.5,    459.5,    424.0,    389.5,    355.5,    322.5,\r\n\t   290.5,    259.5,    229.5,    200.5,    173.5,    147.0,\r\n\t   122.0,     98.5,     76.5,     55.5,     36.0,     18.0,\r\n\t\t1.0,    -14.5,    -28.5,    -41.5,    -53.0,    -63.5,\r\n\t   -73.0,    -81.5,    -88.5,    -94.5,   -100.0,   -104.0,\r\n\t  -107.5,   -110.5,   -112.0,   -113.5,   -114.0,   -114.0,\r\n\t  -113.5,   -112.5,   -111.0,   -109.0,    106.5,    104.0,\r\n\t   101.0,     98.0,     95.0,     91.5,     88.0,     84.5,\r\n\t    80.5,     77.0,     73.5,     69.5,     66.0,     62.5,\r\n\t    58.5,     55.5,     52.0,     48.5,     45.5,     42.5,\r\n\t    39.5,     36.5,     34.0,     31.5,     29.0,     26.5,\r\n\t    24.5,     22.5,     20.5,     19.0,     17.5,     15.5,\r\n\t    14.5,     13.0,     12.0,     10.5,      9.5,      8.5,\r\n\t     8.0,      7.0,      6.5,      5.5,      5.0,      4.5,\r\n\t     4.0,      3.5,      3.5,      3.0,      2.5,      2.5,\r\n\t     2.0,      2.0,      1.5,      1.5,      1.0,      1.0,\r\n\t     1.0,      1.0,      0.5,      0.5,      0.5,      0.5,\r\n\t     0.5,      0.5\r\n]);\r\n\r\n// Quantizer lookup, step 1: bitrate classes\r\nMP2.QUANT_LUT_STEP_1 = [\r\n \t// 32, 48, 56, 64, 80, 96,112,128,160,192,224,256,320,384 <- bitrate\r\n\t[   0,  0,  1,  1,  1,  2,  2,  2,  2,  2,  2,  2,  2,  2], // mono\r\n\t// 16, 24, 28, 32, 40, 48, 56, 64, 80, 96,112,128,160,192 <- bitrate / chan\r\n\t[   0,  0,  0,  0,  0,  0,  1,  1,  1,  2,  2,  2,  2,  2] // stereo\r\n];\r\n\r\n// Quantizer lookup, step 2: bitrate class, sample rate -> B2 table idx, sblimit\r\nMP2.QUANT_TAB = {\r\n\tA: (27 | 64), // Table 3-B.2a: high-rate, sblimit = 27\r\n\tB: (30 | 64), // Table 3-B.2b: high-rate, sblimit = 30\r\n\tC:   8,       // Table 3-B.2c:  low-rate, sblimit =  8\r\n\tD:  12        // Table 3-B.2d:  low-rate, sblimit = 12\r\n};\r\n\r\nMP2.QUANT_LUT_STEP_2 = [\r\n\t//   44.1 kHz,        48 kHz,          32 kHz\r\n\t[MP2.QUANT_TAB.C, MP2.QUANT_TAB.C, MP2.QUANT_TAB.D], // 32 - 48 kbit/sec/ch\r\n\t[MP2.QUANT_TAB.A, MP2.QUANT_TAB.A, MP2.QUANT_TAB.A], // 56 - 80 kbit/sec/ch\r\n\t[MP2.QUANT_TAB.B, MP2.QUANT_TAB.A, MP2.QUANT_TAB.B]  // 96+\t kbit/sec/ch\r\n];\r\n\r\n// Quantizer lookup, step 3: B2 table, subband -> nbal, row index\r\n// (upper 4 bits: nbal, lower 4 bits: row index)\r\nMP2.QUANT_LUT_STEP_3 = [\r\n\t// Low-rate table (3-B.2c and 3-B.2d)\r\n\t[\r\n\t\t0x44,0x44,\r\n\t  \t0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34\r\n\t],\r\n\t// High-rate table (3-B.2a and 3-B.2b)\r\n\t[\r\n\t\t0x43,0x43,0x43,\r\n\t\t0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,\r\n\t\t0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,\r\n\t\t0x20,0x20,0x20,0x20,0x20,0x20,0x20\r\n\t],\r\n\t// MPEG-2 LSR table (B.2 in ISO 13818-3)\r\n\t[\r\n\t\t0x45,0x45,0x45,0x45,\r\n\t\t0x34,0x34,0x34,0x34,0x34,0x34,0x34,\r\n\t\t0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,\r\n\t\t\t\t\t   0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24\t\r\n\t]\r\n];\r\n\r\n// Quantizer lookup, step 4: table row, allocation[] value -> quant table index\r\nMP2.QUANT_LUT_STEP4 = [\r\n\t[0, 1, 2, 17],\r\n\t[0, 1, 2, 3, 4, 5, 6, 17],\r\n\t[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 17],\r\n\t[0, 1, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17],\r\n\t[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17],\r\n\t[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]\r\n];\r\n\r\nMP2.QUANT_TAB = [\r\n\t{levels:     3, group: 1, bits:  5},  //  1\r\n\t{levels:     5, group: 1, bits:  7},  //  2\r\n\t{levels:     7, group: 0, bits:  3},  //  3\r\n\t{levels:     9, group: 1, bits: 10},  //  4\r\n\t{levels:    15, group: 0, bits:  4},  //  5\r\n\t{levels:    31, group: 0, bits:  5},  //  6\r\n\t{levels:    63, group: 0, bits:  6},  //  7\r\n\t{levels:   127, group: 0, bits:  7},  //  8\r\n\t{levels:   255, group: 0, bits:  8},  //  9\r\n\t{levels:   511, group: 0, bits:  9},  // 10\r\n\t{levels:  1023, group: 0, bits: 10},  // 11\r\n\t{levels:  2047, group: 0, bits: 11},  // 12\r\n\t{levels:  4095, group: 0, bits: 12},  // 13\r\n\t{levels:  8191, group: 0, bits: 13},  // 14\r\n\t{levels: 16383, group: 0, bits: 14},  // 15\r\n\t{levels: 32767, group: 0, bits: 15},  // 16\r\n\t{levels: 65535, group: 0, bits: 16}   // 17\r\n];\r\n\r\nexport default MP2;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/mp2.js","let WebGLRenderer = function(options) {\r\n\tthis.canvas = options.canvas || document.createElement('canvas');\r\n\tthis.width = this.canvas.width;\r\n\tthis.height = this.canvas.height;\r\n\tthis.enabled = true;\r\n\r\n\tvar contextCreateOptions = {\r\n\t\tpreserveDrawingBuffer: !!options.preserveDrawingBuffer,\r\n\t\talpha: false,\r\n\t\tdepth: false,\r\n\t\tstencil: false,\r\n\t\tantialias: false\r\n\t};\r\n\r\n\tthis.gl = \r\n\t\tthis.canvas.getContext('webgl', contextCreateOptions) || \r\n\t\tthis.canvas.getContext('experimental-webgl', contextCreateOptions);\r\n\r\n\tif (!this.gl) {\r\n\t\tthrow new Error('Failed to get WebGL Context');\r\n\t}\r\n\r\n\tvar gl = this.gl;\r\n\tvar vertexAttr = null;\r\n\r\n\t// Init buffers\r\n\tthis.vertexBuffer = gl.createBuffer();\r\n\tvar vertexCoords = new Float32Array([0, 0, 0, 1, 1, 0, 1, 1]);\r\n\tgl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\r\n\tgl.bufferData(gl.ARRAY_BUFFER, vertexCoords, gl.STATIC_DRAW);\r\n\r\n\t// Setup the main YCrCbToRGBA shader\r\n\tthis.program = this.createProgram(\r\n\t\tWebGLRenderer.SHADER.VERTEX_IDENTITY,\r\n\t\tWebGLRenderer.SHADER.FRAGMENT_YCRCB_TO_RGBA\r\n\t);\r\n\tvertexAttr = gl.getAttribLocation(this.program, 'vertex');\r\n\tgl.enableVertexAttribArray(vertexAttr);\r\n\tgl.vertexAttribPointer(vertexAttr, 2, gl.FLOAT, false, 0, 0);\r\n\r\n\tthis.textureY = this.createTexture(0, 'textureY');\r\n\tthis.textureCb = this.createTexture(1, 'textureCb');\r\n\tthis.textureCr = this.createTexture(2, 'textureCr');\r\n\r\n\r\n\t// Setup the loading animation shader\r\n\tthis.loadingProgram = this.createProgram(\r\n\t\tWebGLRenderer.SHADER.VERTEX_IDENTITY,\r\n\t\tWebGLRenderer.SHADER.FRAGMENT_LOADING\r\n\t);\r\n\tvertexAttr = gl.getAttribLocation(this.loadingProgram, 'vertex');\r\n\tgl.enableVertexAttribArray(vertexAttr);\r\n\tgl.vertexAttribPointer(vertexAttr, 2, gl.FLOAT, false, 0, 0);\r\n\r\n\tthis.shouldCreateUnclampedViews = !this.allowsClampedTextureData();\r\n};\r\n\r\nWebGLRenderer.prototype.destroy = function() {\r\n\tvar gl = this.gl;\r\n\t\r\n\tgl.deleteTexture(this.textureY);\r\n\tgl.deleteTexture(this.textureCb);\r\n\tgl.deleteTexture(this.textureCr);\r\n\r\n\tgl.deleteProgram(this.program);\r\n\tgl.deleteProgram(this.loadingProgram);\r\n\r\n\tgl.deleteBuffer(this.vertexBuffer);\r\n};\r\n\r\nWebGLRenderer.prototype.resize = function(width, height) {\r\n\tthis.width = width|0;\r\n\tthis.height = height|0;\r\n\r\n\tthis.canvas.width = this.width;\r\n\tthis.canvas.height = this.height;\r\n\r\n\tthis.gl.useProgram(this.program);\r\n\tthis.gl.viewport(0, 0, this.width, this.height);\r\n};\r\n\r\nWebGLRenderer.prototype.createTexture = function(index, name) {\r\n\tvar gl = this.gl;\r\n\tvar texture = gl.createTexture();\r\n\r\n\tgl.bindTexture(gl.TEXTURE_2D, texture);\r\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n\tgl.uniform1i(gl.getUniformLocation(this.program, name), index);\r\n\r\n\treturn texture;\r\n};\r\n\r\nWebGLRenderer.prototype.createProgram = function(vsh, fsh) {\r\n\tvar gl = this.gl;\r\n\tvar program = gl.createProgram();\r\n\r\n\tgl.attachShader(program, this.compileShader(gl.VERTEX_SHADER, vsh));\r\n\tgl.attachShader(program, this.compileShader(gl.FRAGMENT_SHADER, fsh));\r\n\tgl.linkProgram(program);\r\n\tgl.useProgram(program);\r\n\r\n\treturn program;\r\n};\r\n\r\nWebGLRenderer.prototype.compileShader = function(type, source) {\r\n\tvar gl = this.gl;\r\n\tvar shader = gl.createShader(type);\r\n\tgl.shaderSource(shader, source);\r\n\tgl.compileShader(shader);\r\n\r\n\tif (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n\t\tthrow new Error(gl.getShaderInfoLog(shader));\r\n\t}\r\n\r\n\treturn shader;\r\n};\r\n\r\nWebGLRenderer.prototype.allowsClampedTextureData = function() {\r\n\tvar gl = this.gl;\r\n\tvar texture = gl.createTexture();\r\n\r\n\tgl.bindTexture(gl.TEXTURE_2D, texture);\r\n\tgl.texImage2D(\r\n\t\tgl.TEXTURE_2D, 0, gl.LUMINANCE, 1, 1, 0,\r\n\t\tgl.LUMINANCE, gl.UNSIGNED_BYTE, new Uint8ClampedArray([0])\r\n\t);\r\n\treturn (gl.getError() === 0);\r\n};\r\n\r\nWebGLRenderer.prototype.renderProgress = function(progress) {\r\n\tvar gl = this.gl;\r\n\r\n\tgl.useProgram(this.loadingProgram);\r\n\r\n\tvar loc = gl.getUniformLocation(this.loadingProgram, 'progress');\r\n\tgl.uniform1f(loc, progress);\r\n\t\r\n\tgl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\r\n};\r\n\r\nWebGLRenderer.prototype.render = function(y, cb, cr) {\r\n\tif (!this.enabled) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar gl = this.gl;\r\n\tvar w = ((this.width + 15) >> 4) << 4,\r\n\t\th = this.height,\r\n\t\tw2 = w >> 1,\r\n\t\th2 = h >> 1;\r\n\r\n\t// In some browsers WebGL doesn't like Uint8ClampedArrays (this is a bug\r\n\t// and should be fixed soon-ish), so we have to create a Uint8Array view \r\n\t// for each plane.\r\n\tif (this.shouldCreateUnclampedViews) {\r\n\t\ty = new Uint8Array(y.buffer),\r\n\t\tcb = new Uint8Array(cb.buffer),\r\n\t\tcr = new Uint8Array(cr.buffer);\t\r\n\t}\r\n\r\n\tgl.useProgram(this.program);\r\n\r\n\tthis.updateTexture(gl.TEXTURE0, this.textureY, w, h, y);\r\n\tthis.updateTexture(gl.TEXTURE1, this.textureCb, w2, h2, cb);\r\n\tthis.updateTexture(gl.TEXTURE2, this.textureCr, w2, h2, cr);\r\n\r\n\tgl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\r\n};\r\n\r\nWebGLRenderer.prototype.updateTexture = function(unit, texture, w, h, data) {\r\n\tvar gl = this.gl;\r\n\tgl.activeTexture(unit);\r\n\tgl.bindTexture(gl.TEXTURE_2D, texture);\r\n\tgl.texImage2D(\r\n\t\tgl.TEXTURE_2D, 0, gl.LUMINANCE, w, h, 0, \r\n\t\tgl.LUMINANCE, gl.UNSIGNED_BYTE, data\r\n\t);\r\n}\r\n\r\nWebGLRenderer.IsSupported = function() {\r\n\ttry {\r\n\t\tif (!window.WebGLRenderingContext) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar canvas = document.createElement('canvas'); \r\n\t\treturn !!(\r\n\t\t\tcanvas.getContext('webgl') || \r\n\t\t\tcanvas.getContext('experimental-webgl')\r\n\t\t);\r\n\t}\r\n\tcatch (err) {\r\n\t\treturn false;\r\n\t} \r\n};\r\n\r\nWebGLRenderer.SHADER = {\r\n\tFRAGMENT_YCRCB_TO_RGBA: [\r\n\t\t'precision mediump float;',\r\n\t\t'uniform sampler2D textureY;',\r\n\t\t'uniform sampler2D textureCb;',\r\n\t\t'uniform sampler2D textureCr;',\r\n\t\t'varying vec2 texCoord;',\r\n\r\n\t\t'mat4 rec601 = mat4(',\r\n\t\t\t'1.16438,  0.00000,  1.59603, -0.87079,',\r\n\t\t\t'1.16438, -0.39176, -0.81297,  0.52959,',\r\n\t\t\t'1.16438,  2.01723,  0.00000, -1.08139,',\r\n\t\t\t'0, 0, 0, 1',\r\n\t\t');',\r\n\r\n\t\t'void main() {',\r\n\t\t\t'float y = texture2D(textureY, texCoord).r;',\r\n\t\t\t'float cb = texture2D(textureCb, texCoord).r;',\r\n\t\t\t'float cr = texture2D(textureCr, texCoord).r;',\r\n\r\n\t\t\t'gl_FragColor = vec4(y, cr, cb, 1.0) * rec601;',\r\n\t\t'}'\r\n\t].join('\\n'),\r\n\r\n\tFRAGMENT_LOADING: [\r\n\t\t'precision mediump float;',\r\n\t\t'uniform float progress;',\r\n\t\t'varying vec2 texCoord;',\r\n\r\n\t\t'void main() {',\r\n\t\t\t'float c = ceil(progress-(1.0-texCoord.y));',\r\n\t\t\t'gl_FragColor = vec4(c,c,c,1);',\r\n\t\t'}'\r\n\t].join('\\n'),\r\n\r\n\tVERTEX_IDENTITY: [\r\n\t\t'attribute vec2 vertex;',\r\n\t\t'varying vec2 texCoord;',\r\n\r\n\t\t'void main() {',\r\n\t\t\t'texCoord = vertex;',\r\n\t\t\t'gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);',\r\n\t\t'}'\r\n\t].join('\\n')\r\n};\r\n\r\nexport default WebGLRenderer;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/webgl.js","import {\r\n  Fill,\r\n} from '../index';\r\n\r\nlet CanvasRenderer = function (options) {\r\n  this.canvas = options.canvas || document.createElement('canvas');\r\n  this.width = this.canvas.width;\r\n  this.height = this.canvas.height;\r\n  this.enabled = true;\r\n\r\n  this.context = this.canvas.getContext('2d');\r\n};\r\n\r\nCanvasRenderer.prototype.destroy = function () {\r\n  // Nothing to do here\r\n};\r\n\r\nCanvasRenderer.prototype.resize = function (width, height) {\r\n  this.width = width | 0;\r\n  this.height = height | 0;\r\n\r\n  this.canvas.width = this.width;\r\n  this.canvas.height = this.height;\r\n\r\n  this.imageData = this.context.getImageData(0, 0, this.width, this.height);\r\n  Fill(this.imageData.data, 255);\r\n};\r\n\r\nCanvasRenderer.prototype.renderProgress = function (progress) {\r\n  var\r\n    w = this.canvas.width,\r\n    h = this.canvas.height,\r\n    ctx = this.context;\r\n\r\n  ctx.fillStyle = '#222';\r\n  ctx.fillRect(0, 0, w, h);\r\n  ctx.fillStyle = '#fff';\r\n  ctx.fillRect(0, h - h * progress, w, h * progress);\r\n};\r\n\r\nCanvasRenderer.prototype.render = function (y, cb, cr) {\r\n  this.YCbCrToRGBA(y, cb, cr, this.imageData.data);\r\n  this.context.putImageData(this.imageData, 0, 0);\r\n};\r\n\r\nCanvasRenderer.prototype.YCbCrToRGBA = function (y, cb, cr, rgba) {\r\n  if (!this.enabled) {\r\n    return;\r\n  }\r\n\r\n  // Chroma values are the same for each block of 4 pixels, so we proccess\r\n  // 2 lines at a time, 2 neighboring pixels each.\r\n  // I wish we could use 32bit writes to the RGBA buffer instead of writing\r\n  // each byte separately, but we need the automatic clamping of the RGBA\r\n  // buffer.\r\n\r\n  var w = ((this.width + 15) >> 4) << 4,\r\n    w2 = w >> 1;\r\n\r\n  var yIndex1 = 0,\r\n    yIndex2 = w,\r\n    yNext2Lines = w + (w - this.width);\r\n\r\n  var cIndex = 0,\r\n    cNextLine = w2 - (this.width >> 1);\r\n\r\n  var rgbaIndex1 = 0,\r\n    rgbaIndex2 = this.width * 4,\r\n    rgbaNext2Lines = this.width * 4;\r\n\r\n  var cols = this.width >> 1,\r\n    rows = this.height >> 1;\r\n\r\n  var ccb, ccr, r, g, b;\r\n\r\n  for (var row = 0; row < rows; row++) {\r\n    for (var col = 0; col < cols; col++) {\r\n      ccb = cb[cIndex];\r\n      ccr = cr[cIndex];\r\n      cIndex++;\r\n\r\n      r = (ccb + ((ccb * 103) >> 8)) - 179;\r\n      g = ((ccr * 88) >> 8) - 44 + ((ccb * 183) >> 8) - 91;\r\n      b = (ccr + ((ccr * 198) >> 8)) - 227;\r\n\r\n      // Line 1\r\n      var y1 = y[yIndex1++];\r\n      var y2 = y[yIndex1++];\r\n      rgba[rgbaIndex1] = y1 + r;\r\n      rgba[rgbaIndex1 + 1] = y1 - g;\r\n      rgba[rgbaIndex1 + 2] = y1 + b;\r\n      rgba[rgbaIndex1 + 4] = y2 + r;\r\n      rgba[rgbaIndex1 + 5] = y2 - g;\r\n      rgba[rgbaIndex1 + 6] = y2 + b;\r\n      rgbaIndex1 += 8;\r\n\r\n      // Line 2\r\n      var y3 = y[yIndex2++];\r\n      var y4 = y[yIndex2++];\r\n      rgba[rgbaIndex2] = y3 + r;\r\n      rgba[rgbaIndex2 + 1] = y3 - g;\r\n      rgba[rgbaIndex2 + 2] = y3 + b;\r\n      rgba[rgbaIndex2 + 4] = y4 + r;\r\n      rgba[rgbaIndex2 + 5] = y4 - g;\r\n      rgba[rgbaIndex2 + 6] = y4 + b;\r\n      rgbaIndex2 += 8;\r\n    }\r\n\r\n    yIndex1 += yNext2Lines;\r\n    yIndex2 += yNext2Lines;\r\n    rgbaIndex1 += rgbaNext2Lines;\r\n    rgbaIndex2 += rgbaNext2Lines;\r\n    cIndex += cNextLine;\r\n  }\r\n};\r\n\r\nexport default CanvasRenderer;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/canvas2d.js","import {\r\n\tNow,\r\n} from '../index';\r\n\r\nlet WebAudioOut = function(options) {\r\n\tthis.context = WebAudioOut.CachedContext =\r\n\t\tWebAudioOut.CachedContext ||\r\n\t\tnew (window.AudioContext || window.webkitAudioContext)();\r\n\r\n\tthis.gain = this.context.createGain();\r\n\tthis.destination = this.gain;\r\n\r\n\t// Keep track of the number of connections to this AudioContext, so we\r\n\t// can safely close() it when we're the only one connected to it.\r\n\tthis.gain.connect(this.context.destination);\r\n\tthis.context._connections = (this.context._connections || 0) + 1;\r\n\t\r\n\tthis.startTime = 0;\r\n\tthis.buffer = null;\r\n\tthis.wallclockStartTime = 0;\r\n\tthis.volume = 1;\r\n\tthis.enabled = true;\r\n\r\n\tthis.unlocked = !WebAudioOut.NeedsUnlocking();\r\n\t\r\n\tObject.defineProperty(this, 'enqueuedTime', {get: this.getEnqueuedTime});\r\n};\r\n\r\nWebAudioOut.prototype.destroy = function() {\r\n\tthis.gain.disconnect();\r\n\tthis.context._connections--;\r\n\r\n\tif (this.context._connections === 0) {\r\n\t\tthis.context.close();\r\n\t\tWebAudioOut.CachedContext = null;\r\n\t}\r\n};\r\n\r\nWebAudioOut.prototype.play = function(sampleRate, left, right) {\r\n\tif (!this.enabled) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// If the context is not unlocked yet, we simply advance the start time\r\n\t// to \"fake\" actually playing audio. This will keep the video in sync.\r\n\tif (!this.unlocked) {\r\n\t\tvar ts = Now()\r\n\t\tif (this.wallclockStartTime < ts) {\r\n\t\t\tthis.wallclockStartTime = ts;\r\n\t\t}\r\n\t\tthis.wallclockStartTime += left.length / sampleRate;\r\n\t\treturn;\r\n\t}\r\n\r\n\r\n\tthis.gain.gain.value = this.volume;\r\n\r\n\tvar buffer = this.context.createBuffer(2, left.length, sampleRate);\r\n\tbuffer.getChannelData(0).set(left);\r\n\tbuffer.getChannelData(1).set(right);\r\n\r\n\tvar source = this.context.createBufferSource();\r\n\tsource.buffer = buffer;\r\n\tsource.connect(this.destination);\r\n\r\n\tvar now = this.context.currentTime;\r\n\tvar duration = buffer.duration;\r\n\tif (this.startTime < now) {\r\n\t\tthis.startTime = now;\r\n\t\tthis.wallclockStartTime = Now();\r\n\t}\r\n\r\n\tsource.start(this.startTime);\r\n\tthis.startTime += duration;\r\n\tthis.wallclockStartTime += duration;\r\n};\r\n\r\nWebAudioOut.prototype.stop = function() {\r\n\t// Meh; there seems to be no simple way to get a list of currently\r\n\t// active source nodes from the Audio Context, and maintaining this\r\n\t// list ourselfs would be a pain, so we just set the gain to 0\r\n\t// to cut off all enqueued audio instantly.\r\n\tthis.gain.gain.value = 0;\r\n};\r\n\r\nWebAudioOut.prototype.getEnqueuedTime = function() {\r\n\t// The AudioContext.currentTime is only updated every so often, so if we\r\n\t// want to get exact timing, we need to rely on the system time.\r\n\treturn Math.max(this.wallclockStartTime - Now(), 0)\r\n};\r\n\r\nWebAudioOut.prototype.resetEnqueuedTime = function() {\r\n\tthis.startTime = this.context.currentTime;\r\n\tthis.wallclockStartTime = Now();\r\n};\r\n\r\nWebAudioOut.prototype.unlock = function(callback) {\r\n\tif (this.unlocked) {\r\n\t\tif (callback) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\r\n\tthis.unlockCallback = callback;\r\n\t\r\n\t// Create empty buffer and play it\r\n\tvar buffer = this.context.createBuffer(1, 1, 22050);\r\n\tvar source = this.context.createBufferSource();\r\n\tsource.buffer = buffer;\r\n\tsource.connect(this.destination);\r\n\r\n  // polyfill source.start(0);\r\n  if (source.start) {\r\n    source.start(0);\r\n  }\r\n  else {\r\n    source.noteOn(0);\r\n  }\r\n\r\n\tsetTimeout(this.checkIfUnlocked.bind(this, source, 0), 0);\r\n};\r\n\r\nWebAudioOut.prototype.checkIfUnlocked = function(source, attempt) {\r\n\tif (\r\n\t\tsource.playbackState === source.PLAYING_STATE || \r\n\t\tsource.playbackState === source.FINISHED_STATE\r\n\t) {\r\n\t\tthis.unlocked = true;\r\n\t\tif (this.unlockCallback) {\r\n\t\t\tthis.unlockCallback();\r\n\t\t\tthis.unlockCallback = null;\t\r\n\t\t}\r\n\t}\r\n\telse if (attempt < 10) {\r\n\t\t// Jeez, what a shit show. Thanks iOS!\r\n\t\tsetTimeout(this.checkIfUnlocked.bind(this, source, attempt+1), 100);\r\n\t}\r\n};\r\n\r\nWebAudioOut.NeedsUnlocking = function() {\r\n\treturn /iPhone|iPad|iPod/i.test(navigator.userAgent);\r\n};\r\n\r\nWebAudioOut.IsSupported = function() {\r\n\treturn (window.AudioContext || window.webkitAudioContext);\r\n};\r\n\r\nWebAudioOut.CachedContext = null;\r\n\r\nexport default WebAudioOut;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/webaudio.js"],"sourceRoot":""}